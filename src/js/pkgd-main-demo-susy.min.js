(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
//These scripts will be bundled

require('./general/carousel.js');
require('./general/custom.js');

},{"./general/carousel.js":3,"./general/custom.js":4}],2:[function(require,module,exports){
(function (global){
; var __browserify_shim_require__=require;(function browserifyShim(module, define, require) {
/**
 * Owl carousel
 * @version 2.0.0
 * @author Bartosz Wojciechowski
 * @license The MIT License (MIT)
 * @todo Lazy Load Icon
 * @todo prevent animationend bubling
 * @todo itemsScaleUp
 * @todo Test Zepto
 * @todo stagePadding calculate wrong active classes
 */
;(function($, window, document, undefined) {

	var item, dom, width, num, pos, drag, speed, state, e;

	/**
	 * Template for the data of each item respectively its DOM element.
	 * @private
	 */
	item = {
		index: false,
		indexAbs: false,
		posLeft: false,
		clone: false,
		active: false,
		loaded: false,
		lazyLoad: false,
		current: false,
		width: false,
		center: false,
		page: false,
		hasVideo: false,
		playVideo: false
	};

	/**
	 * Template for the references to DOM elements, those with `$` sign are `jQuery` objects.
	 * @private
	 */
	dom = {
		el: null, // main element
		$el: null, // jQuery main element
		stage: null, // stage
		$stage: null, // jQuery stage
		oStage: null, // outer stage
		$oStage: null, // $ outer stage
		$items: null, // all items, clones and originals included
		$oItems: null, // original items
		$cItems: null, // cloned items only
		$content: null
	};

	/**
	 * Template for the widths of some elements.
	 * @private
	 */
	width = {
		el: 0,
		stage: 0,
		item: 0,
		prevWindow: 0,
		cloneLast: 0
	};

	/**
	 * Template for counting to some properties.
	 * @private
	 */
	num = {
		items: 0,
		oItems: 0,
		cItems: 0,
		active: 0,
		merged: []
	};

	/**
	 * Template for status information about drag and touch events.
	 * @private
	 */
	drag = {
		start: 0,
		startX: 0,
		startY: 0,
		current: 0,
		currentX: 0,
		currentY: 0,
		offsetX: 0,
		offsetY: 0,
		distance: null,
		startTime: 0,
		endTime: 0,
		updatedX: 0,
		targetEl: null
	};

	/**
	 * Template for some status informations.
	 * @private
	 */
	state = {
		isTouch: false,
		isScrolling: false,
		isSwiping: false,
		direction: false,
		inMotion: false
	};

	/**
	 * Event functions references.
	 * @private
	 */
	e = {
		_onDragStart: null,
		_onDragMove: null,
		_onDragEnd: null,
		_transitionEnd: null,
		_resizer: null,
		_responsiveCall: null,
		_goToLoop: null,
		_checkVisibile: null
	};

	/**
	 * Creates a carousel.
	 * @class The Owl Carousel.
	 * @public
	 * @param {HTMLElement|jQuery} element - The element to create the carousel for.
	 * @param {Object} [options] - The options
	 */
	function Owl(element, options) {

		// add basic Owl information to dom element
		element.owlCarousel = {
			'name': 'Owl Carousel',
			'author': 'Bartosz Wojciechowski',
			'version': '2.0.0-beta.2.1'
		};

		/**
		 * Current settings for the carousel.
		 * @protected
		 */
		this.settings = null;

		/**
		 *
		 * @protected
		 * @todo Must be dosumented.
		 */
		this.options = $.extend({}, Owl.Defaults, options);

		/**
		 * Template for the data of each item.
		 * @protected
		 */
		this.itemData = $.extend({}, item);

		/**
		 * Contains references to DOM elements, those with `$` sign are `jQuery` objects.
		 * @protected
		 */
		this.dom = $.extend({}, dom);

		/**
		 * Caches the widths of some elements.
		 * @protected
		 */
		this.width = $.extend({}, width);

		/**
		 * Caches some count informations.
		 * @protected
		 */
		this.num = $.extend({}, num);

		/**
		 * Caches informations about drag and touch events.
		 */
		this.drag = $.extend({}, drag);

		/**
		 * Caches some status informations.
		 * @protected
		 */
		this.state = $.extend({}, state);

		/**
		 * @protected
		 * @todo Must be documented
		 */
		this.e = $.extend({}, e);

		/**
		 * References to the running plugins of this carousel.
		 * @protected
		 */
		this.plugins = {};

		/**
		 * Currently suppressed events to prevent them from beeing retriggered.
		 * @protected
		 */
		this._supress = {};

		/**
		 * The absolute current position.
		 * @protected
		 */
		this._current = null;

		/**
		 * The animation speed in milliseconds.
		 * @protected
		 */
		this._speed = null;

		/**
		 * The coordinates of all items in pixel.
		 */
		this._coordinates = null;

		this.dom.el = element;
		this.dom.$el = $(element);

		for (var plugin in Owl.Plugins) {
			this.plugins[plugin[0].toLowerCase() + plugin.slice(1)]
				= new Owl.Plugins[plugin](this);
		}

		this.init();
	}

	/**
	 * Default options for the carousel.
	 * @public
	 */
	Owl.Defaults = {
		items: 3,
		loop: false,
		center: false,

		mouseDrag: true,
		touchDrag: true,
		pullDrag: true,
		freeDrag: false,

		margin: 0,
		stagePadding: 0,

		merge: false,
		mergeFit: true,
		autoWidth: false,

		startPosition: 0,

		smartSpeed: 250,
		fluidSpeed: false,
		dragEndSpeed: false,

		responsive: {},
		responsiveRefreshRate: 200,
		responsiveBaseElement: window,
		responsiveClass: false,

		fallbackEasing: 'swing',

		info: false,

		nestedItemSelector: false,
		itemElement: 'div',
		stageElement: 'div',

		// Classes and Names
		themeClass: 'owl-theme',
		baseClass: 'owl-carousel',
		itemClass: 'owl-item',
		centerClass: 'center',
		activeClass: 'active'
	};

	/**
	 * Contains all registered plugins.
	 * @public
	 */
	Owl.Plugins = {};

	/**
	 * Initializes the carousel.
	 * @protected
	 */
	Owl.prototype.init = function() {

		// Update options.items on given size
		this.setResponsiveOptions();

		this.trigger('initialize');

		// Add base class
		if (!this.dom.$el.hasClass(this.settings.baseClass)) {
			this.dom.$el.addClass(this.settings.baseClass);
		}

		// Add theme class
		if (!this.dom.$el.hasClass(this.settings.themeClass)) {
			this.dom.$el.addClass(this.settings.themeClass);
		}

		// Add theme class
		if (this.settings.rtl) {
			this.dom.$el.addClass('owl-rtl');
		}

		// Check support
		this.browserSupport();

		if (this.settings.autoWidth && this.state.imagesLoaded !== true) {
			var imgs, nestedSelector, width;
			imgs = this.dom.$el.find('img');
			nestedSelector = this.settings.nestedItemSelector ? '.' + this.settings.nestedItemSelector : undefined;
			width = this.dom.$el.children(nestedSelector).width();

			if (imgs.length && width <= 0) {
				this.preloadAutoWidthImages(imgs);
				return false;
			}
		}

		// Get and store window width
		// iOS safari likes to trigger unnecessary resize event
		this.width.prevWindow = this.viewport();

		// create stage object
		this.createStage();

		// Append local content
		this.fetchContent();

		// attach generic events
		this.eventsCall();

		// attach generic events
		this.internalEvents();

		this.dom.$el.addClass('owl-loading');
		this.refresh(true);
		this.dom.$el.removeClass('owl-loading').addClass('owl-loaded');

		this.trigger('initialized');

		// attach custom control events
		this.addTriggerableEvents();
	};

	/**
	 * Sets responsive options.
	 * @protected
	 */
	Owl.prototype.setResponsiveOptions = function() {
		if (!this.options.responsive) {
			this.settings = $.extend({}, this.options);
		} else {
			var viewport = this.viewport(),
				overwrites = this.options.responsive,
				match = -1;

			$.each(overwrites, function(breakpoint) {
				if (breakpoint <= viewport && breakpoint > match) {
					match = Number(breakpoint);
				}
			});

			this.settings = $.extend({}, this.options, overwrites[match]);
			delete this.settings.responsive;

			// Responsive Class
			if (this.settings.responsiveClass) {
				this.dom.$el.attr('class', function(i, c) {
					return c.replace(/\b owl-responsive-\S+/g, '');
				}).addClass('owl-responsive-' + match);
			}
		}
	};

	/**
	 * Updates option logic if necessery.
	 * @protected
	 */
	Owl.prototype.optionsLogic = function() {
		// Toggle Center class
		this.dom.$el.toggleClass('owl-center', this.settings.center);

		// if items number is less than in body
		if (this.settings.loop && this.num.oItems < this.settings.items) {
			this.settings.loop = false;
		}

		if (this.settings.autoWidth) {
			this.settings.stagePadding = false;
			this.settings.merge = false;
		}
	};

	/**
	 * Creates stage and outer-stage elements.
	 * @protected
	 */
	Owl.prototype.createStage = function() {
		var oStage = document.createElement('div'),
			stage = document.createElement(this.settings.stageElement);

		oStage.className = 'owl-stage-outer';
		stage.className = 'owl-stage';

		oStage.appendChild(stage);
		this.dom.el.appendChild(oStage);

		this.dom.oStage = oStage;
		this.dom.$oStage = $(oStage);
		this.dom.stage = stage;
		this.dom.$stage = $(stage);

		oStage = null;
		stage = null;
	};

	/**
	 * Creates an item container.
	 * @protected
	 * @returns {jQuery} - The item container.
	 */
	Owl.prototype.createItemContainer = function() {
		var item = document.createElement(this.settings.itemElement);
		item.className = this.settings.itemClass;
		return $(item);
	};

	/**
	 * Fetches the content.
	 * @protected
	 */
	Owl.prototype.fetchContent = function(extContent) {
		if (extContent) {
			this.dom.$content = (extContent instanceof jQuery) ? extContent : $(extContent);
		} else if (this.settings.nestedItemSelector) {
			this.dom.$content = this.dom.$el.find('.' + this.settings.nestedItemSelector).not('.owl-stage-outer');
		} else {
			this.dom.$content = this.dom.$el.children().not('.owl-stage-outer');
		}
		// content length
		this.num.oItems = this.dom.$content.length;

		// init Structure
		if (this.num.oItems !== 0) {
			this.initStructure();
		}
	};

	/**
	 * Initializes the content struture.
	 * @protected
	 */
	Owl.prototype.initStructure = function() {
		this.createNormalStructure();
	};

	/**
	 * Creates small/mid weight content structure.
	 * @protected
	 * @todo This results in a poor performance,
	 * but this is due to the approach of completely
	 * rebuild the existing DOM tree from scratch,
	 * rather to use them. The effort to implement
	 * this with a good performance, while maintaining
	 * the original approach is disproportionate.
	 */
	Owl.prototype.createNormalStructure = function() {
		var i, $item;
		for (i = 0; i < this.num.oItems; i++) {
			$item = this.createItemContainer();
			this.initializeItemContainer($item, this.dom.$content[i]);
			this.dom.$stage.append($item);
		}
		this.dom.$content = null;
	};

	/**
	 * Creates custom content structure.
	 * @protected
	 */
	Owl.prototype.createCustomStructure = function(howManyItems) {
		var i, $item;
		for (i = 0; i < howManyItems; i++) {
			$item = this.createItemContainer();
			this.createItemContainerData($item);
			this.dom.$stage.append($item);
		}
	};

	/**
	 * Initializes item container with provided content.
	 * @protected
	 * @param {jQuery} item - The item that has to be filled.
	 * @param {HTMLElement|jQuery|string} content - The content that fills the item.
	 */
	Owl.prototype.initializeItemContainer = function(item, content) {
		this.trigger('change', { property: { name: 'item', value: item } });

		this.createItemContainerData(item);
		item.append(content);

		this.trigger('changed', { property: { name: 'item', value: item } });
	};

	/**
	 * Creates item container data.
	 * @protected
	 * @param {jQuery} item - The item for which the data are to be set.
	 * @param {jQuery} [source] - The item whose data are to be copied.
	 */
	Owl.prototype.createItemContainerData = function(item, source) {
		var data = $.extend({}, this.itemData);

		if (source) {
			$.extend(data, source.data('owl-item'));
		}

		item.data('owl-item', data);
	};

	/**
	 * Clones an item container.
	 * @protected
	 * @param {jQuery} item - The item to clone.
	 * @returns {jQuery} - The cloned item.
	 */
	Owl.prototype.cloneItemContainer = function(item) {
		var $clone = item.clone(true, true).addClass('cloned');
		// somehow data references the same object
		this.createItemContainerData($clone, $clone);
		$clone.data('owl-item').clone = true;
		return $clone;
	};

	/**
	 * Updates original items index data.
	 * @protected
	 */
	Owl.prototype.updateLocalContent = function() {

		var k, item;

		this.dom.$oItems = this.dom.$stage.find('.' + this.settings.itemClass).filter(function() {
			return $(this).data('owl-item').clone === false;
		});

		this.num.oItems = this.dom.$oItems.length;
		// update index on original items

		for (k = 0; k < this.num.oItems; k++) {
			item = this.dom.$oItems.eq(k);
			item.data('owl-item').index = k;
		}
	};

	/**
	 * Creates clones for infinity loop.
	 * @protected
	 */
	Owl.prototype.loopClone = function() {
		if (!this.settings.loop || this.num.oItems < this.settings.items) {
			return false;
		}

		var append, prepend, i,
			items = this.settings.items,
			last = this.num.oItems - 1;

		// if neighbour margin then add one more duplicat
		if (this.settings.stagePadding && this.settings.items === 1) {
			items += 1;
		}
		this.num.cItems = items * 2;

		for (i = 0; i < items; i++) {
			append = this.cloneItemContainer(this.dom.$oItems.eq(i));
			prepend = this.cloneItemContainer(this.dom.$oItems.eq(last - i));

			this.dom.$stage.append(append);
			this.dom.$stage.prepend(prepend);
		}

		this.dom.$cItems = this.dom.$stage.find('.' + this.settings.itemClass).filter(function() {
			return $(this).data('owl-item').clone === true;
		});
	};

	/**
	 * Update cloned elements.
	 * @protected
	 */
	Owl.prototype.reClone = function() {
		// remove cloned items
		if (this.dom.$cItems !== null) { // && (this.num.oItems !== 0 &&
			// this.num.oItems <=
			// this.settings.items)){
			this.dom.$cItems.remove();
			this.dom.$cItems = null;
			this.num.cItems = 0;
		}

		if (!this.settings.loop) {
			return;
		}
		// generete new elements
		this.loopClone();
	};

	/**
	 * Updates all items index data.
	 * @protected
	 */
	Owl.prototype.calculate = function() {

		var i, j, elMinusMargin, dist, allItems, iWidth,  mergeNumber,  posLeft = 0, fullWidth = 0;

		// element width minus neighbour
		this.width.el = this.dom.$el.width() - (this.settings.stagePadding * 2);

		// to check
		this.width.view = this.dom.$el.width();

		// calculate width minus addition margins
		elMinusMargin = this.width.el - (this.settings.margin * (this.settings.items === 1 ? 0 : this.settings.items - 1));

		// calculate element width and item width
		this.width.el = this.width.el + this.settings.margin;
		this.width.item = ((elMinusMargin / this.settings.items) + this.settings.margin).toFixed(3);

		this.dom.$items = this.dom.$stage.find('.owl-item');
		this.num.items = this.dom.$items.length;

		// change to autoWidths
		if (this.settings.autoWidth) {
			this.dom.$items.css('width', '');
		}

		// Set grid array
		this._coordinates = [];
		this.num.merged = [];

		// item distances
		if (this.settings.rtl) {
			dist = this.settings.center ? -((this.width.el) / 2) : 0;
		} else {
			dist = this.settings.center ? (this.width.el) / 2 : 0;
		}

		this.width.mergeStage = 0;

		// Calculate items positions
		for (i = 0; i < this.num.items; i++) {

			// check merged items

			if (this.settings.merge) {
				mergeNumber = this.dom.$items.eq(i).find('[data-merge]').attr('data-merge') || 1;
				if (this.settings.mergeFit && mergeNumber > this.settings.items) {
					mergeNumber = this.settings.items;
				}
				this.num.merged.push(parseInt(mergeNumber));
				this.width.mergeStage += this.width.item * this.num.merged[i];
			} else {
				this.num.merged.push(1);
			}

			iWidth = this.width.item * this.num.merged[i];

			// autoWidth item size
			if (this.settings.autoWidth) {
				iWidth = this.dom.$items.eq(i).width() + this.settings.margin;
				if (this.settings.rtl) {
					this.dom.$items[i].style.marginLeft = this.settings.margin + 'px';
				} else {
					this.dom.$items[i].style.marginRight = this.settings.margin + 'px';
				}

			}
			// push item position into array
			this._coordinates.push(dist);

			// update item data
			this.dom.$items.eq(i).data('owl-item').posLeft = posLeft;
			this.dom.$items.eq(i).data('owl-item').width = iWidth;

			// dist starts from middle of stage if center
			// posLeft always starts from 0
			if (this.settings.rtl) {
				dist += iWidth;
				posLeft += iWidth;
			} else {
				dist -= iWidth;
				posLeft -= iWidth;
			}

			fullWidth -= Math.abs(iWidth);

			// update position if center
			if (this.settings.center) {
				this._coordinates[i] = !this.settings.rtl ? this._coordinates[i] - (iWidth / 2) : this._coordinates[i]
					+ (iWidth / 2);
			}
		}

		if (this.settings.autoWidth) {
			this.width.stage = this.settings.center ? Math.abs(fullWidth) : Math.abs(dist);
		} else {
			this.width.stage = Math.abs(fullWidth);
		}

		// update indexAbs on all items
		allItems = this.num.oItems + this.num.cItems;

		for (j = 0; j < allItems; j++) {
			this.dom.$items.eq(j).data('owl-item').indexAbs = j;
		}

		// Recalculate grid
		this.setSizes();
	};

	/**
	 * Set sizes on elements from `collectData`.
	 * @protected
	 * @todo CRAZY FIX!!! Doublecheck this!
	 */
	Owl.prototype.setSizes = function() {

		// show neighbours
		if (this.settings.stagePadding !== false) {
			this.dom.oStage.style.paddingLeft = this.settings.stagePadding + 'px';
			this.dom.oStage.style.paddingRight = this.settings.stagePadding + 'px';
		}

		// if(this.width.stagePrev > this.width.stage){
		if (this.settings.rtl) {
			window.setTimeout($.proxy(function() {
				this.dom.stage.style.width = this.width.stage + 'px';
			}, this), 0);
		} else {
			this.dom.stage.style.width = this.width.stage + 'px';
		}

		for (var i = 0; i < this.num.items; i++) {

			// Set items width
			if (!this.settings.autoWidth) {
				this.dom.$items[i].style.width = this.width.item - (this.settings.margin) + 'px';
			}
			// add margin
			if (this.settings.rtl) {
				this.dom.$items[i].style.marginLeft = this.settings.margin + 'px';
			} else {
				this.dom.$items[i].style.marginRight = this.settings.margin + 'px';
			}

			if (this.num.merged[i] !== 1 && !this.settings.autoWidth) {
				this.dom.$items[i].style.width = (this.width.item * this.num.merged[i]) - (this.settings.margin) + 'px';
			}
		}

		// save prev stage size
		this.width.stagePrev = this.width.stage;
	};

	/**
	 * Updates all data by calling `refresh`.
	 * @protected
	 */
	Owl.prototype.responsive = function() {

		if (!this.num.oItems) {
			return false;
		}
		// If El width hasnt change then stop responsive
		var elChanged = this.isElWidthChanged();
		if (!elChanged) {
			return false;
		}

		if (this.trigger('resize').isDefaultPrevented()) {
			return false;
		}

		this.state.responsive = true;
		this.refresh();
		this.state.responsive = false;

		this.trigger('resized');
	};

	/**
	 * Refreshes the carousel primarily for adaptive purposes.
	 * @public
	 */
	Owl.prototype.refresh = function() {
		var current = this.dom.$oItems && this.dom.$oItems.eq(this.normalize(this.current(), true));

		this.trigger('refresh');

		// Update Options for given width
		this.setResponsiveOptions();

		// update info about local content
		this.updateLocalContent();

		// udpate options
		this.optionsLogic();

		// if no items then stop
		if (this.num.oItems === 0) {
			return false;
		}

		// Hide and Show methods helps here to set a proper widths.
		// This prevents Scrollbar to be calculated in stage width
		this.dom.$stage.addClass('owl-refresh');

		// Remove clones and generate new ones
		this.reClone();

		// calculate
		this.calculate();

		// aaaand show.
		this.dom.$stage.removeClass('owl-refresh');

		if (!current) {
			this.dom.oStage.scrollLeft = 0;
			this.reset(this.dom.$oItems.eq(0).data('owl-item').indexAbs);
		} else {
			this.reset(current.data('owl-item').indexAbs); // fix that
		}

		this.state.orientation = window.orientation;

		this.watchVisibility();

		this.trigger('refreshed');
	};

	/**
	 * Updates information about current state of items (visibile, hidden, active, etc.).
	 * @protected
	 */
	Owl.prototype.updateActiveItems = function() {
		this.trigger('change', { property: { name: 'items', value: this.dom.$items } });

		var i, j, item, ipos, iwidth, outsideView;

		// clear states
		for (i = 0; i < this.num.items; i++) {
			this.dom.$items.eq(i).data('owl-item').active = false;
			this.dom.$items.eq(i).data('owl-item').current = false;
			this.dom.$items.eq(i).removeClass(this.settings.activeClass).removeClass(this.settings.centerClass);
		}

		this.num.active = 0;
		padding = this.settings.stagePadding * 2;
		stageX = this.coordinates(this.current()) + padding;
		view = this.settings.rtl ? this.width.view : -this.width.view;

		for (j = 0; j < this.num.items; j++) {

			item = this.dom.$items.eq(j);
			ipos = item.data('owl-item').posLeft;
			iwidth = item.data('owl-item').width;
			outsideView = this.settings.rtl ? ipos - iwidth - padding : ipos - iwidth + padding;

			if ((this.op(ipos, '<=', stageX) && (this.op(ipos, '>', stageX + view)))
				|| (this.op(outsideView, '<', stageX) && this.op(outsideView, '>', stageX + view))) {

				this.num.active++;

				item.data('owl-item').active = true;
				item.data('owl-item').current = true;
				item.addClass(this.settings.activeClass);

				if (!this.settings.lazyLoad) {
					item.data('owl-item').loaded = true;
				}
				if (this.settings.loop) {
					this.updateClonedItemsState(item.data('owl-item').index);
				}
			}
		}

		if (this.settings.center) {
			this.dom.$items.eq(this.current()).addClass(this.settings.centerClass).data('owl-item').center = true;
		}
		this.trigger('changed', { property: { name: 'items', value: this.dom.$items } });
	};

	/**
	 * Sets current state on sibilings items for center.
	 * @protected
	 */
	Owl.prototype.updateClonedItemsState = function(activeIndex) {

		// find cloned center
		var center, $el, i;
		if (this.settings.center) {
			center = this.dom.$items.eq(this.current()).data('owl-item').index;
		}

		for (i = 0; i < this.num.items; i++) {
			$el = this.dom.$items.eq(i);
			if ($el.data('owl-item').index === activeIndex) {
				$el.data('owl-item').current = true;
				if ($el.data('owl-item').index === center) {
					$el.addClass(this.settings.centerClass);
				}
			}
		}
	};

	/**
	 * Save internal event references and add event based functions.
	 * @protected
	 */
	Owl.prototype.eventsCall = function() {
		// Save events references
		this.e._onDragStart = $.proxy(function(e) {
			this.onDragStart(e);
		}, this);
		this.e._onDragMove = $.proxy(function(e) {
			this.onDragMove(e);
		}, this);
		this.e._onDragEnd = $.proxy(function(e) {
			this.onDragEnd(e);
		}, this);
		this.e._transitionEnd = $.proxy(function(e) {
			this.transitionEnd(e);
		}, this);
		this.e._resizer = $.proxy(function() {
			this.responsiveTimer();
		}, this);
		this.e._responsiveCall = $.proxy(function() {
			this.responsive();
		}, this);
		this.e._preventClick = $.proxy(function(e) {
			this.preventClick(e);
		}, this);
	};

	/**
	 * Checks window `resize` event.
	 * @protected
	 */
	Owl.prototype.responsiveTimer = function() {
		if (this.viewport() === this.width.prevWindow) {
			return false;
		}
		window.clearTimeout(this.resizeTimer);

		this.resizeTimer = window.setTimeout(this.e._responsiveCall, this.settings.responsiveRefreshRate);
		this.width.prevWindow = this.viewport();
	};

	/**
	 * Checks for touch/mouse drag options and add necessery event handlers.
	 * @protected
	 */
	Owl.prototype.internalEvents = function() {
		var isTouch = isTouchSupport(),
			isTouchIE = isTouchSupportIE();

		if (isTouch && !isTouchIE) {
			this.dragType = [ 'touchstart', 'touchmove', 'touchend', 'touchcancel' ];
		} else if (isTouch && isTouchIE) {
			this.dragType = [ 'MSPointerDown', 'MSPointerMove', 'MSPointerUp', 'MSPointerCancel' ];
		} else {
			this.dragType = [ 'mousedown', 'mousemove', 'mouseup' ];
		}

		if ((isTouch || isTouchIE) && this.settings.touchDrag) {
			// touch cancel event
			this.on(document, this.dragType[3], this.e._onDragEnd);

		} else {
			// firefox startdrag fix - addeventlistener doesnt work here :/
			this.dom.$stage.on('dragstart', function() {
				return false;
			});

			if (this.settings.mouseDrag) {
				// disable text select
				this.dom.stage.onselectstart = function() {
					return false;
				};
			} else {
				// enable text select
				this.dom.$el.addClass('owl-text-select-on');
			}
		}

		// Catch transitionEnd event
		if (this.transitionEndVendor) {
			this.on(this.dom.stage, this.transitionEndVendor, this.e._transitionEnd, false);
		}

		// Responsive
		if (this.settings.responsive !== false) {
			this.on(window, 'resize', this.e._resizer, false);
		}

		this.dragEvents();
	};

	/**
	 * Triggers event handlers for drag events.
	 * @protected
	 */
	Owl.prototype.dragEvents = function() {

		if (this.settings.touchDrag && (this.dragType[0] === 'touchstart' || this.dragType[0] === 'MSPointerDown')) {
			this.on(this.dom.stage, this.dragType[0], this.e._onDragStart, false);
		} else if (this.settings.mouseDrag && this.dragType[0] === 'mousedown') {
			this.on(this.dom.stage, this.dragType[0], this.e._onDragStart, false);
		} else {
			this.off(this.dom.stage, this.dragType[0], this.e._onDragStart);
		}
	};

	/**
	 * Handles touchstart/mousedown event.
	 * @protected
	 * @param {Event} event - The event arguments.
	 */
	Owl.prototype.onDragStart = function(event) {
		var ev, isTouchEvent, pageX, pageY, animatedPos;

		ev = event.originalEvent || event || window.event;

		// prevent right click
		if (ev.which === 3) {
			return false;
		}

		if (this.dragType[0] === 'mousedown') {
			this.dom.$stage.addClass('owl-grab');
		}

		this.trigger('drag');
		this.drag.startTime = new Date().getTime();
		this.speed(0);
		this.state.isTouch = true;
		this.state.isScrolling = false;
		this.state.isSwiping = false;
		this.drag.distance = 0;

		// if is 'touchstart'
		isTouchEvent = ev.type === 'touchstart';
		pageX = isTouchEvent ? event.targetTouches[0].pageX : (ev.pageX || ev.clientX);
		pageY = isTouchEvent ? event.targetTouches[0].pageY : (ev.pageY || ev.clientY);

		// get stage position left
		this.drag.offsetX = this.dom.$stage.position().left - this.settings.stagePadding;
		this.drag.offsetY = this.dom.$stage.position().top;

		if (this.settings.rtl) {
			this.drag.offsetX = this.dom.$stage.position().left + this.width.stage - this.width.el
				+ this.settings.margin;
		}

		// catch position // ie to fix
		if (this.state.inMotion && this.support3d) {
			animatedPos = this.getTransformProperty();
			this.drag.offsetX = animatedPos;
			this.animate(animatedPos);
			this.state.inMotion = true;
		} else if (this.state.inMotion && !this.support3d) {
			this.state.inMotion = false;
			return false;
		}

		this.drag.startX = pageX - this.drag.offsetX;
		this.drag.startY = pageY - this.drag.offsetY;

		this.drag.start = pageX - this.drag.startX;
		this.drag.targetEl = ev.target || ev.srcElement;
		this.drag.updatedX = this.drag.start;

		// to do/check
		// prevent links and images dragging;
		if (this.drag.targetEl.tagName === "IMG" || this.drag.targetEl.tagName === "A") {
			this.drag.targetEl.draggable = false;
		}

		this.on(document, this.dragType[1], this.e._onDragMove, false);
		this.on(document, this.dragType[2], this.e._onDragEnd, false);
	};

	/**
	 * Handles the touchmove/mousemove events.
	 * @todo Simplify
	 * @protected
	 * @param {Event} event - The event arguments.
	 */
	Owl.prototype.onDragMove = function(event) {
		var ev, isTouchEvent, pageX, pageY, minValue, maxValue, pull;

		if (!this.state.isTouch) {
			return;
		}

		if (this.state.isScrolling) {
			return;
		}

		ev = event.originalEvent || event || window.event;

		// if is 'touchstart'
		isTouchEvent = ev.type == 'touchmove';
		pageX = isTouchEvent ? ev.targetTouches[0].pageX : (ev.pageX || ev.clientX);
		pageY = isTouchEvent ? ev.targetTouches[0].pageY : (ev.pageY || ev.clientY);

		// Drag Direction
		this.drag.currentX = pageX - this.drag.startX;
		this.drag.currentY = pageY - this.drag.startY;
		this.drag.distance = this.drag.currentX - this.drag.offsetX;

		// Check move direction
		if (this.drag.distance < 0) {
			this.state.direction = this.settings.rtl ? 'right' : 'left';
		} else if (this.drag.distance > 0) {
			this.state.direction = this.settings.rtl ? 'left' : 'right';
		}
		// Loop
		if (this.settings.loop) {
			if (this.op(this.drag.currentX, '>', this.coordinates(this.minimum())) && this.state.direction === 'right') {
				this.drag.currentX -= (this.settings.center && this.coordinates(0)) - this.coordinates(this.num.oItems);
			} else if (this.op(this.drag.currentX, '<', this.coordinates(this.maximum())) && this.state.direction === 'left') {
				this.drag.currentX += (this.settings.center && this.coordinates(0)) - this.coordinates(this.num.oItems);
			}
		} else {
			// pull
			minValue = this.settings.rtl ? this.coordinates(this.maximum()) : this.coordinates(this.minimum());
			maxValue = this.settings.rtl ? this.coordinates(this.minimum()) : this.coordinates(this.maximum());
			pull = this.settings.pullDrag ? this.drag.distance / 5 : 0;
			this.drag.currentX = Math.max(Math.min(this.drag.currentX, minValue + pull), maxValue + pull);
		}

		// Lock browser if swiping horizontal

		if ((this.drag.distance > 8 || this.drag.distance < -8)) {
			if (ev.preventDefault !== undefined) {
				ev.preventDefault();
			} else {
				ev.returnValue = false;
			}
			this.state.isSwiping = true;
		}

		this.drag.updatedX = this.drag.currentX;

		// Lock Owl if scrolling
		if ((this.drag.currentY > 16 || this.drag.currentY < -16) && this.state.isSwiping === false) {
			this.state.isScrolling = true;
			this.drag.updatedX = this.drag.start;
		}

		this.animate(this.drag.updatedX);
	};

	/**
	 * Handles the touchend/mouseup events.
	 * @protected
	 */
	Owl.prototype.onDragEnd = function() {
		var compareTimes, distanceAbs, closest;

		if (!this.state.isTouch) {
			return;
		}
		if (this.dragType[0] === 'mousedown') {
			this.dom.$stage.removeClass('owl-grab');
		}

		this.trigger('dragged');

		// prevent links and images dragging;
		this.drag.targetEl.removeAttribute("draggable");

		// remove drag event listeners

		this.state.isTouch = false;
		this.state.isScrolling = false;
		this.state.isSwiping = false;

		// to check
		if (this.drag.distance === 0 && this.state.inMotion !== true) {
			this.state.inMotion = false;
			return false;
		}

		// prevent clicks while scrolling

		this.drag.endTime = new Date().getTime();
		compareTimes = this.drag.endTime - this.drag.startTime;
		distanceAbs = Math.abs(this.drag.distance);

		// to test
		if (distanceAbs > 3 || compareTimes > 300) {
			this.removeClick(this.drag.targetEl);
		}

		closest = this.closest(this.drag.updatedX);

		this.speed(this.settings.dragEndSpeed || this.settings.smartSpeed);
		this.current(closest);

		// if pullDrag is off then fire transitionEnd event manually when stick
		// to border
		if (!this.settings.pullDrag && this.drag.updatedX === this.coordinates(closest)) {
			this.transitionEnd();
		}

		this.drag.distance = 0;

		this.off(document, this.dragType[1], this.e._onDragMove);
		this.off(document, this.dragType[2], this.e._onDragEnd);
	};

	/**
	 * Attaches `preventClick` to disable link while swipping.
	 * @protected
	 * @param {HTMLElement} [target] - The target of the `click` event.
	 */
	Owl.prototype.removeClick = function(target) {
		this.drag.targetEl = target;
		$(target).on('click.preventClick', this.e._preventClick);
		// to make sure click is removed:
		window.setTimeout(function() {
			$(target).off('click.preventClick');
		}, 300);
	};

	/**
	 * Suppresses click event.
	 * @protected
	 * @param {Event} ev - The event arguments.
	 */
	Owl.prototype.preventClick = function(ev) {
		if (ev.preventDefault) {
			ev.preventDefault();
		} else {
			ev.returnValue = false;
		}
		if (ev.stopPropagation) {
			ev.stopPropagation();
		}
		$(ev.target).off('click.preventClick');
	};

	/**
	 * Catches stage position while animate (only CSS3).
	 * @protected
	 * @returns
	 */
	Owl.prototype.getTransformProperty = function() {
		var transform, matrix3d;

		transform = window.getComputedStyle(this.dom.stage, null).getPropertyValue(this.vendorName + 'transform');
		// var transform = this.dom.$stage.css(this.vendorName + 'transform')
		transform = transform.replace(/matrix(3d)?\(|\)/g, '').split(',');
		matrix3d = transform.length === 16;

		return matrix3d !== true ? transform[4] : transform[12];
	};

	/**
	 * Gets absolute position of the closest item for a coordinate.
	 * @protected
	 * @param {Number} coordinate - The coordinate in pixel.
	 * @return {Number} - The absolute position of the closest item.
	 */
	Owl.prototype.closest = function(coordinate) {
		var position = 0, pull = 30;

		if (!this.settings.freeDrag) {
			// check closest item
			$.each(this.coordinates(), $.proxy(function(index, value) {
				if (coordinate > value - pull && coordinate < value + pull) {
					position = index;
				} else if (this.op(coordinate, '<', value)
					&& this.op(coordinate, '>', this.coordinates(index + 1) || value - this.width.el)) {
					position = this.state.direction === 'left' ? index + 1 : index;
				}
			}, this));
		}

		if (!this.settings.loop) {
			// non loop boundries
			if (this.op(coordinate, '>', this.coordinates(this.minimum()))) {
				position = coordinate = this.minimum();
			} else if (this.op(coordinate, '<', this.coordinates(this.maximum()))) {
				position = coordinate = this.maximum();
			}
		}

		return position;
	};

	/**
	 * Animates the stage.
	 * @public
	 * @param {Number} coordinate - The coordinate in pixels.
	 */
	Owl.prototype.animate = function(coordinate) {
		this.trigger('translate');
		this.state.inMotion = this.speed() > 0;

		if (this.support3d) {
			this.dom.$stage.css({
				transform: 'translate3d(' + coordinate + 'px' + ',0px, 0px)',
				transition: (this.speed() / 1000) + 's'
			});
		} else if (this.state.isTouch) {
			this.dom.$stage.css({
				left: coordinate + 'px'
			});
		} else {
			this.dom.$stage.animate({
				left: coordinate
			}, this.speed() / 1000, this.settings.fallbackEasing, $.proxy(function() {
				if (this.state.inMotion) {
					this.transitionEnd();
				}
			}, this));
		}
	};

	/**
	 * Sets the absolute position of the current item.
	 * @public
	 * @param {Number} [position] - The new absolute position or nothing to leave it unchanged.
	 * @returns {Number} - The absolute position of the current item.
	 */
	Owl.prototype.current = function(position) {
		if (position === undefined) {
			return this._current;
		}

		if (this.num.oItems === 0) {
			return undefined;
		}

		position = this.normalize(position);

		if (this._current === position) {
			this.animate(this.coordinates(this._current));
		} else {
			var event = this.trigger('change', { property: { name: 'position', value: position } });

			if (event.data !== undefined) {
				position = this.normalize(event.data);
			}

			this._current = position;

			this.animate(this.coordinates(this._current));

			this.updateActiveItems();

			this.trigger('changed', { property: { name: 'position', value: this._current } });
		}

		return this._current;
	};

	/**
	 * Resets the absolute position of the current item.
	 * @public
	 * @param {Number} position - The absolute position of the new item.
	 */
	Owl.prototype.reset = function(position) {
		this.suppress([ 'change', 'changed' ]);
		this.speed(0);
		this.current(position);
		this.release([ 'change', 'changed' ]);
	};

	/**
	 * Normalizes an absolute position for an item.
	 * @public
	 * @param {Number} position - The absolute position to normalize.
	 * @param {Boolean} [relative=false] - Whether to return a relative position or not.
	 * @return {Number} - The normalized position.
	 */
	Owl.prototype.normalize = function(position, relative) {
		if (position === undefined || !this.dom.$items) {
			return undefined;
		}

		if (this.settings.loop) {
			var n = this.dom.$items.length;
			position = ((position % n) + n) % n;
		} else {
			position = Math.max(this.minimum(), Math.min(this.maximum(), position));
		}

		return relative ? this.dom.$items.eq(position).data('owl-item').index : position;
	};

	/**
	 * Gets the absolute maximum position for an item.
	 * @public
	 * @returns {Number}
	 */
	Owl.prototype.maximum = function() {
		var maximum, width,
			settings = this.settings;

		if (!settings.loop && settings.center) {
			maximum = this.num.oItems - 1;
		} else if (!settings.loop && !settings.center) {
			maximum = this.num.oItems - settings.items;
		} else if (settings.loop || settings.center) {
			maximum = this.num.oItems + settings.items;
		} else if (settings.autoWidth || settings.merge) {
			revert = settings.rtl ? 1 : -1;
			width = this.dom.$stage.width() - this.$el.width();
			$.each(this.coordinates(), function(index, coordinate) {
				if (coordinate * revert >= width) {
					return false;
				}
				maximum = index + 1;
			});
		} else {
			throw 'Can not detect maximum absolute position.'
		}

		return maximum;
	};

	/**
	 * Gets the absolute minimum position for an item.
	 * @public
	 * @returns {Number}
	 */
	Owl.prototype.minimum = function() {
		return this.dom.$oItems.eq(0).data('owl-item').indexAbs;
	};

	/**
	 * Sets the current animation speed.
	 * @public
	 * @param {Number} [speed] - The animation speed in millisecondsor nothing to leave it unchanged.
	 * @returns {Number} - The current animation speed in milliseconds.
	 */
	Owl.prototype.speed = function(speed) {
		if (speed !== undefined) {
			this._speed = speed;
		}

		return this._speed;
	};

	/**
	 * Gets the coordinate for an item.
	 * @public
	 * @param {Number} [position] - The absolute position of the item.
	 * @returns {Number|Array.<Number>} - The coordinate of the item in pixel or all coordinates.
	 */
	Owl.prototype.coordinates = function(position) {
		return position !== undefined ? this._coordinates[position] : this._coordinates;
	};

	/**
	 * Calculates the speed for a translation.
	 * @protected
	 * @param {Number} from - The absolute position of the start item.
	 * @param {Number} to - The absolute position of the target item.
	 * @param {Number} [factor=undefined] - The time factor in milliseconds.
	 * @returns {Number} - The time in milliseconds for the translation.
	 */
	Owl.prototype.duration = function(from, to, factor) {
		return Math.min(Math.max(Math.abs(to - from), 1), 6) * Math.abs((factor || this.settings.smartSpeed));
	};

	/**
	 * Slides to the specified item.
	 * @public
	 * @param {Number} position - The position of the item.
	 * @param {Number} [speed] - The time in milliseconds for the transition.
	 */
	Owl.prototype.to = function(position, speed) {
		if (this.settings.loop) {
			var distance = position - this.normalize(this.current(), true),
				revert = this.current(),
				before = this.current(),
				after = this.current() + distance,
				direction = before - after < 0 ? true : false;

			if (after < this.settings.items && direction === false) {
				revert = this.num.items - (this.settings.items - before) - this.settings.items;
				this.reset(revert);
			} else if (after >= this.num.items - this.settings.items && direction === true) {
				revert = before - this.num.oItems;
				this.reset(revert);
			}
			window.clearTimeout(this.e._goToLoop);
			this.e._goToLoop = window.setTimeout($.proxy(function() {
				this.speed(this.duration(this.current(), revert + distance, speed));
				this.current(revert + distance);
			}, this), 30);
		} else {
			this.speed(this.duration(this.current(), position, speed));
			this.current(position);
		}
	};

	/**
	 * Slides to the next item.
	 * @public
	 * @param {Number} [speed] - The time in milliseconds for the transition.
	 */
	Owl.prototype.next = function(speed) {
		speed = speed || false;
		this.to(this.normalize(this.current(), true) + 1, speed);
	};

	/**
	 * Slides to the previous item.
	 * @public
	 * @param {Number} [speed] - The time in milliseconds for the transition.
	 */
	Owl.prototype.prev = function(speed) {
		speed = speed || false;
		this.to(this.normalize(this.current(), true) - 1, speed);
	};

	/**
	 * Handles the end of an animation.
	 * @protected
	 * @param {Event} event - The event arguments.
	 */
	Owl.prototype.transitionEnd = function(event) {

		// if css2 animation then event object is undefined
		if (event !== undefined) {
			event.stopPropagation();

			// Catch only owl-stage transitionEnd event
			var eventTarget = event.target || event.srcElement || event.originalTarget;
			if (eventTarget !== this.dom.stage) {
				return false;
			}
		}

		this.state.inMotion = false;
		this.trigger('translated');
	};

	/**
	 * Checks if element width has changed
	 * @protected
	 * @returns {Booelan}
	 */
	Owl.prototype.isElWidthChanged = function() {
		var newElWidth = this.dom.$el.width() - this.settings.stagePadding, // to
		// check
		prevElWidth = this.width.el + this.settings.margin;
		return newElWidth !== prevElWidth;
	};

	/**
	 * Gets viewport width.
	 * @protected
	 * @return {Number} - The width in pixel.
	 */
	Owl.prototype.viewport = function() {
		var width;
		if (this.options.responsiveBaseElement !== window) {
			width = $(this.options.responsiveBaseElement).width();
		} else if (window.innerWidth) {
			width = window.innerWidth;
		} else if (document.documentElement && document.documentElement.clientWidth) {
			width = document.documentElement.clientWidth;
		} else {
			throw 'Can not detect viewport width.';
		}
		return width;
	};

	/**
	 * Replaces the current content.
	 * @public
	 * @param {HTMLElement|jQuery|String} content - The new content.
	 */
	Owl.prototype.insertContent = function(content) {
		this.dom.$stage.empty();
		this.fetchContent(content);
		this.refresh();
	};

	/**
	 * Adds an item.
	 * @public
	 * @param {HTMLElement|jQuery|String} content - The item content to add.
	 * @param {Number} [position=0] - The position at which to insert the item.
	 */
	Owl.prototype.addItem = function(content, position) {
		var $item = this.createItemContainer();

		position = position || 0;
		// wrap content
		this.initializeItemContainer($item, content);
		// if carousel is empty then append item
		if (this.dom.$oItems.length === 0) {
			this.dom.$stage.append($item);
		} else {
			// append item
			if (pos !== -1) {
				this.dom.$oItems.eq(position).before($item);
			} else {
				this.dom.$oItems.eq(position).after($item);
			}
		}
		// update and calculate carousel
		this.refresh();
	};

	/**
	 * Removes an item.
	 * @public
	 * @param {Number} pos - The position of the item.
	 */
	Owl.prototype.removeItem = function(pos) {
		this.dom.$oItems.eq(pos).remove();
		this.refresh();
	};

	/**
	 * Adds triggerable events.
	 * @protected
	 */
	Owl.prototype.addTriggerableEvents = function() {
		var handler = $.proxy(function(callback, event) {
			return $.proxy(function(e) {
				if (e.relatedTarget !== this) {
					this.suppress([ event ]);
					callback.apply(this, [].slice.call(arguments, 1));
					this.release([ event ]);
				}
			}, this);
		}, this);

		$.each({
			'next': this.next,
			'prev': this.prev,
			'to': this.to,
			'destroy': this.destroy,
			'refresh': this.refresh,
			'replace': this.insertContent,
			'add': this.addItem,
			'remove': this.removeItem
		}, $.proxy(function(event, callback) {
			this.dom.$el.on(event + '.owl.carousel', handler(callback, event + '.owl.carousel'));
		}, this));

	};

	/**
	 * Watches the visibility of the carousel element.
	 * @protected
	 */
	Owl.prototype.watchVisibility = function() {

		// test on zepto
		if (!isElVisible(this.dom.el)) {
			this.dom.$el.addClass('owl-hidden');
			window.clearInterval(this.e._checkVisibile);
			this.e._checkVisibile = window.setInterval($.proxy(checkVisible, this), 500);
		}

		function isElVisible(el) {
			return el.offsetWidth > 0 && el.offsetHeight > 0;
		}

		function checkVisible() {
			if (isElVisible(this.dom.el)) {
				this.dom.$el.removeClass('owl-hidden');
				this.refresh();
				window.clearInterval(this.e._checkVisibile);
			}
		}
	};

	/**
	 * Preloads images with auto width.
	 * @protected
	 * @todo Still to test
	 */
	Owl.prototype.preloadAutoWidthImages = function(imgs) {
		var loaded, that, $el, img;

		loaded = 0;
		that = this;
		imgs.each(function(i, el) {
			$el = $(el);
			img = new Image();

			img.onload = function() {
				loaded++;
				$el.attr('src', img.src);
				$el.css('opacity', 1);
				if (loaded >= imgs.length) {
					that.state.imagesLoaded = true;
					that.init();
				}
			};

			img.src = $el.attr('src') || $el.attr('data-src') || $el.attr('data-src-retina');
		});
	};

	/**
	 * Destroys the carousel.
	 * @public
	 */
	Owl.prototype.destroy = function() {

		if (this.dom.$el.hasClass(this.settings.themeClass)) {
			this.dom.$el.removeClass(this.settings.themeClass);
		}

		if (this.settings.responsive !== false) {
			this.off(window, 'resize', this.e._resizer);
		}

		if (this.transitionEndVendor) {
			this.off(this.dom.stage, this.transitionEndVendor, this.e._transitionEnd);
		}

		for ( var i in this.plugins) {
			this.plugins[i].destroy();
		}

		if (this.settings.mouseDrag || this.settings.touchDrag) {
			this.off(this.dom.stage, this.dragType[0], this.e._onDragStart);
			if (this.settings.mouseDrag) {
				this.off(document, this.dragType[3], this.e._onDragStart);
			}
			if (this.settings.mouseDrag) {
				this.dom.$stage.off('dragstart', function() {
					return false;
				});
				this.dom.stage.onselectstart = function() {
				};
			}
		}

		// Remove event handlers in the ".owl.carousel" namespace
		this.dom.$el.off('.owl');

		if (this.dom.$cItems !== null) {
			this.dom.$cItems.remove();
		}
		this.e = null;
		this.dom.$el.data('owlCarousel', null);
		delete this.dom.el.owlCarousel;

		this.dom.$stage.unwrap();
		this.dom.$items.unwrap();
		this.dom.$items.contents().unwrap();
		this.dom = null;
	};

	/**
	 * Operators to calculate right-to-left and left-to-right.
	 * @protected
	 * @param {Number} [a] - The left side operand.
	 * @param {String} [o] - The operator.
	 * @param {Number} [b] - The right side operand.
	 */
	Owl.prototype.op = function(a, o, b) {
		var rtl = this.settings.rtl;
		switch (o) {
		case '<':
			return rtl ? a > b : a < b;
		case '>':
			return rtl ? a < b : a > b;
		case '>=':
			return rtl ? a <= b : a >= b;
		case '<=':
			return rtl ? a >= b : a <= b;
		default:
			break;
		}
	};

	/**
	 * Attaches to an internal event.
	 * @protected
	 * @param {HTMLElement} element - The event source.
	 * @param {String} event - The event name.
	 * @param {Function} listener - The event handler to attach.
	 * @param {Boolean} capture - Wether the event should be handled at the capturing phase or not.
	 */
	Owl.prototype.on = function(element, event, listener, capture) {
		if (element.addEventListener) {
			element.addEventListener(event, listener, capture);
		} else if (element.attachEvent) {
			element.attachEvent('on' + event, listener);
		}
	};

	/**
	 * Detaches from an internal event.
	 * @protected
	 * @param {HTMLElement} element - The event source.
	 * @param {String} event - The event name.
	 * @param {Function} listener - The attached event handler to detach.
	 * @param {Boolean} capture - Wether the attached event handler was registered as a capturing listener or not.
	 */
	Owl.prototype.off = function(element, event, listener, capture) {
		if (element.removeEventListener) {
			element.removeEventListener(event, listener, capture);
		} else if (element.detachEvent) {
			element.detachEvent('on' + event, listener);
		}
	};

	/**
	 * Triggers an public event.
	 * @protected
	 * @param {String} name - The event name.
	 * @param {*} [data=null] - The event data.
	 * @param {String} [namespace=.owl.carousel] - The event namespace.
	 * @returns {Event} - The event arguments.
	 */
	Owl.prototype.trigger = function(name, data, namespace) {
		var status = {
			item: { count: this.num.oItems, index: this.current() }
		}, handler = $.camelCase(
			$.grep([ 'on', name, namespace ], function(v) { return v })
				.join('-').toLowerCase()
		), event = $.Event(
			[ name, 'owl', namespace || 'carousel' ].join('.').toLowerCase(),
			$.extend({ relatedTarget: this }, status, data)
		);

		if (!this._supress[event.type]) {
			$.each(this.plugins, function(name, plugin) {
				if (plugin.onTrigger) {
					plugin.onTrigger(event);
				}
			});

			this.dom.$el.trigger(event);

			if (typeof this.settings[handler] === 'function') {
				this.settings[handler].apply(this, event);
			}
		}

		return event;
	};

	/**
	 * Suppresses events.
	 * @protected
	 * @param {Array.<String>} events - The events to suppress.
	 */
	Owl.prototype.suppress = function(events) {
		$.each(events, $.proxy(function(index, event) {
			this._supress[event] = true;
		}, this));
	}

	/**
	 * Releases suppressed events.
	 * @protected
	 * @param {Array.<String>} events - The events to release.
	 */
	Owl.prototype.release = function(events) {
		$.each(events, $.proxy(function(index, event) {
			delete this._supress[event];
		}, this));
	}

	/**
	 * Checks the availability of some browser features.
	 * @protected
	 */
	Owl.prototype.browserSupport = function() {
		this.support3d = isPerspective();

		if (this.support3d) {
			this.transformVendor = isTransform();

			// take transitionend event name by detecting transition
			var endVendors = [ 'transitionend', 'webkitTransitionEnd', 'transitionend', 'oTransitionEnd' ];
			this.transitionEndVendor = endVendors[isTransition()];

			// take vendor name from transform name
			this.vendorName = this.transformVendor.replace(/Transform/i, '');
			this.vendorName = this.vendorName !== '' ? '-' + this.vendorName.toLowerCase() + '-' : '';
		}

		this.state.orientation = window.orientation;
	};

	/**
	 * Checks for CSS support.
	 * @private
	 * @param {Array} array - The CSS properties to check for.
	 * @returns {Array} - Contains the supported CSS property name and its index or `false`.
	 */
	function isStyleSupported(array) {
		var p, s, fake = document.createElement('div'), list = array;
		for (p in list) {
			s = list[p];
			if (typeof fake.style[s] !== 'undefined') {
				fake = null;
				return [ s, p ];
			}
		}
		return [ false ];
	}

	/**
	 * Checks for CSS transition support.
	 * @private
	 * @todo Realy bad design
	 * @returns {Number}
	 */
	function isTransition() {
		return isStyleSupported([ 'transition', 'WebkitTransition', 'MozTransition', 'OTransition' ])[1];
	}

	/**
	 * Checks for CSS transform support.
	 * @private
	 * @returns {String} The supported property name or false.
	 */
	function isTransform() {
		return isStyleSupported([ 'transform', 'WebkitTransform', 'MozTransform', 'OTransform', 'msTransform' ])[0];
	}

	/**
	 * Checks for CSS perspective support.
	 * @private
	 * @returns {String} The supported property name or false.
	 */
	function isPerspective() {
		return isStyleSupported([ 'perspective', 'webkitPerspective', 'MozPerspective', 'OPerspective', 'MsPerspective' ])[0];
	}

	/**
	 * Checks wether touch is supported or not.
	 * @private
	 * @returns {Boolean}
	 */
	function isTouchSupport() {
		return 'ontouchstart' in window || !!(navigator.msMaxTouchPoints);
	}

	/**
	 * Checks wether touch is supported or not for IE.
	 * @private
	 * @returns {Boolean}
	 */
	function isTouchSupportIE() {
		return window.navigator.msPointerEnabled;
	}

	/**
	 * The jQuery Plugin for the Owl Carousel
	 * @public
	 */
	$.fn.owlCarousel = function(options) {
		return this.each(function() {
			if (!$(this).data('owlCarousel')) {
				$(this).data('owlCarousel', new Owl(this, options));
			}
		});
	};

	/**
	 * The constructor for the jQuery Plugin
	 * @public
	 */
	$.fn.owlCarousel.Constructor = Owl;

})(window.Zepto || window.jQuery, window, document);

/**
 * LazyLoad Plugin
 * @version 2.0.0
 * @author Bartosz Wojciechowski
 * @license The MIT License (MIT)
 */
;(function($, window, document, undefined) {

	/**
	 * Creates the lazy load plugin.
	 * @class The Lazy Load Plugin
	 * @param {Owl} scope - The Owl Carousel
	 */
	LazyLoad = function(scope) {
		this.owl = scope;
		this.owl.options = $.extend({}, LazyLoad.Defaults, this.owl.options);

		this.handlers = {
			'changed.owl.carousel': $.proxy(function(e) {
				if (e.property.name == 'items' && e.property.value && !e.property.value.is(':empty')) {
					this.check();
				}
			}, this)
		};

		this.owl.dom.$el.on(this.handlers);
	};

	/**
	 * Default options.
	 * @public
	 */
	LazyLoad.Defaults = {
		lazyLoad: false
	};

	/**
	 * Checks all items and if necessary, calls `preload`.
	 * @protected
	 */
	LazyLoad.prototype.check = function() {
		var attr = window.devicePixelRatio > 1 ? 'data-src-retina' : 'data-src',
			src, img, i, $item;

		for (i = 0; i < this.owl.num.items; i++) {
			$item = this.owl.dom.$items.eq(i);

			if ($item.data('owl-item').current === true && $item.data('owl-item').loaded === false) {
				img = $item.find('.owl-lazy');
				src = img.attr(attr);
				src = src || img.attr('data-src');
				if (src) {
					img.css('opacity', '0');
					this.preload(img, $item);
				}
			}
		}
	};

	/**
	 * Preloads the images of an item.
	 * @protected
	 * @param {jQuery} images - The images to load.
	 * @param {jQuery} $item - The item for which the images are loaded.
	 */
	LazyLoad.prototype.preload = function(images, $item) {
		var $el, img, srcType;

		images.each($.proxy(function(i, el) {

			this.owl.trigger('load', null, 'lazy');

			$el = $(el);
			img = new Image();
			srcType = window.devicePixelRatio > 1 ? $el.attr('data-src-retina') : $el.attr('data-src');
			srcType = srcType || $el.attr('data-src');

			img.onload = $.proxy(function() {
				$item.data('owl-item').loaded = true;
				if ($el.is('img')) {
					$el.attr('src', img.src);
				} else {
					$el.css('background-image', 'url(' + img.src + ')');
				}

				$el.css('opacity', 1);
				this.owl.trigger('loaded', null, 'lazy');
			}, this);
			img.src = srcType;
		}, this));
	};

	/**
	 * Destroys the plugin.
	 * @public
	 */
	LazyLoad.prototype.destroy = function() {
		var handler, property;

		for (handler in this.handlers) {
			this.owl.dom.$el.off(handler, this.handlers[handler]);
		}
		for (property in Object.getOwnPropertyNames(this)) {
			typeof this[property] != 'function' && (this[property] = null);
		}
	};

	$.fn.owlCarousel.Constructor.Plugins.lazyLoad = LazyLoad;

})(window.Zepto || window.jQuery, window, document);

/**
 * AutoHeight Plugin
 * @version 2.0.0
 * @author Bartosz Wojciechowski
 * @license The MIT License (MIT)
 */
;(function($, window, document, undefined) {

	/**
	 * Creates the auto height plugin.
	 * @class The Auto Height Plugin
	 * @param {Owl} scope - The Owl Carousel
	 */
	AutoHeight = function(scope) {
		this.owl = scope;
		this.owl.options = $.extend({}, AutoHeight.Defaults, this.owl.options);

		this.handlers = {
			'changed.owl.carousel': $.proxy(function(e) {
				if (e.property.name == 'position' && this.owl.settings.autoHeight){
					this.setHeight();
				}
			}, this)
		};

		this.owl.dom.$el.on(this.handlers);
	};

	/**
	 * Default options.
	 * @public
	 */
	AutoHeight.Defaults = {
		autoHeight: false,
		autoHeightClass: 'owl-height'
	};

	/**
	 *
	 * @param {Boolean} callback - Whether
	 * @returns {Boolean}
	 */
	AutoHeight.prototype.setHeight = function() {
		var loaded = this.owl.dom.$items.eq(this.owl.current()),
			stage = this.owl.dom.$oStage,
			iterations = 0,
			isLoaded;

		if (!this.owl.dom.$oStage.hasClass(this.owl.settings.autoHeightClass)) {
			this.owl.dom.$oStage.addClass(this.owl.settings.autoHeightClass);
		}

		isLoaded = window.setInterval(function() {
			iterations += 1;
			if (loaded.data('owl-item').loaded) {
				stage.height(loaded.height() + 'px');
				clearInterval(isLoaded);
			} else if (iterations === 500) {
				clearInterval(isLoaded);
			}
		}, 100);

	};

	AutoHeight.prototype.destroy = function() {
		var handler, property;

		for (handler in this.handlers) {
			this.owl.dom.$el.off(handler, this.handlers[handler]);
		}
		for (property in Object.getOwnPropertyNames(this)) {
			typeof this[property] != 'function' && (this[property] = null);
		}
	};

	$.fn.owlCarousel.Constructor.Plugins.autoHeight = AutoHeight;

})(window.Zepto || window.jQuery, window, document);

/**
 * Video Plugin
 * @version 2.0.0
 * @author Bartosz Wojciechowski
 * @license The MIT License (MIT)
 */
;(function($, window, document, undefined) {

	/**
	 * Creates the video plugin.
	 * @class The Video Plugin
	 * @param {Owl} scope - The Owl Carousel
	 */
	Video = function(scope) {
		this.owl = scope;
		this.owl.options = $.extend({}, Video.Defaults, this.owl.options);

		this.handlers = {
			'resize.owl.carousel': $.proxy(function(e) {
				if (this.owl.settings.video && !this.isInFullScreen()) {
					e.preventDefault();
				}
			}, this),
			'refresh.owl.carousel changed.owl.carousel': $.proxy(function(e) {
				if (this.owl.state.videoPlay) {
					this.stopVideo();
				}
			}, this),
			'refresh.owl.carousel refreshed.owl.carousel': $.proxy(function(e) {
				if (!this.owl.settings.video) {
					return false;
				}
				this.refreshing = e.type == 'refresh';
			}, this),
			'changed.owl.carousel': $.proxy(function(e) {
				if (this.refreshing && e.property.name == 'items' && e.property.value && !e.property.value.is(':empty')) {
					this.checkVideoLinks();
				}
			}, this)
		};

		this.owl.dom.$el.on(this.handlers);

		this.owl.dom.$el.on('click.owl.video', '.owl-video-play-icon', $.proxy(function(e) {
			this.playVideo(e);
		}, this));
	};

	/**
	 * Default options.
	 * @public
	 */
	Video.Defaults = {
		video: false,
		videoHeight: false,
		videoWidth: false
	};

	/**
	 * Checks if for any videos links exists.
	 * @protected
	 */
	Video.prototype.checkVideoLinks = function() {
		var videoEl, item, i;

		for (i = 0; i < this.owl.num.items; i++) {

			item = this.owl.dom.$items.eq(i);
			if (item.data('owl-item').hasVideo) {
				continue;
			}

			videoEl = item.find('.owl-video');
			if (videoEl.length) {
				this.owl.state.hasVideos = true;
				this.owl.dom.$items.eq(i).data('owl-item').hasVideo = true;
				videoEl.css('display', 'none');
				this.getVideoInfo(videoEl, item);
			}
		}
	};

	/**
	 * Gets the video ID and the type (YouTube/Vimeo only).
	 * @protected
	 * @param {jQuery} videoEl - The element containing the video data.
	 * @param {jQuery} item - The item containing the video.
	 */
	Video.prototype.getVideoInfo = function(videoEl, item) {

		var info, type, id, dimensions,
			vimeoId = videoEl.data('vimeo-id'),
			youTubeId = videoEl.data('youtube-id'),
			width = videoEl.data('width') || this.owl.settings.videoWidth,
			height = videoEl.data('height') || this.owl.settings.videoHeight,
			url = videoEl.attr('href');

		if (vimeoId) {
			type = 'vimeo';
			id = vimeoId;
		} else if (youTubeId) {
			type = 'youtube';
			id = youTubeId;
		} else if (url) {
			id = url.match(/(http:|https:|)\/\/(player.|www.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/);

			if (id[3].indexOf('youtu') > -1) {
				type = 'youtube';
			} else if (id[3].indexOf('vimeo') > -1) {
				type = 'vimeo';
			}
			id = id[6];
		} else {
			throw new Error('Missing video link.');
		}

		item.data('owl-item').videoType = type;
		item.data('owl-item').videoId = id;
		item.data('owl-item').videoWidth = width;
		item.data('owl-item').videoHeight = height;

		info = {
			type: type,
			id: id
		};

		// Check dimensions
		dimensions = width && height ? 'style="width:' + width + 'px;height:' + height + 'px;"' : '';

		// wrap video content into owl-video-wrapper div
		videoEl.wrap('<div class="owl-video-wrapper"' + dimensions + '></div>');

		this.createVideoTn(videoEl, info);
	};

	/**
	 * Creates video thumbnail.
	 * @protected
	 * @param {jQuery} videoEl - The element containing the video data.
	 * @param {Object} info - The video info object.
	 * @see `getVideoInfo`
	 */
	Video.prototype.createVideoTn = function(videoEl, info) {

		var tnLink, icon, path,
			customTn = videoEl.find('img'),
			srcType = 'src',
			lazyClass = '',
			that = this.owl;

		if (this.owl.settings.lazyLoad) {
			srcType = 'data-src';
			lazyClass = 'owl-lazy';
		}

		// Custom thumbnail

		if (customTn.length) {
			addThumbnail(customTn.attr(srcType));
			customTn.remove();
			return false;
		}

		function addThumbnail(tnPath) {
			icon = '<div class="owl-video-play-icon"></div>';

			if (that.settings.lazyLoad) {
				tnLink = '<div class="owl-video-tn ' + lazyClass + '" ' + srcType + '="' + tnPath + '"></div>';
			} else {
				tnLink = '<div class="owl-video-tn" style="opacity:1;background-image:url(' + tnPath + ')"></div>';
			}
			videoEl.after(tnLink);
			videoEl.after(icon);
		}

		if (info.type === 'youtube') {
			path = "http://img.youtube.com/vi/" + info.id + "/hqdefault.jpg";
			addThumbnail(path);
		} else if (info.type === 'vimeo') {
			$.ajax({
				type: 'GET',
				url: 'http://vimeo.com/api/v2/video/' + info.id + '.json',
				jsonp: 'callback',
				dataType: 'jsonp',
				success: function(data) {
					path = data[0].thumbnail_large;
					addThumbnail(path);
					if (that.settings.loop) {
						that.updateActiveItems();
					}
				}
			});
		}
	};

	/**
	 * Stops the current video.
	 * @public
	 */
	Video.prototype.stopVideo = function() {
		this.owl.trigger('stop', null, 'video');
		var item = this.owl.dom.$items.eq(this.owl.state.videoPlayIndex);
		item.find('.owl-video-frame').remove();
		item.removeClass('owl-video-playing');
		this.owl.state.videoPlay = false;
	};

	/**
	 * Starts the current video.
	 * @public
	 * @param {Event} ev - The event arguments.
	 */
	Video.prototype.playVideo = function(ev) {
		this.owl.trigger('play', null, 'video');

		if (this.owl.state.videoPlay) {
			this.stopVideo();
		}
		var videoLink, videoWrap, videoType,
			target = $(ev.target || ev.srcElement),
			item = target.closest('.' + this.owl.settings.itemClass);

		videoType = item.data('owl-item').videoType, id = item.data('owl-item').videoId, width = item
			.data('owl-item').videoWidth
			|| Math.floor(item.data('owl-item').width - this.owl.settings.margin), height = item.data('owl-item').videoHeight
			|| this.owl.dom.$stage.height();

		if (videoType === 'youtube') {
			videoLink = "<iframe width=\"" + width + "\" height=\"" + height + "\" src=\"http://www.youtube.com/embed/"
				+ id + "?autoplay=1&v=" + id + "\" frameborder=\"0\" allowfullscreen></iframe>";
		} else if (videoType === 'vimeo') {
			videoLink = '<iframe src="http://player.vimeo.com/video/' + id + '?autoplay=1" width="' + width
				+ '" height="' + height
				+ '" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>';
		}

		item.addClass('owl-video-playing');
		this.owl.state.videoPlay = true;
		this.owl.state.videoPlayIndex = item.data('owl-item').indexAbs;

		videoWrap = $('<div style="height:' + height + 'px; width:' + width + 'px" class="owl-video-frame">'
			+ videoLink + '</div>');
		target.after(videoWrap);
	};

	/**
	 * Checks whether an video is currently in full screen mode or not.
	 * @protected
	 * @returns {Boolean}
	 */
	Video.prototype.isInFullScreen = function() {

		// if Vimeo Fullscreen mode
		var fullscreenElement = document.fullscreenElement || document.mozFullScreenElement
			|| document.webkitFullscreenElement;
		if (fullscreenElement) {
			if ($(fullscreenElement.parentNode).hasClass('owl-video-frame')) {
				this.owl.speed(0);
				this.owl.state.isFullScreen = true;
			}
		}

		if (fullscreenElement && this.owl.state.isFullScreen && this.owl.state.videoPlay) {
			return false;
		}

		// Comming back from fullscreen
		if (this.owl.state.isFullScreen) {
			this.owl.state.isFullScreen = false;
			return false;
		}

		// check full screen mode and window orientation
		if (this.owl.state.videoPlay) {
			if (this.owl.state.orientation !== window.orientation) {
				this.owl.state.orientation = window.orientation;
				return false;
			}
		}
		return true;
	};

	/**
	 * Destroys the plugin.
	 */
	Video.prototype.destroy = function() {
		var handler, property;

		this.owl.dom.$el.off('click.owl.video');

		for (handler in this.handlers) {
			this.owl.dom.$el.off(handler, this.handlers[handler]);
		}
		for (property in Object.getOwnPropertyNames(this)) {
			typeof this[property] != 'function' && (this[property] = null);
		}
	};

	$.fn.owlCarousel.Constructor.Plugins.video = Video;

})(window.Zepto || window.jQuery, window, document);

/**
 * Animate Plugin
 * @version 2.0.0
 * @author Bartosz Wojciechowski
 * @license The MIT License (MIT)
 */
;(function($, window, document, undefined) {

	/**
	 * Creates the animate plugin.
	 * @class The Navigation Plugin
	 * @param {Owl} scope - The Owl Carousel
	 */
	Animate = function(scope) {
		this.core = scope;
		this.core.options = $.extend({}, Animate.Defaults, this.core.options);
		this.swapping = true;
		this.previous = undefined;
		this.next = undefined;

		this.handlers = {
			'change.owl.carousel': $.proxy(function(e) {
				if (e.property.name == 'position') {
					this.previous = this.core.current();
					this.next = e.property.value;
				}
			}, this),
			'drag.owl.carousel dragged.owl.carousel translated.owl.carousel': $.proxy(function(e) {
				this.swapping = e.type == 'translated';
			}, this),
			'translate.owl.carousel': $.proxy(function(e) {
				if (this.swapping && (this.core.options.animateOut || this.core.options.animateIn)) {
					this.swap();
				}
			}, this)
		};

		this.core.dom.$el.on(this.handlers);
	};

	/**
	 * Default options.
	 * @public
	 */
	Animate.Defaults = {
		animateOut: false,
		animateIn: false
	};

	/**
	 * Toggles the animation classes whenever an translations starts.
	 * @protected
	 * @returns {Boolean|undefined}
	 */
	Animate.prototype.swap = function() {

		if (this.core.settings.items !== 1 || !this.core.support3d) {
			return;
		}

		this.core.speed(0);

		var left,
			clear = $.proxy(this.clear, this),
			previous = this.core.dom.$items.eq(this.previous),
			next = this.core.dom.$items.eq(this.next),
			incoming = this.core.settings.animateIn,
			outgoing = this.core.settings.animateOut;

		if (this.core.current() === this.previous) {
			return;
		}

		if (outgoing) {
			left = this.core.coordinates(this.previous) - this.core.coordinates(this.next);
			previous.css( { 'left': left + 'px' } )
				.addClass('animated owl-animated-out')
				.addClass(outgoing)
				.one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', clear);
		}

		if (incoming) {
			next.addClass('animated owl-animated-in')
				.addClass(incoming)
				.one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', clear);
		}
	};

	Animate.prototype.clear = function(e) {
		$(e.target).css( { 'left': '' } )
			.removeClass('animated owl-animated-out owl-animated-in')
			.removeClass(this.core.settings.animateIn)
			.removeClass(this.core.settings.animateOut);
		this.core.transitionEnd();
	}

	/**
	 * Destroys the plugin.
	 * @public
	 */
	Animate.prototype.destroy = function() {
		var handler, property;

		for (handler in this.handlers) {
			this.core.dom.$el.off(handler, this.handlers[handler]);
		}
		for (property in Object.getOwnPropertyNames(this)) {
			typeof this[property] != 'function' && (this[property] = null);
		}
	};

	$.fn.owlCarousel.Constructor.Plugins.Animate = Animate;

})(window.Zepto || window.jQuery, window, document);

/**
 * Autoplay Plugin
 * @version 2.0.0
 * @author Bartosz Wojciechowski
 * @license The MIT License (MIT)
 */
;(function($, window, document, undefined) {

	/**
	 * Creates the autoplay plugin.
	 * @class The Autoplay Plugin
	 * @param {Owl} scope - The Owl Carousel
	 */
	Autoplay = function(scope) {
		this.core = scope;
		this.core.options = $.extend({}, Autoplay.Defaults, this.core.options);

		this.handlers = {
			'translated.owl.carousel refreshed.owl.carousel': $.proxy(function() {
				this.autoplay();
			}, this),
			'play.owl.autoplay': $.proxy(function(e, t, s) {
				this.play(t, s);
			}, this),
			'stop.owl.autoplay': $.proxy(function() {
				this.stop();
			}, this),
			'mouseover.owl.autoplay': $.proxy(function() {
				if (this.core.settings.autoplayHoverPause) {
					this.pause();
				}
			}, this),
			'mouseleave.owl.autoplay': $.proxy(function() {
				if (this.core.settings.autoplayHoverPause) {
					this.autoplay();
				}
			}, this)
		};

		this.core.dom.$el.on(this.handlers);
	};

	/**
	 * Default options.
	 * @public
	 */
	Autoplay.Defaults = {
		autoplay: false,
		autoplayTimeout: 5000,
		autoplayHoverPause: false,
		autoplaySpeed: false
	};

	/**
	 * @protected
	 * @todo Must be documented.
	 */
	Autoplay.prototype.autoplay = function() {
		if (this.core.settings.autoplay && !this.core.state.videoPlay) {
			window.clearInterval(this.interval);

			this.interval = window.setInterval($.proxy(function() {
				this.play();
			}, this), this.core.settings.autoplayTimeout);
		} else {
			window.clearInterval(this.interval);
		}
	};

	/**
	 * Starts the autoplay.
	 * @public
	 * @param {Number} [timeout] - ...
	 * @param {Number} [speed] - ...
	 * @returns {Boolean|undefined} - ...
	 * @todo Must be documented.
	 */
	Autoplay.prototype.play = function(timeout, speed) {
		// if tab is inactive - doesnt work in <IE10
		if (document.hidden === true) {
			return;
		}

		if (this.core.state.isTouch || this.core.state.isScrolling
			|| this.core.state.isSwiping || this.core.state.inMotion) {
			return;
		}

		if (this.core.settings.autoplay === false) {
			window.clearInterval(this.interval);
			return;
		}

		this.core.next(this.core.settings.autoplaySpeed);
	};

	/**
	 * Stops the autoplay.
	 * @public
	 */
	Autoplay.prototype.stop = function() {
		window.clearInterval(this.interval);
	};

	/**
	 * Pauses the autoplay.
	 * @public
	 */
	Autoplay.prototype.pause = function() {
		window.clearInterval(this.interval);
	};

	/**
	 * Destroys the plugin.
	 */
	Autoplay.prototype.destroy = function() {
		var handler, property;

		window.clearInterval(this.interval);

		for (handler in this.handlers) {
			this.core.dom.$el.off(handler, this.handlers[handler]);
		}
		for (property in Object.getOwnPropertyNames(this)) {
			typeof this[property] != 'function' && (this[property] = null);
		}
	};

	$.fn.owlCarousel.Constructor.Plugins.autoplay = Autoplay;

})(window.Zepto || window.jQuery, window, document);

/**
 * Navigation Plugin
 * @version 2.0.0
 * @author Artus Kolanowski
 * @license The MIT License (MIT)
 */
;(function($, window, document, undefined) {
	'use strict';

	/**
	 * Creates the navigation plugin.
	 * @class The Navigation Plugin
	 * @param {Owl} carousel - The Owl Carousel.
	 */
	var Navigation = function(carousel) {
		/**
		 * Reference to the core.
		 * @type {Owl}
		 */
		this.core = carousel;

		/**
		 * Indicates whether the plugin is initialized or not.
		 * @type {Boolean}
		 */
		this.initialized = false;

		/**
		 * The current paging indexes.
		 * @type {Array}
		 */
		this.pages = [];

		/**
		 * All DOM elements of the user interface.
		 * @type {Object}
		 */
		this.controls = {};

		/**
		 * Markup for an indicator.
		 * @type {String}
		 */
		this.template = null;

		/**
		 * The carousel element.
		 * @type {jQuery}
		 */
		this.$element = this.core.dom.$el;

		/**
		 * Overridden methods of the carousel.
		 * @type {Object}
		 */
		this.overrides = {
			next: this.core.next,
			prev: this.core.prev,
			to: this.core.to
		};

		/**
		 * All event handlers.
		 * @type {Object}
		 */
		this.handlers = {
			'changed.owl.carousel': $.proxy(function(e) {
				if (e.property.name == 'items') {
					if (!this.initialized) {
						this.initialize();
						this.initialized = true;
					}
					this.update();
					this.draw();
				}
				if (this.filling) {
					e.property.value.data('owl-item').dot = $(':first-child', e.property.value)
						.find('[data-dot]').andSelf().data('dot');
				}
			}, this),
			'change.owl.carousel': $.proxy(function(e) {
				if (e.property.name == 'position' && !this.core.state.revert
					&& !this.core.settings.loop && this.core.settings.navRewind) {
					var current = this.core.current(),
						maximum = this.core.maximum(),
						minimum = this.core.minimum();
					e.data = e.property.value > maximum
						? current >= maximum ? minimum : maximum
						: e.property.value < minimum ? maximum : e.property.value;
				}
				this.filling = this.core.settings.dotsData && e.property.name == 'item'
					&& e.property.value && e.property.value.is(':empty');
			}, this),
			'refreshed.owl.carousel': $.proxy(function() {
				if (this.initialized) {
					this.update();
					this.draw();
				}
			}, this)
		};

		// set default options
		this.core.options = $.extend({}, Navigation.Defaults, this.core.options);

		// register event handlers
		this.$element.on(this.handlers);
	}

	/**
	 * Default options.
	 * @public
	 * @todo Rename `slideBy` to `navBy`
	 */
	Navigation.Defaults = {
		nav: false,
		navRewind: true,
		navText: [ 'prev', 'next' ],
		navSpeed: false,
		navElement: 'div',
		navContainer: false,
		navContainerClass: 'owl-nav',
		navClass: [ 'owl-prev', 'owl-next' ],
		slideBy: 1,
		dotClass: 'owl-dot',
		dotsClass: 'owl-dots',
		dots: true,
		dotsEach: false,
		dotData: false,
		dotsSpeed: false,
		dotsContainer: false,
		controlsClass: 'owl-controls'
	}

	/**
	 * Initializes the layout of the plugin and extends the carousel.
	 * @protected
	 */
	Navigation.prototype.initialize = function() {
		var $container, override,
			options = this.core.settings;

		// create the indicator template
		if (!options.dotsData) {
			this.template = $('<div>')
				.addClass(options.dotClass)
				.append($('<span>'))
				.prop('outerHTML');
		}

		// create controls container if needed
		if (!options.navContainer || !options.dotsContainer) {
			this.controls.$container = $('<div>')
				.addClass(options.controlsClass)
				.appendTo(this.$element);
		}

		// create DOM structure for absolute navigation
		this.controls.$indicators = options.dotsContainer ? $(options.dotsContainer)
			: $('<div>').hide().addClass(options.dotsClass).appendTo(this.controls.$container);

		this.controls.$indicators.on(this.core.dragType[2], 'div', $.proxy(function(e) {
			var index = $(e.target).parent().is(this.controls.$indicators)
				? $(e.target).index() : $(e.target).parent().index();

			e.preventDefault();

			this.to(index, options.dotsSpeed);
		}, this));

		// create DOM structure for relative navigation
		$container = options.navContainer ? $(options.navContainer)
			: $('<div>').addClass(options.navContainerClass).prependTo(this.controls.$container);

		this.controls.$next = $('<' + options.navElement + '>');
		this.controls.$previous = this.controls.$next.clone();

		this.controls.$previous
			.addClass(options.navClass[0])
			.html(options.navText[0])
			.hide()
			.prependTo($container)
			.on(this.core.dragType[2], $.proxy(function(e) {
				this.prev();
			}, this));
		this.controls.$next
			.addClass(options.navClass[1])
			.html(options.navText[1])
			.hide()
			.appendTo($container)
			.on(this.core.dragType[2], $.proxy(function(e) {
				this.next();
			}, this));

		// override public methods of the carousel
		for (override in this.overrides) {
			this.core[override] = $.proxy(this[override], this);
		}
	}

	/**
	 * Destroys the plugin.
	 * @protected
	 */
	Navigation.prototype.destroy = function() {
		var handler, control, property, override;

		for (handler in this.handlers) {
			this.$element.off(handler, this.handlers[handler]);
		}
		for (control in this.controls) {
			this.controls[control].remove();
		}
		for (override in this.overides) {
			this.core[override] = this.overrides[override];
		}
		for (property in Object.getOwnPropertyNames(this)) {
			typeof this[property] != 'function' && (this[property] = null);
		}
	}

	/**
	 * Updates the internal state.
	 * @protected
	 */
	Navigation.prototype.update = function() {
		var i, j, k,
			options = this.core.settings,
			lower = this.core.num.cItems / 2,
			upper = this.core.num.items - lower,
			size = options.center || options.autoWidth || options.dotData
				? 1 : options.dotsEach || options.items;

		if (options.slideBy !== 'page') {
			options.slideBy = Math.min(options.slideBy, options.items);
		}

		if (options.dots) {
			this.pages = [];

			for (i = lower, j = 0, k = 0; i < upper; i++) {
				if (j >= size || j === 0) {
					this.pages.push({
						start: i - lower,
						end: i - lower + size - 1
					});
					j = 0, ++k;
				}
				j += this.core.num.merged[i];
			}
		}
	}

	/**
	 * Draws the user interface.
	 * @protected
	 */
	Navigation.prototype.draw = function() {
		var difference, i, html = '',
			options = this.core.settings,
			$items = this.core.dom.$oItems,
			index = this.core.normalize(this.core.current(), true);

		if (options.nav && !options.loop && !options.navRewind) {
			this.controls.$previous.toggleClass('disabled', index <= 0);
			this.controls.$next.toggleClass('disabled', index >= this.core.maximum());
		}

		this.controls.$previous.toggle(options.nav);
		this.controls.$next.toggle(options.nav);

		if (options.dots) {
			difference = this.pages.length - this.controls.$indicators.children().length;

			if (difference > 0) {
				for (i = 0; i < Math.abs(difference); i++) {
					html += options.dotData ? $items.eq(i).data('owl-item').dot : this.template;
				}
				this.controls.$indicators.append(html);
			} else if (difference < 0) {
				this.controls.$indicators.children().slice(difference).remove();
			}

			this.controls.$indicators.find('.active').removeClass('active');
			this.controls.$indicators.children().eq($.inArray(this.current(), this.pages)).addClass('active');
		}

		this.controls.$indicators.toggle(options.dots);
	}

	/**
	 * Extends event data.
	 * @protected
	 * @param {Event} event - The event object which gets thrown.
	 */
	Navigation.prototype.onTrigger = function(event) {
		var options = this.core.settings;

		event.page = {
			index: $.inArray(this.current(), this.pages),
			count: this.pages.length,
			size: options.center || options.autoWidth || options.dotData
				? 1 : options.dotsEach || options.items
		};
	}

	/**
	 * Gets the current page position of the carousel.
	 * @protected
	 * @returns {Number}
	 */
	Navigation.prototype.current = function() {
		var index = this.core.normalize(this.core.current(), true);
		return $.grep(this.pages, function(o) {
			return o.start <= index && o.end >= index;
		}).pop();
	}

	/**
	 * Gets the current succesor/predecessor position.
	 * @protected
	 * @returns {Number}
	 */
	Navigation.prototype.getPosition = function(successor) {
		var position, length,
			options = this.core.settings;

		if (options.slideBy == 'page') {
			position = $.inArray(this.current(), this.pages);
			length = this.pages.length;
			successor ? ++position : --position;
			position = this.pages[((position % length) + length) % length].start;
		} else {
			position = this.core.normalize(this.core.current(), true);
			length = this.core.num.oItems;
			successor ? position += options.slideBy : position -= options.slideBy;
		}
		return position;
	}

	/**
	 * Slides to the next item or page.
	 * @public
	 * @param {Number} [speed=false] - The time in milliseconds for the transition.
	 */
	Navigation.prototype.next = function(speed) {
		$.proxy(this.overrides.to, this.core)(this.getPosition(true), speed);
	}

	/**
	 * Slides to the previous item or page.
	 * @public
	 * @param {Number} [speed=false] - The time in milliseconds for the transition.
	 */
	Navigation.prototype.prev = function(speed) {
		$.proxy(this.overrides.to, this.core)(this.getPosition(false), speed);
	}

	/**
	 * Slides to the specified item or page.
	 * @public
	 * @param {Number} position - The position of the item or page.
	 * @param {Number} [speed] - The time in milliseconds for the transition.
	 * @param {Boolean} [standard=false] - Whether to use the standard behaviour or not.
	 */
	Navigation.prototype.to = function(position, speed, standard) {
		var length;

		if (!standard) {
			length = this.pages.length;
			$.proxy(this.overrides.to, this.core)(this.pages[((position % length) + length) % length].start, speed);
		} else {
			$.proxy(this.overrides.to, this.core)(position, speed);
		}
	}

	$.fn.owlCarousel.Constructor.Plugins.Navigation = Navigation;

})(window.Zepto || window.jQuery, window, document);

/**
 * Hash Plugin
 * @version 2.0.0
 * @author Artus Kolanowski
 * @license The MIT License (MIT)
 */
;(function($, window, document, undefined) {
	'use strict';

	/**
	 * Creates the hash plugin.
	 * @class The Hash Plugin
	 * @param {Owl} carousel - The Owl Carousel
	 */
	var Hash = function(carousel) {
		/**
		 * Reference to the core.
		 * @type {Owl}
		 */
		this.core = carousel;

		/**
		 * Hash table for the hashes.
		 * @type {Object}
		 */
		this.hashes = {};

		/**
		 * The carousel element.
		 * @type {jQuery}
		 */
		this.$element = this.core.dom.$el;

		/**
		 * All event handlers.
		 * @type {Object}
		 */
		this.handlers = {
			'initialized.owl.carousel': $.proxy(function() {
				if (window.location.hash.substring(1)) {
					$(window).trigger('hashchange.owl.navigation');
				}
			}, this),
			'changed.owl.carousel': $.proxy(function(e) {
				if (this.filling) {
					e.property.value.data('owl-item').hash
						= $(':first-child', e.property.value).find('[data-hash]').andSelf().data('hash');
					this.hashes[e.property.value.data('owl-item').hash] = e.property.value;
				}
			}, this),
			'change.owl.carousel': $.proxy(function(e) {
				if (e.property.name == 'position' && this.core.current() === undefined
					&& this.core.settings.startPosition == 'URLHash') {
					e.data = this.hashes[window.location.hash.substring(1)];
				}
				this.filling = e.property.name == 'item' && e.property.value && e.property.value.is(':empty');
			}, this),
		};

		// set default options
		this.core.options = $.extend({}, Hash.Defaults, this.core.options);

		// register the event handlers
		this.$element.on(this.handlers);

		// register event listener for hash navigation
		$(window).on('hashchange.owl.navigation', $.proxy(function() {
			var hash = window.location.hash.substring(1),
				items = this.core.dom.$oItems,
				position = this.hashes[hash] && items.index(this.hashes[hash]) || 0;

			if (!hash) {
				return false;
			}

			this.core.dom.oStage.scrollLeft = 0;
			this.core.to(position, false, true);
		}, this));
	}

	/**
	 * Default options.
	 * @public
	 */
	Hash.Defaults = {
		URLhashListener: false
	}

	/**
	 * Destroys the plugin.
	 * @public
	 */
	Hash.prototype.destroy = function() {
		var handler, property;

		$(window).off('hashchange.owl.navigation');

		for (handler in this.handlers) {
			this.owl.dom.$el.off(handler, this.handlers[handler]);
		}
		for (property in Object.getOwnPropertyNames(this)) {
			typeof this[property] != 'function' && (this[property] = null);
		}
	}

	$.fn.owlCarousel.Constructor.Plugins.Hash = Hash;

})(window.Zepto || window.jQuery, window, document);

}).call(global, module, undefined, undefined);

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],3:[function(require,module,exports){
require('owlcarousel');
//require('../../../bower_components/slick.js/slick/slick.min.js');
//write the carousel config here

$('.carouselbar--duo__carousel').owlCarousel({
  autoPlay : 3000, //Set AutoPlay to 3 seconds
  margin : 20,
  loop : true,
  nav : true,
  items : 2,
  navContainer : '.carouselbar--duo__nav',
  dotsContainer : '.carouselbar--duo__dots',
  navText : ['<span></span>','<span></span>'],
  responsive : {
    0 : {
      items : 1,
      nav : true,
      dots : false
    },
    768 : {
      items : 2,
      nav : true,
      dots : true
    }
  }
});

},{"owlcarousel":2}],4:[function(require,module,exports){
$('document').ready(function(){
  //$('.columnbox--quatre').equalHeights();
});

$(window).load(function() {
  equalheight('.columnbox--quatre > *, .newsletter > *');
});


$(window).resize(function(){
  equalheight('.columnbox--quatre > *, .newsletter > *');
});

},{}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvbWFpbi1kZW1vLXN1c3kuanMiLCJib3dlcl9jb21wb25lbnRzL293bC5jYXJvdXNlbC9kaXN0L293bC5jYXJvdXNlbC5qcyIsInNyYy9qcy9nZW5lcmFsL2Nhcm91c2VsLmpzIiwic3JjL2pzL2dlbmVyYWwvY3VzdG9tLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUM1cEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLy9UaGVzZSBzY3JpcHRzIHdpbGwgYmUgYnVuZGxlZFxyXG5cclxucmVxdWlyZSgnLi9nZW5lcmFsL2Nhcm91c2VsLmpzJyk7XHJcbnJlcXVpcmUoJy4vZ2VuZXJhbC9jdXN0b20uanMnKTtcclxuIiwiOyB2YXIgX19icm93c2VyaWZ5X3NoaW1fcmVxdWlyZV9fPXJlcXVpcmU7KGZ1bmN0aW9uIGJyb3dzZXJpZnlTaGltKG1vZHVsZSwgZGVmaW5lLCByZXF1aXJlKSB7XG4vKipcclxuICogT3dsIGNhcm91c2VsXHJcbiAqIEB2ZXJzaW9uIDIuMC4wXHJcbiAqIEBhdXRob3IgQmFydG9zeiBXb2pjaWVjaG93c2tpXHJcbiAqIEBsaWNlbnNlIFRoZSBNSVQgTGljZW5zZSAoTUlUKVxyXG4gKiBAdG9kbyBMYXp5IExvYWQgSWNvblxyXG4gKiBAdG9kbyBwcmV2ZW50IGFuaW1hdGlvbmVuZCBidWJsaW5nXHJcbiAqIEB0b2RvIGl0ZW1zU2NhbGVVcFxyXG4gKiBAdG9kbyBUZXN0IFplcHRvXHJcbiAqIEB0b2RvIHN0YWdlUGFkZGluZyBjYWxjdWxhdGUgd3JvbmcgYWN0aXZlIGNsYXNzZXNcclxuICovXHJcbjsoZnVuY3Rpb24oJCwgd2luZG93LCBkb2N1bWVudCwgdW5kZWZpbmVkKSB7XHJcblxyXG5cdHZhciBpdGVtLCBkb20sIHdpZHRoLCBudW0sIHBvcywgZHJhZywgc3BlZWQsIHN0YXRlLCBlO1xyXG5cclxuXHQvKipcclxuXHQgKiBUZW1wbGF0ZSBmb3IgdGhlIGRhdGEgb2YgZWFjaCBpdGVtIHJlc3BlY3RpdmVseSBpdHMgRE9NIGVsZW1lbnQuXHJcblx0ICogQHByaXZhdGVcclxuXHQgKi9cclxuXHRpdGVtID0ge1xyXG5cdFx0aW5kZXg6IGZhbHNlLFxyXG5cdFx0aW5kZXhBYnM6IGZhbHNlLFxyXG5cdFx0cG9zTGVmdDogZmFsc2UsXHJcblx0XHRjbG9uZTogZmFsc2UsXHJcblx0XHRhY3RpdmU6IGZhbHNlLFxyXG5cdFx0bG9hZGVkOiBmYWxzZSxcclxuXHRcdGxhenlMb2FkOiBmYWxzZSxcclxuXHRcdGN1cnJlbnQ6IGZhbHNlLFxyXG5cdFx0d2lkdGg6IGZhbHNlLFxyXG5cdFx0Y2VudGVyOiBmYWxzZSxcclxuXHRcdHBhZ2U6IGZhbHNlLFxyXG5cdFx0aGFzVmlkZW86IGZhbHNlLFxyXG5cdFx0cGxheVZpZGVvOiBmYWxzZVxyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIFRlbXBsYXRlIGZvciB0aGUgcmVmZXJlbmNlcyB0byBET00gZWxlbWVudHMsIHRob3NlIHdpdGggYCRgIHNpZ24gYXJlIGBqUXVlcnlgIG9iamVjdHMuXHJcblx0ICogQHByaXZhdGVcclxuXHQgKi9cclxuXHRkb20gPSB7XHJcblx0XHRlbDogbnVsbCwgLy8gbWFpbiBlbGVtZW50XHJcblx0XHQkZWw6IG51bGwsIC8vIGpRdWVyeSBtYWluIGVsZW1lbnRcclxuXHRcdHN0YWdlOiBudWxsLCAvLyBzdGFnZVxyXG5cdFx0JHN0YWdlOiBudWxsLCAvLyBqUXVlcnkgc3RhZ2VcclxuXHRcdG9TdGFnZTogbnVsbCwgLy8gb3V0ZXIgc3RhZ2VcclxuXHRcdCRvU3RhZ2U6IG51bGwsIC8vICQgb3V0ZXIgc3RhZ2VcclxuXHRcdCRpdGVtczogbnVsbCwgLy8gYWxsIGl0ZW1zLCBjbG9uZXMgYW5kIG9yaWdpbmFscyBpbmNsdWRlZFxyXG5cdFx0JG9JdGVtczogbnVsbCwgLy8gb3JpZ2luYWwgaXRlbXNcclxuXHRcdCRjSXRlbXM6IG51bGwsIC8vIGNsb25lZCBpdGVtcyBvbmx5XHJcblx0XHQkY29udGVudDogbnVsbFxyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIFRlbXBsYXRlIGZvciB0aGUgd2lkdGhzIG9mIHNvbWUgZWxlbWVudHMuXHJcblx0ICogQHByaXZhdGVcclxuXHQgKi9cclxuXHR3aWR0aCA9IHtcclxuXHRcdGVsOiAwLFxyXG5cdFx0c3RhZ2U6IDAsXHJcblx0XHRpdGVtOiAwLFxyXG5cdFx0cHJldldpbmRvdzogMCxcclxuXHRcdGNsb25lTGFzdDogMFxyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIFRlbXBsYXRlIGZvciBjb3VudGluZyB0byBzb21lIHByb3BlcnRpZXMuXHJcblx0ICogQHByaXZhdGVcclxuXHQgKi9cclxuXHRudW0gPSB7XHJcblx0XHRpdGVtczogMCxcclxuXHRcdG9JdGVtczogMCxcclxuXHRcdGNJdGVtczogMCxcclxuXHRcdGFjdGl2ZTogMCxcclxuXHRcdG1lcmdlZDogW11cclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBUZW1wbGF0ZSBmb3Igc3RhdHVzIGluZm9ybWF0aW9uIGFib3V0IGRyYWcgYW5kIHRvdWNoIGV2ZW50cy5cclxuXHQgKiBAcHJpdmF0ZVxyXG5cdCAqL1xyXG5cdGRyYWcgPSB7XHJcblx0XHRzdGFydDogMCxcclxuXHRcdHN0YXJ0WDogMCxcclxuXHRcdHN0YXJ0WTogMCxcclxuXHRcdGN1cnJlbnQ6IDAsXHJcblx0XHRjdXJyZW50WDogMCxcclxuXHRcdGN1cnJlbnRZOiAwLFxyXG5cdFx0b2Zmc2V0WDogMCxcclxuXHRcdG9mZnNldFk6IDAsXHJcblx0XHRkaXN0YW5jZTogbnVsbCxcclxuXHRcdHN0YXJ0VGltZTogMCxcclxuXHRcdGVuZFRpbWU6IDAsXHJcblx0XHR1cGRhdGVkWDogMCxcclxuXHRcdHRhcmdldEVsOiBudWxsXHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogVGVtcGxhdGUgZm9yIHNvbWUgc3RhdHVzIGluZm9ybWF0aW9ucy5cclxuXHQgKiBAcHJpdmF0ZVxyXG5cdCAqL1xyXG5cdHN0YXRlID0ge1xyXG5cdFx0aXNUb3VjaDogZmFsc2UsXHJcblx0XHRpc1Njcm9sbGluZzogZmFsc2UsXHJcblx0XHRpc1N3aXBpbmc6IGZhbHNlLFxyXG5cdFx0ZGlyZWN0aW9uOiBmYWxzZSxcclxuXHRcdGluTW90aW9uOiBmYWxzZVxyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIEV2ZW50IGZ1bmN0aW9ucyByZWZlcmVuY2VzLlxyXG5cdCAqIEBwcml2YXRlXHJcblx0ICovXHJcblx0ZSA9IHtcclxuXHRcdF9vbkRyYWdTdGFydDogbnVsbCxcclxuXHRcdF9vbkRyYWdNb3ZlOiBudWxsLFxyXG5cdFx0X29uRHJhZ0VuZDogbnVsbCxcclxuXHRcdF90cmFuc2l0aW9uRW5kOiBudWxsLFxyXG5cdFx0X3Jlc2l6ZXI6IG51bGwsXHJcblx0XHRfcmVzcG9uc2l2ZUNhbGw6IG51bGwsXHJcblx0XHRfZ29Ub0xvb3A6IG51bGwsXHJcblx0XHRfY2hlY2tWaXNpYmlsZTogbnVsbFxyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIENyZWF0ZXMgYSBjYXJvdXNlbC5cclxuXHQgKiBAY2xhc3MgVGhlIE93bCBDYXJvdXNlbC5cclxuXHQgKiBAcHVibGljXHJcblx0ICogQHBhcmFtIHtIVE1MRWxlbWVudHxqUXVlcnl9IGVsZW1lbnQgLSBUaGUgZWxlbWVudCB0byBjcmVhdGUgdGhlIGNhcm91c2VsIGZvci5cclxuXHQgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnNdIC0gVGhlIG9wdGlvbnNcclxuXHQgKi9cclxuXHRmdW5jdGlvbiBPd2woZWxlbWVudCwgb3B0aW9ucykge1xyXG5cclxuXHRcdC8vIGFkZCBiYXNpYyBPd2wgaW5mb3JtYXRpb24gdG8gZG9tIGVsZW1lbnRcclxuXHRcdGVsZW1lbnQub3dsQ2Fyb3VzZWwgPSB7XHJcblx0XHRcdCduYW1lJzogJ093bCBDYXJvdXNlbCcsXHJcblx0XHRcdCdhdXRob3InOiAnQmFydG9zeiBXb2pjaWVjaG93c2tpJyxcclxuXHRcdFx0J3ZlcnNpb24nOiAnMi4wLjAtYmV0YS4yLjEnXHJcblx0XHR9O1xyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogQ3VycmVudCBzZXR0aW5ncyBmb3IgdGhlIGNhcm91c2VsLlxyXG5cdFx0ICogQHByb3RlY3RlZFxyXG5cdFx0ICovXHJcblx0XHR0aGlzLnNldHRpbmdzID0gbnVsbDtcclxuXHJcblx0XHQvKipcclxuXHRcdCAqXHJcblx0XHQgKiBAcHJvdGVjdGVkXHJcblx0XHQgKiBAdG9kbyBNdXN0IGJlIGRvc3VtZW50ZWQuXHJcblx0XHQgKi9cclxuXHRcdHRoaXMub3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCBPd2wuRGVmYXVsdHMsIG9wdGlvbnMpO1xyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogVGVtcGxhdGUgZm9yIHRoZSBkYXRhIG9mIGVhY2ggaXRlbS5cclxuXHRcdCAqIEBwcm90ZWN0ZWRcclxuXHRcdCAqL1xyXG5cdFx0dGhpcy5pdGVtRGF0YSA9ICQuZXh0ZW5kKHt9LCBpdGVtKTtcclxuXHJcblx0XHQvKipcclxuXHRcdCAqIENvbnRhaW5zIHJlZmVyZW5jZXMgdG8gRE9NIGVsZW1lbnRzLCB0aG9zZSB3aXRoIGAkYCBzaWduIGFyZSBgalF1ZXJ5YCBvYmplY3RzLlxyXG5cdFx0ICogQHByb3RlY3RlZFxyXG5cdFx0ICovXHJcblx0XHR0aGlzLmRvbSA9ICQuZXh0ZW5kKHt9LCBkb20pO1xyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogQ2FjaGVzIHRoZSB3aWR0aHMgb2Ygc29tZSBlbGVtZW50cy5cclxuXHRcdCAqIEBwcm90ZWN0ZWRcclxuXHRcdCAqL1xyXG5cdFx0dGhpcy53aWR0aCA9ICQuZXh0ZW5kKHt9LCB3aWR0aCk7XHJcblxyXG5cdFx0LyoqXHJcblx0XHQgKiBDYWNoZXMgc29tZSBjb3VudCBpbmZvcm1hdGlvbnMuXHJcblx0XHQgKiBAcHJvdGVjdGVkXHJcblx0XHQgKi9cclxuXHRcdHRoaXMubnVtID0gJC5leHRlbmQoe30sIG51bSk7XHJcblxyXG5cdFx0LyoqXHJcblx0XHQgKiBDYWNoZXMgaW5mb3JtYXRpb25zIGFib3V0IGRyYWcgYW5kIHRvdWNoIGV2ZW50cy5cclxuXHRcdCAqL1xyXG5cdFx0dGhpcy5kcmFnID0gJC5leHRlbmQoe30sIGRyYWcpO1xyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogQ2FjaGVzIHNvbWUgc3RhdHVzIGluZm9ybWF0aW9ucy5cclxuXHRcdCAqIEBwcm90ZWN0ZWRcclxuXHRcdCAqL1xyXG5cdFx0dGhpcy5zdGF0ZSA9ICQuZXh0ZW5kKHt9LCBzdGF0ZSk7XHJcblxyXG5cdFx0LyoqXHJcblx0XHQgKiBAcHJvdGVjdGVkXHJcblx0XHQgKiBAdG9kbyBNdXN0IGJlIGRvY3VtZW50ZWRcclxuXHRcdCAqL1xyXG5cdFx0dGhpcy5lID0gJC5leHRlbmQoe30sIGUpO1xyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogUmVmZXJlbmNlcyB0byB0aGUgcnVubmluZyBwbHVnaW5zIG9mIHRoaXMgY2Fyb3VzZWwuXHJcblx0XHQgKiBAcHJvdGVjdGVkXHJcblx0XHQgKi9cclxuXHRcdHRoaXMucGx1Z2lucyA9IHt9O1xyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogQ3VycmVudGx5IHN1cHByZXNzZWQgZXZlbnRzIHRvIHByZXZlbnQgdGhlbSBmcm9tIGJlZWluZyByZXRyaWdnZXJlZC5cclxuXHRcdCAqIEBwcm90ZWN0ZWRcclxuXHRcdCAqL1xyXG5cdFx0dGhpcy5fc3VwcmVzcyA9IHt9O1xyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogVGhlIGFic29sdXRlIGN1cnJlbnQgcG9zaXRpb24uXHJcblx0XHQgKiBAcHJvdGVjdGVkXHJcblx0XHQgKi9cclxuXHRcdHRoaXMuX2N1cnJlbnQgPSBudWxsO1xyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogVGhlIGFuaW1hdGlvbiBzcGVlZCBpbiBtaWxsaXNlY29uZHMuXHJcblx0XHQgKiBAcHJvdGVjdGVkXHJcblx0XHQgKi9cclxuXHRcdHRoaXMuX3NwZWVkID0gbnVsbDtcclxuXHJcblx0XHQvKipcclxuXHRcdCAqIFRoZSBjb29yZGluYXRlcyBvZiBhbGwgaXRlbXMgaW4gcGl4ZWwuXHJcblx0XHQgKi9cclxuXHRcdHRoaXMuX2Nvb3JkaW5hdGVzID0gbnVsbDtcclxuXHJcblx0XHR0aGlzLmRvbS5lbCA9IGVsZW1lbnQ7XHJcblx0XHR0aGlzLmRvbS4kZWwgPSAkKGVsZW1lbnQpO1xyXG5cclxuXHRcdGZvciAodmFyIHBsdWdpbiBpbiBPd2wuUGx1Z2lucykge1xyXG5cdFx0XHR0aGlzLnBsdWdpbnNbcGx1Z2luWzBdLnRvTG93ZXJDYXNlKCkgKyBwbHVnaW4uc2xpY2UoMSldXHJcblx0XHRcdFx0PSBuZXcgT3dsLlBsdWdpbnNbcGx1Z2luXSh0aGlzKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmluaXQoKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIERlZmF1bHQgb3B0aW9ucyBmb3IgdGhlIGNhcm91c2VsLlxyXG5cdCAqIEBwdWJsaWNcclxuXHQgKi9cclxuXHRPd2wuRGVmYXVsdHMgPSB7XHJcblx0XHRpdGVtczogMyxcclxuXHRcdGxvb3A6IGZhbHNlLFxyXG5cdFx0Y2VudGVyOiBmYWxzZSxcclxuXHJcblx0XHRtb3VzZURyYWc6IHRydWUsXHJcblx0XHR0b3VjaERyYWc6IHRydWUsXHJcblx0XHRwdWxsRHJhZzogdHJ1ZSxcclxuXHRcdGZyZWVEcmFnOiBmYWxzZSxcclxuXHJcblx0XHRtYXJnaW46IDAsXHJcblx0XHRzdGFnZVBhZGRpbmc6IDAsXHJcblxyXG5cdFx0bWVyZ2U6IGZhbHNlLFxyXG5cdFx0bWVyZ2VGaXQ6IHRydWUsXHJcblx0XHRhdXRvV2lkdGg6IGZhbHNlLFxyXG5cclxuXHRcdHN0YXJ0UG9zaXRpb246IDAsXHJcblxyXG5cdFx0c21hcnRTcGVlZDogMjUwLFxyXG5cdFx0Zmx1aWRTcGVlZDogZmFsc2UsXHJcblx0XHRkcmFnRW5kU3BlZWQ6IGZhbHNlLFxyXG5cclxuXHRcdHJlc3BvbnNpdmU6IHt9LFxyXG5cdFx0cmVzcG9uc2l2ZVJlZnJlc2hSYXRlOiAyMDAsXHJcblx0XHRyZXNwb25zaXZlQmFzZUVsZW1lbnQ6IHdpbmRvdyxcclxuXHRcdHJlc3BvbnNpdmVDbGFzczogZmFsc2UsXHJcblxyXG5cdFx0ZmFsbGJhY2tFYXNpbmc6ICdzd2luZycsXHJcblxyXG5cdFx0aW5mbzogZmFsc2UsXHJcblxyXG5cdFx0bmVzdGVkSXRlbVNlbGVjdG9yOiBmYWxzZSxcclxuXHRcdGl0ZW1FbGVtZW50OiAnZGl2JyxcclxuXHRcdHN0YWdlRWxlbWVudDogJ2RpdicsXHJcblxyXG5cdFx0Ly8gQ2xhc3NlcyBhbmQgTmFtZXNcclxuXHRcdHRoZW1lQ2xhc3M6ICdvd2wtdGhlbWUnLFxyXG5cdFx0YmFzZUNsYXNzOiAnb3dsLWNhcm91c2VsJyxcclxuXHRcdGl0ZW1DbGFzczogJ293bC1pdGVtJyxcclxuXHRcdGNlbnRlckNsYXNzOiAnY2VudGVyJyxcclxuXHRcdGFjdGl2ZUNsYXNzOiAnYWN0aXZlJ1xyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIENvbnRhaW5zIGFsbCByZWdpc3RlcmVkIHBsdWdpbnMuXHJcblx0ICogQHB1YmxpY1xyXG5cdCAqL1xyXG5cdE93bC5QbHVnaW5zID0ge307XHJcblxyXG5cdC8qKlxyXG5cdCAqIEluaXRpYWxpemVzIHRoZSBjYXJvdXNlbC5cclxuXHQgKiBAcHJvdGVjdGVkXHJcblx0ICovXHJcblx0T3dsLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24oKSB7XHJcblxyXG5cdFx0Ly8gVXBkYXRlIG9wdGlvbnMuaXRlbXMgb24gZ2l2ZW4gc2l6ZVxyXG5cdFx0dGhpcy5zZXRSZXNwb25zaXZlT3B0aW9ucygpO1xyXG5cclxuXHRcdHRoaXMudHJpZ2dlcignaW5pdGlhbGl6ZScpO1xyXG5cclxuXHRcdC8vIEFkZCBiYXNlIGNsYXNzXHJcblx0XHRpZiAoIXRoaXMuZG9tLiRlbC5oYXNDbGFzcyh0aGlzLnNldHRpbmdzLmJhc2VDbGFzcykpIHtcclxuXHRcdFx0dGhpcy5kb20uJGVsLmFkZENsYXNzKHRoaXMuc2V0dGluZ3MuYmFzZUNsYXNzKTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBBZGQgdGhlbWUgY2xhc3NcclxuXHRcdGlmICghdGhpcy5kb20uJGVsLmhhc0NsYXNzKHRoaXMuc2V0dGluZ3MudGhlbWVDbGFzcykpIHtcclxuXHRcdFx0dGhpcy5kb20uJGVsLmFkZENsYXNzKHRoaXMuc2V0dGluZ3MudGhlbWVDbGFzcyk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gQWRkIHRoZW1lIGNsYXNzXHJcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5ydGwpIHtcclxuXHRcdFx0dGhpcy5kb20uJGVsLmFkZENsYXNzKCdvd2wtcnRsJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gQ2hlY2sgc3VwcG9ydFxyXG5cdFx0dGhpcy5icm93c2VyU3VwcG9ydCgpO1xyXG5cclxuXHRcdGlmICh0aGlzLnNldHRpbmdzLmF1dG9XaWR0aCAmJiB0aGlzLnN0YXRlLmltYWdlc0xvYWRlZCAhPT0gdHJ1ZSkge1xyXG5cdFx0XHR2YXIgaW1ncywgbmVzdGVkU2VsZWN0b3IsIHdpZHRoO1xyXG5cdFx0XHRpbWdzID0gdGhpcy5kb20uJGVsLmZpbmQoJ2ltZycpO1xyXG5cdFx0XHRuZXN0ZWRTZWxlY3RvciA9IHRoaXMuc2V0dGluZ3MubmVzdGVkSXRlbVNlbGVjdG9yID8gJy4nICsgdGhpcy5zZXR0aW5ncy5uZXN0ZWRJdGVtU2VsZWN0b3IgOiB1bmRlZmluZWQ7XHJcblx0XHRcdHdpZHRoID0gdGhpcy5kb20uJGVsLmNoaWxkcmVuKG5lc3RlZFNlbGVjdG9yKS53aWR0aCgpO1xyXG5cclxuXHRcdFx0aWYgKGltZ3MubGVuZ3RoICYmIHdpZHRoIDw9IDApIHtcclxuXHRcdFx0XHR0aGlzLnByZWxvYWRBdXRvV2lkdGhJbWFnZXMoaW1ncyk7XHJcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gR2V0IGFuZCBzdG9yZSB3aW5kb3cgd2lkdGhcclxuXHRcdC8vIGlPUyBzYWZhcmkgbGlrZXMgdG8gdHJpZ2dlciB1bm5lY2Vzc2FyeSByZXNpemUgZXZlbnRcclxuXHRcdHRoaXMud2lkdGgucHJldldpbmRvdyA9IHRoaXMudmlld3BvcnQoKTtcclxuXHJcblx0XHQvLyBjcmVhdGUgc3RhZ2Ugb2JqZWN0XHJcblx0XHR0aGlzLmNyZWF0ZVN0YWdlKCk7XHJcblxyXG5cdFx0Ly8gQXBwZW5kIGxvY2FsIGNvbnRlbnRcclxuXHRcdHRoaXMuZmV0Y2hDb250ZW50KCk7XHJcblxyXG5cdFx0Ly8gYXR0YWNoIGdlbmVyaWMgZXZlbnRzXHJcblx0XHR0aGlzLmV2ZW50c0NhbGwoKTtcclxuXHJcblx0XHQvLyBhdHRhY2ggZ2VuZXJpYyBldmVudHNcclxuXHRcdHRoaXMuaW50ZXJuYWxFdmVudHMoKTtcclxuXHJcblx0XHR0aGlzLmRvbS4kZWwuYWRkQ2xhc3MoJ293bC1sb2FkaW5nJyk7XHJcblx0XHR0aGlzLnJlZnJlc2godHJ1ZSk7XHJcblx0XHR0aGlzLmRvbS4kZWwucmVtb3ZlQ2xhc3MoJ293bC1sb2FkaW5nJykuYWRkQ2xhc3MoJ293bC1sb2FkZWQnKTtcclxuXHJcblx0XHR0aGlzLnRyaWdnZXIoJ2luaXRpYWxpemVkJyk7XHJcblxyXG5cdFx0Ly8gYXR0YWNoIGN1c3RvbSBjb250cm9sIGV2ZW50c1xyXG5cdFx0dGhpcy5hZGRUcmlnZ2VyYWJsZUV2ZW50cygpO1xyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIFNldHMgcmVzcG9uc2l2ZSBvcHRpb25zLlxyXG5cdCAqIEBwcm90ZWN0ZWRcclxuXHQgKi9cclxuXHRPd2wucHJvdG90eXBlLnNldFJlc3BvbnNpdmVPcHRpb25zID0gZnVuY3Rpb24oKSB7XHJcblx0XHRpZiAoIXRoaXMub3B0aW9ucy5yZXNwb25zaXZlKSB7XHJcblx0XHRcdHRoaXMuc2V0dGluZ3MgPSAkLmV4dGVuZCh7fSwgdGhpcy5vcHRpb25zKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHZhciB2aWV3cG9ydCA9IHRoaXMudmlld3BvcnQoKSxcclxuXHRcdFx0XHRvdmVyd3JpdGVzID0gdGhpcy5vcHRpb25zLnJlc3BvbnNpdmUsXHJcblx0XHRcdFx0bWF0Y2ggPSAtMTtcclxuXHJcblx0XHRcdCQuZWFjaChvdmVyd3JpdGVzLCBmdW5jdGlvbihicmVha3BvaW50KSB7XHJcblx0XHRcdFx0aWYgKGJyZWFrcG9pbnQgPD0gdmlld3BvcnQgJiYgYnJlYWtwb2ludCA+IG1hdGNoKSB7XHJcblx0XHRcdFx0XHRtYXRjaCA9IE51bWJlcihicmVha3BvaW50KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0dGhpcy5zZXR0aW5ncyA9ICQuZXh0ZW5kKHt9LCB0aGlzLm9wdGlvbnMsIG92ZXJ3cml0ZXNbbWF0Y2hdKTtcclxuXHRcdFx0ZGVsZXRlIHRoaXMuc2V0dGluZ3MucmVzcG9uc2l2ZTtcclxuXHJcblx0XHRcdC8vIFJlc3BvbnNpdmUgQ2xhc3NcclxuXHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MucmVzcG9uc2l2ZUNsYXNzKSB7XHJcblx0XHRcdFx0dGhpcy5kb20uJGVsLmF0dHIoJ2NsYXNzJywgZnVuY3Rpb24oaSwgYykge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGMucmVwbGFjZSgvXFxiIG93bC1yZXNwb25zaXZlLVxcUysvZywgJycpO1xyXG5cdFx0XHRcdH0pLmFkZENsYXNzKCdvd2wtcmVzcG9uc2l2ZS0nICsgbWF0Y2gpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogVXBkYXRlcyBvcHRpb24gbG9naWMgaWYgbmVjZXNzZXJ5LlxyXG5cdCAqIEBwcm90ZWN0ZWRcclxuXHQgKi9cclxuXHRPd2wucHJvdG90eXBlLm9wdGlvbnNMb2dpYyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0Ly8gVG9nZ2xlIENlbnRlciBjbGFzc1xyXG5cdFx0dGhpcy5kb20uJGVsLnRvZ2dsZUNsYXNzKCdvd2wtY2VudGVyJywgdGhpcy5zZXR0aW5ncy5jZW50ZXIpO1xyXG5cclxuXHRcdC8vIGlmIGl0ZW1zIG51bWJlciBpcyBsZXNzIHRoYW4gaW4gYm9keVxyXG5cdFx0aWYgKHRoaXMuc2V0dGluZ3MubG9vcCAmJiB0aGlzLm51bS5vSXRlbXMgPCB0aGlzLnNldHRpbmdzLml0ZW1zKSB7XHJcblx0XHRcdHRoaXMuc2V0dGluZ3MubG9vcCA9IGZhbHNlO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLnNldHRpbmdzLmF1dG9XaWR0aCkge1xyXG5cdFx0XHR0aGlzLnNldHRpbmdzLnN0YWdlUGFkZGluZyA9IGZhbHNlO1xyXG5cdFx0XHR0aGlzLnNldHRpbmdzLm1lcmdlID0gZmFsc2U7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogQ3JlYXRlcyBzdGFnZSBhbmQgb3V0ZXItc3RhZ2UgZWxlbWVudHMuXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqL1xyXG5cdE93bC5wcm90b3R5cGUuY3JlYXRlU3RhZ2UgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBvU3RhZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSxcclxuXHRcdFx0c3RhZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRoaXMuc2V0dGluZ3Muc3RhZ2VFbGVtZW50KTtcclxuXHJcblx0XHRvU3RhZ2UuY2xhc3NOYW1lID0gJ293bC1zdGFnZS1vdXRlcic7XHJcblx0XHRzdGFnZS5jbGFzc05hbWUgPSAnb3dsLXN0YWdlJztcclxuXHJcblx0XHRvU3RhZ2UuYXBwZW5kQ2hpbGQoc3RhZ2UpO1xyXG5cdFx0dGhpcy5kb20uZWwuYXBwZW5kQ2hpbGQob1N0YWdlKTtcclxuXHJcblx0XHR0aGlzLmRvbS5vU3RhZ2UgPSBvU3RhZ2U7XHJcblx0XHR0aGlzLmRvbS4kb1N0YWdlID0gJChvU3RhZ2UpO1xyXG5cdFx0dGhpcy5kb20uc3RhZ2UgPSBzdGFnZTtcclxuXHRcdHRoaXMuZG9tLiRzdGFnZSA9ICQoc3RhZ2UpO1xyXG5cclxuXHRcdG9TdGFnZSA9IG51bGw7XHJcblx0XHRzdGFnZSA9IG51bGw7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogQ3JlYXRlcyBhbiBpdGVtIGNvbnRhaW5lci5cclxuXHQgKiBAcHJvdGVjdGVkXHJcblx0ICogQHJldHVybnMge2pRdWVyeX0gLSBUaGUgaXRlbSBjb250YWluZXIuXHJcblx0ICovXHJcblx0T3dsLnByb3RvdHlwZS5jcmVhdGVJdGVtQ29udGFpbmVyID0gZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgaXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGhpcy5zZXR0aW5ncy5pdGVtRWxlbWVudCk7XHJcblx0XHRpdGVtLmNsYXNzTmFtZSA9IHRoaXMuc2V0dGluZ3MuaXRlbUNsYXNzO1xyXG5cdFx0cmV0dXJuICQoaXRlbSk7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogRmV0Y2hlcyB0aGUgY29udGVudC5cclxuXHQgKiBAcHJvdGVjdGVkXHJcblx0ICovXHJcblx0T3dsLnByb3RvdHlwZS5mZXRjaENvbnRlbnQgPSBmdW5jdGlvbihleHRDb250ZW50KSB7XHJcblx0XHRpZiAoZXh0Q29udGVudCkge1xyXG5cdFx0XHR0aGlzLmRvbS4kY29udGVudCA9IChleHRDb250ZW50IGluc3RhbmNlb2YgalF1ZXJ5KSA/IGV4dENvbnRlbnQgOiAkKGV4dENvbnRlbnQpO1xyXG5cdFx0fSBlbHNlIGlmICh0aGlzLnNldHRpbmdzLm5lc3RlZEl0ZW1TZWxlY3Rvcikge1xyXG5cdFx0XHR0aGlzLmRvbS4kY29udGVudCA9IHRoaXMuZG9tLiRlbC5maW5kKCcuJyArIHRoaXMuc2V0dGluZ3MubmVzdGVkSXRlbVNlbGVjdG9yKS5ub3QoJy5vd2wtc3RhZ2Utb3V0ZXInKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRoaXMuZG9tLiRjb250ZW50ID0gdGhpcy5kb20uJGVsLmNoaWxkcmVuKCkubm90KCcub3dsLXN0YWdlLW91dGVyJyk7XHJcblx0XHR9XHJcblx0XHQvLyBjb250ZW50IGxlbmd0aFxyXG5cdFx0dGhpcy5udW0ub0l0ZW1zID0gdGhpcy5kb20uJGNvbnRlbnQubGVuZ3RoO1xyXG5cclxuXHRcdC8vIGluaXQgU3RydWN0dXJlXHJcblx0XHRpZiAodGhpcy5udW0ub0l0ZW1zICE9PSAwKSB7XHJcblx0XHRcdHRoaXMuaW5pdFN0cnVjdHVyZSgpO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIEluaXRpYWxpemVzIHRoZSBjb250ZW50IHN0cnV0dXJlLlxyXG5cdCAqIEBwcm90ZWN0ZWRcclxuXHQgKi9cclxuXHRPd2wucHJvdG90eXBlLmluaXRTdHJ1Y3R1cmUgPSBmdW5jdGlvbigpIHtcclxuXHRcdHRoaXMuY3JlYXRlTm9ybWFsU3RydWN0dXJlKCk7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogQ3JlYXRlcyBzbWFsbC9taWQgd2VpZ2h0IGNvbnRlbnQgc3RydWN0dXJlLlxyXG5cdCAqIEBwcm90ZWN0ZWRcclxuXHQgKiBAdG9kbyBUaGlzIHJlc3VsdHMgaW4gYSBwb29yIHBlcmZvcm1hbmNlLFxyXG5cdCAqIGJ1dCB0aGlzIGlzIGR1ZSB0byB0aGUgYXBwcm9hY2ggb2YgY29tcGxldGVseVxyXG5cdCAqIHJlYnVpbGQgdGhlIGV4aXN0aW5nIERPTSB0cmVlIGZyb20gc2NyYXRjaCxcclxuXHQgKiByYXRoZXIgdG8gdXNlIHRoZW0uIFRoZSBlZmZvcnQgdG8gaW1wbGVtZW50XHJcblx0ICogdGhpcyB3aXRoIGEgZ29vZCBwZXJmb3JtYW5jZSwgd2hpbGUgbWFpbnRhaW5pbmdcclxuXHQgKiB0aGUgb3JpZ2luYWwgYXBwcm9hY2ggaXMgZGlzcHJvcG9ydGlvbmF0ZS5cclxuXHQgKi9cclxuXHRPd2wucHJvdG90eXBlLmNyZWF0ZU5vcm1hbFN0cnVjdHVyZSA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIGksICRpdGVtO1xyXG5cdFx0Zm9yIChpID0gMDsgaSA8IHRoaXMubnVtLm9JdGVtczsgaSsrKSB7XHJcblx0XHRcdCRpdGVtID0gdGhpcy5jcmVhdGVJdGVtQ29udGFpbmVyKCk7XHJcblx0XHRcdHRoaXMuaW5pdGlhbGl6ZUl0ZW1Db250YWluZXIoJGl0ZW0sIHRoaXMuZG9tLiRjb250ZW50W2ldKTtcclxuXHRcdFx0dGhpcy5kb20uJHN0YWdlLmFwcGVuZCgkaXRlbSk7XHJcblx0XHR9XHJcblx0XHR0aGlzLmRvbS4kY29udGVudCA9IG51bGw7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogQ3JlYXRlcyBjdXN0b20gY29udGVudCBzdHJ1Y3R1cmUuXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqL1xyXG5cdE93bC5wcm90b3R5cGUuY3JlYXRlQ3VzdG9tU3RydWN0dXJlID0gZnVuY3Rpb24oaG93TWFueUl0ZW1zKSB7XHJcblx0XHR2YXIgaSwgJGl0ZW07XHJcblx0XHRmb3IgKGkgPSAwOyBpIDwgaG93TWFueUl0ZW1zOyBpKyspIHtcclxuXHRcdFx0JGl0ZW0gPSB0aGlzLmNyZWF0ZUl0ZW1Db250YWluZXIoKTtcclxuXHRcdFx0dGhpcy5jcmVhdGVJdGVtQ29udGFpbmVyRGF0YSgkaXRlbSk7XHJcblx0XHRcdHRoaXMuZG9tLiRzdGFnZS5hcHBlbmQoJGl0ZW0pO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIEluaXRpYWxpemVzIGl0ZW0gY29udGFpbmVyIHdpdGggcHJvdmlkZWQgY29udGVudC5cclxuXHQgKiBAcHJvdGVjdGVkXHJcblx0ICogQHBhcmFtIHtqUXVlcnl9IGl0ZW0gLSBUaGUgaXRlbSB0aGF0IGhhcyB0byBiZSBmaWxsZWQuXHJcblx0ICogQHBhcmFtIHtIVE1MRWxlbWVudHxqUXVlcnl8c3RyaW5nfSBjb250ZW50IC0gVGhlIGNvbnRlbnQgdGhhdCBmaWxscyB0aGUgaXRlbS5cclxuXHQgKi9cclxuXHRPd2wucHJvdG90eXBlLmluaXRpYWxpemVJdGVtQ29udGFpbmVyID0gZnVuY3Rpb24oaXRlbSwgY29udGVudCkge1xyXG5cdFx0dGhpcy50cmlnZ2VyKCdjaGFuZ2UnLCB7IHByb3BlcnR5OiB7IG5hbWU6ICdpdGVtJywgdmFsdWU6IGl0ZW0gfSB9KTtcclxuXHJcblx0XHR0aGlzLmNyZWF0ZUl0ZW1Db250YWluZXJEYXRhKGl0ZW0pO1xyXG5cdFx0aXRlbS5hcHBlbmQoY29udGVudCk7XHJcblxyXG5cdFx0dGhpcy50cmlnZ2VyKCdjaGFuZ2VkJywgeyBwcm9wZXJ0eTogeyBuYW1lOiAnaXRlbScsIHZhbHVlOiBpdGVtIH0gfSk7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogQ3JlYXRlcyBpdGVtIGNvbnRhaW5lciBkYXRhLlxyXG5cdCAqIEBwcm90ZWN0ZWRcclxuXHQgKiBAcGFyYW0ge2pRdWVyeX0gaXRlbSAtIFRoZSBpdGVtIGZvciB3aGljaCB0aGUgZGF0YSBhcmUgdG8gYmUgc2V0LlxyXG5cdCAqIEBwYXJhbSB7alF1ZXJ5fSBbc291cmNlXSAtIFRoZSBpdGVtIHdob3NlIGRhdGEgYXJlIHRvIGJlIGNvcGllZC5cclxuXHQgKi9cclxuXHRPd2wucHJvdG90eXBlLmNyZWF0ZUl0ZW1Db250YWluZXJEYXRhID0gZnVuY3Rpb24oaXRlbSwgc291cmNlKSB7XHJcblx0XHR2YXIgZGF0YSA9ICQuZXh0ZW5kKHt9LCB0aGlzLml0ZW1EYXRhKTtcclxuXHJcblx0XHRpZiAoc291cmNlKSB7XHJcblx0XHRcdCQuZXh0ZW5kKGRhdGEsIHNvdXJjZS5kYXRhKCdvd2wtaXRlbScpKTtcclxuXHRcdH1cclxuXHJcblx0XHRpdGVtLmRhdGEoJ293bC1pdGVtJywgZGF0YSk7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogQ2xvbmVzIGFuIGl0ZW0gY29udGFpbmVyLlxyXG5cdCAqIEBwcm90ZWN0ZWRcclxuXHQgKiBAcGFyYW0ge2pRdWVyeX0gaXRlbSAtIFRoZSBpdGVtIHRvIGNsb25lLlxyXG5cdCAqIEByZXR1cm5zIHtqUXVlcnl9IC0gVGhlIGNsb25lZCBpdGVtLlxyXG5cdCAqL1xyXG5cdE93bC5wcm90b3R5cGUuY2xvbmVJdGVtQ29udGFpbmVyID0gZnVuY3Rpb24oaXRlbSkge1xyXG5cdFx0dmFyICRjbG9uZSA9IGl0ZW0uY2xvbmUodHJ1ZSwgdHJ1ZSkuYWRkQ2xhc3MoJ2Nsb25lZCcpO1xyXG5cdFx0Ly8gc29tZWhvdyBkYXRhIHJlZmVyZW5jZXMgdGhlIHNhbWUgb2JqZWN0XHJcblx0XHR0aGlzLmNyZWF0ZUl0ZW1Db250YWluZXJEYXRhKCRjbG9uZSwgJGNsb25lKTtcclxuXHRcdCRjbG9uZS5kYXRhKCdvd2wtaXRlbScpLmNsb25lID0gdHJ1ZTtcclxuXHRcdHJldHVybiAkY2xvbmU7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogVXBkYXRlcyBvcmlnaW5hbCBpdGVtcyBpbmRleCBkYXRhLlxyXG5cdCAqIEBwcm90ZWN0ZWRcclxuXHQgKi9cclxuXHRPd2wucHJvdG90eXBlLnVwZGF0ZUxvY2FsQ29udGVudCA9IGZ1bmN0aW9uKCkge1xyXG5cclxuXHRcdHZhciBrLCBpdGVtO1xyXG5cclxuXHRcdHRoaXMuZG9tLiRvSXRlbXMgPSB0aGlzLmRvbS4kc3RhZ2UuZmluZCgnLicgKyB0aGlzLnNldHRpbmdzLml0ZW1DbGFzcykuZmlsdGVyKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRyZXR1cm4gJCh0aGlzKS5kYXRhKCdvd2wtaXRlbScpLmNsb25lID09PSBmYWxzZTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdHRoaXMubnVtLm9JdGVtcyA9IHRoaXMuZG9tLiRvSXRlbXMubGVuZ3RoO1xyXG5cdFx0Ly8gdXBkYXRlIGluZGV4IG9uIG9yaWdpbmFsIGl0ZW1zXHJcblxyXG5cdFx0Zm9yIChrID0gMDsgayA8IHRoaXMubnVtLm9JdGVtczsgaysrKSB7XHJcblx0XHRcdGl0ZW0gPSB0aGlzLmRvbS4kb0l0ZW1zLmVxKGspO1xyXG5cdFx0XHRpdGVtLmRhdGEoJ293bC1pdGVtJykuaW5kZXggPSBrO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIENyZWF0ZXMgY2xvbmVzIGZvciBpbmZpbml0eSBsb29wLlxyXG5cdCAqIEBwcm90ZWN0ZWRcclxuXHQgKi9cclxuXHRPd2wucHJvdG90eXBlLmxvb3BDbG9uZSA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0aWYgKCF0aGlzLnNldHRpbmdzLmxvb3AgfHwgdGhpcy5udW0ub0l0ZW1zIDwgdGhpcy5zZXR0aW5ncy5pdGVtcykge1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9XHJcblxyXG5cdFx0dmFyIGFwcGVuZCwgcHJlcGVuZCwgaSxcclxuXHRcdFx0aXRlbXMgPSB0aGlzLnNldHRpbmdzLml0ZW1zLFxyXG5cdFx0XHRsYXN0ID0gdGhpcy5udW0ub0l0ZW1zIC0gMTtcclxuXHJcblx0XHQvLyBpZiBuZWlnaGJvdXIgbWFyZ2luIHRoZW4gYWRkIG9uZSBtb3JlIGR1cGxpY2F0XHJcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5zdGFnZVBhZGRpbmcgJiYgdGhpcy5zZXR0aW5ncy5pdGVtcyA9PT0gMSkge1xyXG5cdFx0XHRpdGVtcyArPSAxO1xyXG5cdFx0fVxyXG5cdFx0dGhpcy5udW0uY0l0ZW1zID0gaXRlbXMgKiAyO1xyXG5cclxuXHRcdGZvciAoaSA9IDA7IGkgPCBpdGVtczsgaSsrKSB7XHJcblx0XHRcdGFwcGVuZCA9IHRoaXMuY2xvbmVJdGVtQ29udGFpbmVyKHRoaXMuZG9tLiRvSXRlbXMuZXEoaSkpO1xyXG5cdFx0XHRwcmVwZW5kID0gdGhpcy5jbG9uZUl0ZW1Db250YWluZXIodGhpcy5kb20uJG9JdGVtcy5lcShsYXN0IC0gaSkpO1xyXG5cclxuXHRcdFx0dGhpcy5kb20uJHN0YWdlLmFwcGVuZChhcHBlbmQpO1xyXG5cdFx0XHR0aGlzLmRvbS4kc3RhZ2UucHJlcGVuZChwcmVwZW5kKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmRvbS4kY0l0ZW1zID0gdGhpcy5kb20uJHN0YWdlLmZpbmQoJy4nICsgdGhpcy5zZXR0aW5ncy5pdGVtQ2xhc3MpLmZpbHRlcihmdW5jdGlvbigpIHtcclxuXHRcdFx0cmV0dXJuICQodGhpcykuZGF0YSgnb3dsLWl0ZW0nKS5jbG9uZSA9PT0gdHJ1ZTtcclxuXHRcdH0pO1xyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIFVwZGF0ZSBjbG9uZWQgZWxlbWVudHMuXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqL1xyXG5cdE93bC5wcm90b3R5cGUucmVDbG9uZSA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0Ly8gcmVtb3ZlIGNsb25lZCBpdGVtc1xyXG5cdFx0aWYgKHRoaXMuZG9tLiRjSXRlbXMgIT09IG51bGwpIHsgLy8gJiYgKHRoaXMubnVtLm9JdGVtcyAhPT0gMCAmJlxyXG5cdFx0XHQvLyB0aGlzLm51bS5vSXRlbXMgPD1cclxuXHRcdFx0Ly8gdGhpcy5zZXR0aW5ncy5pdGVtcykpe1xyXG5cdFx0XHR0aGlzLmRvbS4kY0l0ZW1zLnJlbW92ZSgpO1xyXG5cdFx0XHR0aGlzLmRvbS4kY0l0ZW1zID0gbnVsbDtcclxuXHRcdFx0dGhpcy5udW0uY0l0ZW1zID0gMDtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoIXRoaXMuc2V0dGluZ3MubG9vcCkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHQvLyBnZW5lcmV0ZSBuZXcgZWxlbWVudHNcclxuXHRcdHRoaXMubG9vcENsb25lKCk7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogVXBkYXRlcyBhbGwgaXRlbXMgaW5kZXggZGF0YS5cclxuXHQgKiBAcHJvdGVjdGVkXHJcblx0ICovXHJcblx0T3dsLnByb3RvdHlwZS5jYWxjdWxhdGUgPSBmdW5jdGlvbigpIHtcclxuXHJcblx0XHR2YXIgaSwgaiwgZWxNaW51c01hcmdpbiwgZGlzdCwgYWxsSXRlbXMsIGlXaWR0aCwgIG1lcmdlTnVtYmVyLCAgcG9zTGVmdCA9IDAsIGZ1bGxXaWR0aCA9IDA7XHJcblxyXG5cdFx0Ly8gZWxlbWVudCB3aWR0aCBtaW51cyBuZWlnaGJvdXJcclxuXHRcdHRoaXMud2lkdGguZWwgPSB0aGlzLmRvbS4kZWwud2lkdGgoKSAtICh0aGlzLnNldHRpbmdzLnN0YWdlUGFkZGluZyAqIDIpO1xyXG5cclxuXHRcdC8vIHRvIGNoZWNrXHJcblx0XHR0aGlzLndpZHRoLnZpZXcgPSB0aGlzLmRvbS4kZWwud2lkdGgoKTtcclxuXHJcblx0XHQvLyBjYWxjdWxhdGUgd2lkdGggbWludXMgYWRkaXRpb24gbWFyZ2luc1xyXG5cdFx0ZWxNaW51c01hcmdpbiA9IHRoaXMud2lkdGguZWwgLSAodGhpcy5zZXR0aW5ncy5tYXJnaW4gKiAodGhpcy5zZXR0aW5ncy5pdGVtcyA9PT0gMSA/IDAgOiB0aGlzLnNldHRpbmdzLml0ZW1zIC0gMSkpO1xyXG5cclxuXHRcdC8vIGNhbGN1bGF0ZSBlbGVtZW50IHdpZHRoIGFuZCBpdGVtIHdpZHRoXHJcblx0XHR0aGlzLndpZHRoLmVsID0gdGhpcy53aWR0aC5lbCArIHRoaXMuc2V0dGluZ3MubWFyZ2luO1xyXG5cdFx0dGhpcy53aWR0aC5pdGVtID0gKChlbE1pbnVzTWFyZ2luIC8gdGhpcy5zZXR0aW5ncy5pdGVtcykgKyB0aGlzLnNldHRpbmdzLm1hcmdpbikudG9GaXhlZCgzKTtcclxuXHJcblx0XHR0aGlzLmRvbS4kaXRlbXMgPSB0aGlzLmRvbS4kc3RhZ2UuZmluZCgnLm93bC1pdGVtJyk7XHJcblx0XHR0aGlzLm51bS5pdGVtcyA9IHRoaXMuZG9tLiRpdGVtcy5sZW5ndGg7XHJcblxyXG5cdFx0Ly8gY2hhbmdlIHRvIGF1dG9XaWR0aHNcclxuXHRcdGlmICh0aGlzLnNldHRpbmdzLmF1dG9XaWR0aCkge1xyXG5cdFx0XHR0aGlzLmRvbS4kaXRlbXMuY3NzKCd3aWR0aCcsICcnKTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBTZXQgZ3JpZCBhcnJheVxyXG5cdFx0dGhpcy5fY29vcmRpbmF0ZXMgPSBbXTtcclxuXHRcdHRoaXMubnVtLm1lcmdlZCA9IFtdO1xyXG5cclxuXHRcdC8vIGl0ZW0gZGlzdGFuY2VzXHJcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5ydGwpIHtcclxuXHRcdFx0ZGlzdCA9IHRoaXMuc2V0dGluZ3MuY2VudGVyID8gLSgodGhpcy53aWR0aC5lbCkgLyAyKSA6IDA7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHRkaXN0ID0gdGhpcy5zZXR0aW5ncy5jZW50ZXIgPyAodGhpcy53aWR0aC5lbCkgLyAyIDogMDtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLndpZHRoLm1lcmdlU3RhZ2UgPSAwO1xyXG5cclxuXHRcdC8vIENhbGN1bGF0ZSBpdGVtcyBwb3NpdGlvbnNcclxuXHRcdGZvciAoaSA9IDA7IGkgPCB0aGlzLm51bS5pdGVtczsgaSsrKSB7XHJcblxyXG5cdFx0XHQvLyBjaGVjayBtZXJnZWQgaXRlbXNcclxuXHJcblx0XHRcdGlmICh0aGlzLnNldHRpbmdzLm1lcmdlKSB7XHJcblx0XHRcdFx0bWVyZ2VOdW1iZXIgPSB0aGlzLmRvbS4kaXRlbXMuZXEoaSkuZmluZCgnW2RhdGEtbWVyZ2VdJykuYXR0cignZGF0YS1tZXJnZScpIHx8IDE7XHJcblx0XHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MubWVyZ2VGaXQgJiYgbWVyZ2VOdW1iZXIgPiB0aGlzLnNldHRpbmdzLml0ZW1zKSB7XHJcblx0XHRcdFx0XHRtZXJnZU51bWJlciA9IHRoaXMuc2V0dGluZ3MuaXRlbXM7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHRoaXMubnVtLm1lcmdlZC5wdXNoKHBhcnNlSW50KG1lcmdlTnVtYmVyKSk7XHJcblx0XHRcdFx0dGhpcy53aWR0aC5tZXJnZVN0YWdlICs9IHRoaXMud2lkdGguaXRlbSAqIHRoaXMubnVtLm1lcmdlZFtpXTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHR0aGlzLm51bS5tZXJnZWQucHVzaCgxKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aVdpZHRoID0gdGhpcy53aWR0aC5pdGVtICogdGhpcy5udW0ubWVyZ2VkW2ldO1xyXG5cclxuXHRcdFx0Ly8gYXV0b1dpZHRoIGl0ZW0gc2l6ZVxyXG5cdFx0XHRpZiAodGhpcy5zZXR0aW5ncy5hdXRvV2lkdGgpIHtcclxuXHRcdFx0XHRpV2lkdGggPSB0aGlzLmRvbS4kaXRlbXMuZXEoaSkud2lkdGgoKSArIHRoaXMuc2V0dGluZ3MubWFyZ2luO1xyXG5cdFx0XHRcdGlmICh0aGlzLnNldHRpbmdzLnJ0bCkge1xyXG5cdFx0XHRcdFx0dGhpcy5kb20uJGl0ZW1zW2ldLnN0eWxlLm1hcmdpbkxlZnQgPSB0aGlzLnNldHRpbmdzLm1hcmdpbiArICdweCc7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHRoaXMuZG9tLiRpdGVtc1tpXS5zdHlsZS5tYXJnaW5SaWdodCA9IHRoaXMuc2V0dGluZ3MubWFyZ2luICsgJ3B4JztcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHR9XHJcblx0XHRcdC8vIHB1c2ggaXRlbSBwb3NpdGlvbiBpbnRvIGFycmF5XHJcblx0XHRcdHRoaXMuX2Nvb3JkaW5hdGVzLnB1c2goZGlzdCk7XHJcblxyXG5cdFx0XHQvLyB1cGRhdGUgaXRlbSBkYXRhXHJcblx0XHRcdHRoaXMuZG9tLiRpdGVtcy5lcShpKS5kYXRhKCdvd2wtaXRlbScpLnBvc0xlZnQgPSBwb3NMZWZ0O1xyXG5cdFx0XHR0aGlzLmRvbS4kaXRlbXMuZXEoaSkuZGF0YSgnb3dsLWl0ZW0nKS53aWR0aCA9IGlXaWR0aDtcclxuXHJcblx0XHRcdC8vIGRpc3Qgc3RhcnRzIGZyb20gbWlkZGxlIG9mIHN0YWdlIGlmIGNlbnRlclxyXG5cdFx0XHQvLyBwb3NMZWZ0IGFsd2F5cyBzdGFydHMgZnJvbSAwXHJcblx0XHRcdGlmICh0aGlzLnNldHRpbmdzLnJ0bCkge1xyXG5cdFx0XHRcdGRpc3QgKz0gaVdpZHRoO1xyXG5cdFx0XHRcdHBvc0xlZnQgKz0gaVdpZHRoO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGRpc3QgLT0gaVdpZHRoO1xyXG5cdFx0XHRcdHBvc0xlZnQgLT0gaVdpZHRoO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRmdWxsV2lkdGggLT0gTWF0aC5hYnMoaVdpZHRoKTtcclxuXHJcblx0XHRcdC8vIHVwZGF0ZSBwb3NpdGlvbiBpZiBjZW50ZXJcclxuXHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MuY2VudGVyKSB7XHJcblx0XHRcdFx0dGhpcy5fY29vcmRpbmF0ZXNbaV0gPSAhdGhpcy5zZXR0aW5ncy5ydGwgPyB0aGlzLl9jb29yZGluYXRlc1tpXSAtIChpV2lkdGggLyAyKSA6IHRoaXMuX2Nvb3JkaW5hdGVzW2ldXHJcblx0XHRcdFx0XHQrIChpV2lkdGggLyAyKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLnNldHRpbmdzLmF1dG9XaWR0aCkge1xyXG5cdFx0XHR0aGlzLndpZHRoLnN0YWdlID0gdGhpcy5zZXR0aW5ncy5jZW50ZXIgPyBNYXRoLmFicyhmdWxsV2lkdGgpIDogTWF0aC5hYnMoZGlzdCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLndpZHRoLnN0YWdlID0gTWF0aC5hYnMoZnVsbFdpZHRoKTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyB1cGRhdGUgaW5kZXhBYnMgb24gYWxsIGl0ZW1zXHJcblx0XHRhbGxJdGVtcyA9IHRoaXMubnVtLm9JdGVtcyArIHRoaXMubnVtLmNJdGVtcztcclxuXHJcblx0XHRmb3IgKGogPSAwOyBqIDwgYWxsSXRlbXM7IGorKykge1xyXG5cdFx0XHR0aGlzLmRvbS4kaXRlbXMuZXEoaikuZGF0YSgnb3dsLWl0ZW0nKS5pbmRleEFicyA9IGo7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gUmVjYWxjdWxhdGUgZ3JpZFxyXG5cdFx0dGhpcy5zZXRTaXplcygpO1xyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIFNldCBzaXplcyBvbiBlbGVtZW50cyBmcm9tIGBjb2xsZWN0RGF0YWAuXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqIEB0b2RvIENSQVpZIEZJWCEhISBEb3VibGVjaGVjayB0aGlzIVxyXG5cdCAqL1xyXG5cdE93bC5wcm90b3R5cGUuc2V0U2l6ZXMgPSBmdW5jdGlvbigpIHtcclxuXHJcblx0XHQvLyBzaG93IG5laWdoYm91cnNcclxuXHRcdGlmICh0aGlzLnNldHRpbmdzLnN0YWdlUGFkZGluZyAhPT0gZmFsc2UpIHtcclxuXHRcdFx0dGhpcy5kb20ub1N0YWdlLnN0eWxlLnBhZGRpbmdMZWZ0ID0gdGhpcy5zZXR0aW5ncy5zdGFnZVBhZGRpbmcgKyAncHgnO1xyXG5cdFx0XHR0aGlzLmRvbS5vU3RhZ2Uuc3R5bGUucGFkZGluZ1JpZ2h0ID0gdGhpcy5zZXR0aW5ncy5zdGFnZVBhZGRpbmcgKyAncHgnO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIGlmKHRoaXMud2lkdGguc3RhZ2VQcmV2ID4gdGhpcy53aWR0aC5zdGFnZSl7XHJcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5ydGwpIHtcclxuXHRcdFx0d2luZG93LnNldFRpbWVvdXQoJC5wcm94eShmdW5jdGlvbigpIHtcclxuXHRcdFx0XHR0aGlzLmRvbS5zdGFnZS5zdHlsZS53aWR0aCA9IHRoaXMud2lkdGguc3RhZ2UgKyAncHgnO1xyXG5cdFx0XHR9LCB0aGlzKSwgMCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLmRvbS5zdGFnZS5zdHlsZS53aWR0aCA9IHRoaXMud2lkdGguc3RhZ2UgKyAncHgnO1xyXG5cdFx0fVxyXG5cclxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5udW0uaXRlbXM7IGkrKykge1xyXG5cclxuXHRcdFx0Ly8gU2V0IGl0ZW1zIHdpZHRoXHJcblx0XHRcdGlmICghdGhpcy5zZXR0aW5ncy5hdXRvV2lkdGgpIHtcclxuXHRcdFx0XHR0aGlzLmRvbS4kaXRlbXNbaV0uc3R5bGUud2lkdGggPSB0aGlzLndpZHRoLml0ZW0gLSAodGhpcy5zZXR0aW5ncy5tYXJnaW4pICsgJ3B4JztcclxuXHRcdFx0fVxyXG5cdFx0XHQvLyBhZGQgbWFyZ2luXHJcblx0XHRcdGlmICh0aGlzLnNldHRpbmdzLnJ0bCkge1xyXG5cdFx0XHRcdHRoaXMuZG9tLiRpdGVtc1tpXS5zdHlsZS5tYXJnaW5MZWZ0ID0gdGhpcy5zZXR0aW5ncy5tYXJnaW4gKyAncHgnO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHRoaXMuZG9tLiRpdGVtc1tpXS5zdHlsZS5tYXJnaW5SaWdodCA9IHRoaXMuc2V0dGluZ3MubWFyZ2luICsgJ3B4JztcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKHRoaXMubnVtLm1lcmdlZFtpXSAhPT0gMSAmJiAhdGhpcy5zZXR0aW5ncy5hdXRvV2lkdGgpIHtcclxuXHRcdFx0XHR0aGlzLmRvbS4kaXRlbXNbaV0uc3R5bGUud2lkdGggPSAodGhpcy53aWR0aC5pdGVtICogdGhpcy5udW0ubWVyZ2VkW2ldKSAtICh0aGlzLnNldHRpbmdzLm1hcmdpbikgKyAncHgnO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gc2F2ZSBwcmV2IHN0YWdlIHNpemVcclxuXHRcdHRoaXMud2lkdGguc3RhZ2VQcmV2ID0gdGhpcy53aWR0aC5zdGFnZTtcclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBVcGRhdGVzIGFsbCBkYXRhIGJ5IGNhbGxpbmcgYHJlZnJlc2hgLlxyXG5cdCAqIEBwcm90ZWN0ZWRcclxuXHQgKi9cclxuXHRPd2wucHJvdG90eXBlLnJlc3BvbnNpdmUgPSBmdW5jdGlvbigpIHtcclxuXHJcblx0XHRpZiAoIXRoaXMubnVtLm9JdGVtcykge1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9XHJcblx0XHQvLyBJZiBFbCB3aWR0aCBoYXNudCBjaGFuZ2UgdGhlbiBzdG9wIHJlc3BvbnNpdmVcclxuXHRcdHZhciBlbENoYW5nZWQgPSB0aGlzLmlzRWxXaWR0aENoYW5nZWQoKTtcclxuXHRcdGlmICghZWxDaGFuZ2VkKSB7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAodGhpcy50cmlnZ2VyKCdyZXNpemUnKS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkge1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5zdGF0ZS5yZXNwb25zaXZlID0gdHJ1ZTtcclxuXHRcdHRoaXMucmVmcmVzaCgpO1xyXG5cdFx0dGhpcy5zdGF0ZS5yZXNwb25zaXZlID0gZmFsc2U7XHJcblxyXG5cdFx0dGhpcy50cmlnZ2VyKCdyZXNpemVkJyk7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogUmVmcmVzaGVzIHRoZSBjYXJvdXNlbCBwcmltYXJpbHkgZm9yIGFkYXB0aXZlIHB1cnBvc2VzLlxyXG5cdCAqIEBwdWJsaWNcclxuXHQgKi9cclxuXHRPd2wucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBjdXJyZW50ID0gdGhpcy5kb20uJG9JdGVtcyAmJiB0aGlzLmRvbS4kb0l0ZW1zLmVxKHRoaXMubm9ybWFsaXplKHRoaXMuY3VycmVudCgpLCB0cnVlKSk7XHJcblxyXG5cdFx0dGhpcy50cmlnZ2VyKCdyZWZyZXNoJyk7XHJcblxyXG5cdFx0Ly8gVXBkYXRlIE9wdGlvbnMgZm9yIGdpdmVuIHdpZHRoXHJcblx0XHR0aGlzLnNldFJlc3BvbnNpdmVPcHRpb25zKCk7XHJcblxyXG5cdFx0Ly8gdXBkYXRlIGluZm8gYWJvdXQgbG9jYWwgY29udGVudFxyXG5cdFx0dGhpcy51cGRhdGVMb2NhbENvbnRlbnQoKTtcclxuXHJcblx0XHQvLyB1ZHBhdGUgb3B0aW9uc1xyXG5cdFx0dGhpcy5vcHRpb25zTG9naWMoKTtcclxuXHJcblx0XHQvLyBpZiBubyBpdGVtcyB0aGVuIHN0b3BcclxuXHRcdGlmICh0aGlzLm51bS5vSXRlbXMgPT09IDApIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIEhpZGUgYW5kIFNob3cgbWV0aG9kcyBoZWxwcyBoZXJlIHRvIHNldCBhIHByb3BlciB3aWR0aHMuXHJcblx0XHQvLyBUaGlzIHByZXZlbnRzIFNjcm9sbGJhciB0byBiZSBjYWxjdWxhdGVkIGluIHN0YWdlIHdpZHRoXHJcblx0XHR0aGlzLmRvbS4kc3RhZ2UuYWRkQ2xhc3MoJ293bC1yZWZyZXNoJyk7XHJcblxyXG5cdFx0Ly8gUmVtb3ZlIGNsb25lcyBhbmQgZ2VuZXJhdGUgbmV3IG9uZXNcclxuXHRcdHRoaXMucmVDbG9uZSgpO1xyXG5cclxuXHRcdC8vIGNhbGN1bGF0ZVxyXG5cdFx0dGhpcy5jYWxjdWxhdGUoKTtcclxuXHJcblx0XHQvLyBhYWFhbmQgc2hvdy5cclxuXHRcdHRoaXMuZG9tLiRzdGFnZS5yZW1vdmVDbGFzcygnb3dsLXJlZnJlc2gnKTtcclxuXHJcblx0XHRpZiAoIWN1cnJlbnQpIHtcclxuXHRcdFx0dGhpcy5kb20ub1N0YWdlLnNjcm9sbExlZnQgPSAwO1xyXG5cdFx0XHR0aGlzLnJlc2V0KHRoaXMuZG9tLiRvSXRlbXMuZXEoMCkuZGF0YSgnb3dsLWl0ZW0nKS5pbmRleEFicyk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLnJlc2V0KGN1cnJlbnQuZGF0YSgnb3dsLWl0ZW0nKS5pbmRleEFicyk7IC8vIGZpeCB0aGF0XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5zdGF0ZS5vcmllbnRhdGlvbiA9IHdpbmRvdy5vcmllbnRhdGlvbjtcclxuXHJcblx0XHR0aGlzLndhdGNoVmlzaWJpbGl0eSgpO1xyXG5cclxuXHRcdHRoaXMudHJpZ2dlcigncmVmcmVzaGVkJyk7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogVXBkYXRlcyBpbmZvcm1hdGlvbiBhYm91dCBjdXJyZW50IHN0YXRlIG9mIGl0ZW1zICh2aXNpYmlsZSwgaGlkZGVuLCBhY3RpdmUsIGV0Yy4pLlxyXG5cdCAqIEBwcm90ZWN0ZWRcclxuXHQgKi9cclxuXHRPd2wucHJvdG90eXBlLnVwZGF0ZUFjdGl2ZUl0ZW1zID0gZnVuY3Rpb24oKSB7XHJcblx0XHR0aGlzLnRyaWdnZXIoJ2NoYW5nZScsIHsgcHJvcGVydHk6IHsgbmFtZTogJ2l0ZW1zJywgdmFsdWU6IHRoaXMuZG9tLiRpdGVtcyB9IH0pO1xyXG5cclxuXHRcdHZhciBpLCBqLCBpdGVtLCBpcG9zLCBpd2lkdGgsIG91dHNpZGVWaWV3O1xyXG5cclxuXHRcdC8vIGNsZWFyIHN0YXRlc1xyXG5cdFx0Zm9yIChpID0gMDsgaSA8IHRoaXMubnVtLml0ZW1zOyBpKyspIHtcclxuXHRcdFx0dGhpcy5kb20uJGl0ZW1zLmVxKGkpLmRhdGEoJ293bC1pdGVtJykuYWN0aXZlID0gZmFsc2U7XHJcblx0XHRcdHRoaXMuZG9tLiRpdGVtcy5lcShpKS5kYXRhKCdvd2wtaXRlbScpLmN1cnJlbnQgPSBmYWxzZTtcclxuXHRcdFx0dGhpcy5kb20uJGl0ZW1zLmVxKGkpLnJlbW92ZUNsYXNzKHRoaXMuc2V0dGluZ3MuYWN0aXZlQ2xhc3MpLnJlbW92ZUNsYXNzKHRoaXMuc2V0dGluZ3MuY2VudGVyQ2xhc3MpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMubnVtLmFjdGl2ZSA9IDA7XHJcblx0XHRwYWRkaW5nID0gdGhpcy5zZXR0aW5ncy5zdGFnZVBhZGRpbmcgKiAyO1xyXG5cdFx0c3RhZ2VYID0gdGhpcy5jb29yZGluYXRlcyh0aGlzLmN1cnJlbnQoKSkgKyBwYWRkaW5nO1xyXG5cdFx0dmlldyA9IHRoaXMuc2V0dGluZ3MucnRsID8gdGhpcy53aWR0aC52aWV3IDogLXRoaXMud2lkdGgudmlldztcclxuXHJcblx0XHRmb3IgKGogPSAwOyBqIDwgdGhpcy5udW0uaXRlbXM7IGorKykge1xyXG5cclxuXHRcdFx0aXRlbSA9IHRoaXMuZG9tLiRpdGVtcy5lcShqKTtcclxuXHRcdFx0aXBvcyA9IGl0ZW0uZGF0YSgnb3dsLWl0ZW0nKS5wb3NMZWZ0O1xyXG5cdFx0XHRpd2lkdGggPSBpdGVtLmRhdGEoJ293bC1pdGVtJykud2lkdGg7XHJcblx0XHRcdG91dHNpZGVWaWV3ID0gdGhpcy5zZXR0aW5ncy5ydGwgPyBpcG9zIC0gaXdpZHRoIC0gcGFkZGluZyA6IGlwb3MgLSBpd2lkdGggKyBwYWRkaW5nO1xyXG5cclxuXHRcdFx0aWYgKCh0aGlzLm9wKGlwb3MsICc8PScsIHN0YWdlWCkgJiYgKHRoaXMub3AoaXBvcywgJz4nLCBzdGFnZVggKyB2aWV3KSkpXHJcblx0XHRcdFx0fHwgKHRoaXMub3Aob3V0c2lkZVZpZXcsICc8Jywgc3RhZ2VYKSAmJiB0aGlzLm9wKG91dHNpZGVWaWV3LCAnPicsIHN0YWdlWCArIHZpZXcpKSkge1xyXG5cclxuXHRcdFx0XHR0aGlzLm51bS5hY3RpdmUrKztcclxuXHJcblx0XHRcdFx0aXRlbS5kYXRhKCdvd2wtaXRlbScpLmFjdGl2ZSA9IHRydWU7XHJcblx0XHRcdFx0aXRlbS5kYXRhKCdvd2wtaXRlbScpLmN1cnJlbnQgPSB0cnVlO1xyXG5cdFx0XHRcdGl0ZW0uYWRkQ2xhc3ModGhpcy5zZXR0aW5ncy5hY3RpdmVDbGFzcyk7XHJcblxyXG5cdFx0XHRcdGlmICghdGhpcy5zZXR0aW5ncy5sYXp5TG9hZCkge1xyXG5cdFx0XHRcdFx0aXRlbS5kYXRhKCdvd2wtaXRlbScpLmxvYWRlZCA9IHRydWU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmICh0aGlzLnNldHRpbmdzLmxvb3ApIHtcclxuXHRcdFx0XHRcdHRoaXMudXBkYXRlQ2xvbmVkSXRlbXNTdGF0ZShpdGVtLmRhdGEoJ293bC1pdGVtJykuaW5kZXgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLnNldHRpbmdzLmNlbnRlcikge1xyXG5cdFx0XHR0aGlzLmRvbS4kaXRlbXMuZXEodGhpcy5jdXJyZW50KCkpLmFkZENsYXNzKHRoaXMuc2V0dGluZ3MuY2VudGVyQ2xhc3MpLmRhdGEoJ293bC1pdGVtJykuY2VudGVyID0gdHJ1ZTtcclxuXHRcdH1cclxuXHRcdHRoaXMudHJpZ2dlcignY2hhbmdlZCcsIHsgcHJvcGVydHk6IHsgbmFtZTogJ2l0ZW1zJywgdmFsdWU6IHRoaXMuZG9tLiRpdGVtcyB9IH0pO1xyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIFNldHMgY3VycmVudCBzdGF0ZSBvbiBzaWJpbGluZ3MgaXRlbXMgZm9yIGNlbnRlci5cclxuXHQgKiBAcHJvdGVjdGVkXHJcblx0ICovXHJcblx0T3dsLnByb3RvdHlwZS51cGRhdGVDbG9uZWRJdGVtc1N0YXRlID0gZnVuY3Rpb24oYWN0aXZlSW5kZXgpIHtcclxuXHJcblx0XHQvLyBmaW5kIGNsb25lZCBjZW50ZXJcclxuXHRcdHZhciBjZW50ZXIsICRlbCwgaTtcclxuXHRcdGlmICh0aGlzLnNldHRpbmdzLmNlbnRlcikge1xyXG5cdFx0XHRjZW50ZXIgPSB0aGlzLmRvbS4kaXRlbXMuZXEodGhpcy5jdXJyZW50KCkpLmRhdGEoJ293bC1pdGVtJykuaW5kZXg7XHJcblx0XHR9XHJcblxyXG5cdFx0Zm9yIChpID0gMDsgaSA8IHRoaXMubnVtLml0ZW1zOyBpKyspIHtcclxuXHRcdFx0JGVsID0gdGhpcy5kb20uJGl0ZW1zLmVxKGkpO1xyXG5cdFx0XHRpZiAoJGVsLmRhdGEoJ293bC1pdGVtJykuaW5kZXggPT09IGFjdGl2ZUluZGV4KSB7XHJcblx0XHRcdFx0JGVsLmRhdGEoJ293bC1pdGVtJykuY3VycmVudCA9IHRydWU7XHJcblx0XHRcdFx0aWYgKCRlbC5kYXRhKCdvd2wtaXRlbScpLmluZGV4ID09PSBjZW50ZXIpIHtcclxuXHRcdFx0XHRcdCRlbC5hZGRDbGFzcyh0aGlzLnNldHRpbmdzLmNlbnRlckNsYXNzKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBTYXZlIGludGVybmFsIGV2ZW50IHJlZmVyZW5jZXMgYW5kIGFkZCBldmVudCBiYXNlZCBmdW5jdGlvbnMuXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqL1xyXG5cdE93bC5wcm90b3R5cGUuZXZlbnRzQ2FsbCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0Ly8gU2F2ZSBldmVudHMgcmVmZXJlbmNlc1xyXG5cdFx0dGhpcy5lLl9vbkRyYWdTdGFydCA9ICQucHJveHkoZnVuY3Rpb24oZSkge1xyXG5cdFx0XHR0aGlzLm9uRHJhZ1N0YXJ0KGUpO1xyXG5cdFx0fSwgdGhpcyk7XHJcblx0XHR0aGlzLmUuX29uRHJhZ01vdmUgPSAkLnByb3h5KGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0dGhpcy5vbkRyYWdNb3ZlKGUpO1xyXG5cdFx0fSwgdGhpcyk7XHJcblx0XHR0aGlzLmUuX29uRHJhZ0VuZCA9ICQucHJveHkoZnVuY3Rpb24oZSkge1xyXG5cdFx0XHR0aGlzLm9uRHJhZ0VuZChlKTtcclxuXHRcdH0sIHRoaXMpO1xyXG5cdFx0dGhpcy5lLl90cmFuc2l0aW9uRW5kID0gJC5wcm94eShmdW5jdGlvbihlKSB7XHJcblx0XHRcdHRoaXMudHJhbnNpdGlvbkVuZChlKTtcclxuXHRcdH0sIHRoaXMpO1xyXG5cdFx0dGhpcy5lLl9yZXNpemVyID0gJC5wcm94eShmdW5jdGlvbigpIHtcclxuXHRcdFx0dGhpcy5yZXNwb25zaXZlVGltZXIoKTtcclxuXHRcdH0sIHRoaXMpO1xyXG5cdFx0dGhpcy5lLl9yZXNwb25zaXZlQ2FsbCA9ICQucHJveHkoZnVuY3Rpb24oKSB7XHJcblx0XHRcdHRoaXMucmVzcG9uc2l2ZSgpO1xyXG5cdFx0fSwgdGhpcyk7XHJcblx0XHR0aGlzLmUuX3ByZXZlbnRDbGljayA9ICQucHJveHkoZnVuY3Rpb24oZSkge1xyXG5cdFx0XHR0aGlzLnByZXZlbnRDbGljayhlKTtcclxuXHRcdH0sIHRoaXMpO1xyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIENoZWNrcyB3aW5kb3cgYHJlc2l6ZWAgZXZlbnQuXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqL1xyXG5cdE93bC5wcm90b3R5cGUucmVzcG9uc2l2ZVRpbWVyID0gZnVuY3Rpb24oKSB7XHJcblx0XHRpZiAodGhpcy52aWV3cG9ydCgpID09PSB0aGlzLndpZHRoLnByZXZXaW5kb3cpIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cdFx0d2luZG93LmNsZWFyVGltZW91dCh0aGlzLnJlc2l6ZVRpbWVyKTtcclxuXHJcblx0XHR0aGlzLnJlc2l6ZVRpbWVyID0gd2luZG93LnNldFRpbWVvdXQodGhpcy5lLl9yZXNwb25zaXZlQ2FsbCwgdGhpcy5zZXR0aW5ncy5yZXNwb25zaXZlUmVmcmVzaFJhdGUpO1xyXG5cdFx0dGhpcy53aWR0aC5wcmV2V2luZG93ID0gdGhpcy52aWV3cG9ydCgpO1xyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIENoZWNrcyBmb3IgdG91Y2gvbW91c2UgZHJhZyBvcHRpb25zIGFuZCBhZGQgbmVjZXNzZXJ5IGV2ZW50IGhhbmRsZXJzLlxyXG5cdCAqIEBwcm90ZWN0ZWRcclxuXHQgKi9cclxuXHRPd2wucHJvdG90eXBlLmludGVybmFsRXZlbnRzID0gZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgaXNUb3VjaCA9IGlzVG91Y2hTdXBwb3J0KCksXHJcblx0XHRcdGlzVG91Y2hJRSA9IGlzVG91Y2hTdXBwb3J0SUUoKTtcclxuXHJcblx0XHRpZiAoaXNUb3VjaCAmJiAhaXNUb3VjaElFKSB7XHJcblx0XHRcdHRoaXMuZHJhZ1R5cGUgPSBbICd0b3VjaHN0YXJ0JywgJ3RvdWNobW92ZScsICd0b3VjaGVuZCcsICd0b3VjaGNhbmNlbCcgXTtcclxuXHRcdH0gZWxzZSBpZiAoaXNUb3VjaCAmJiBpc1RvdWNoSUUpIHtcclxuXHRcdFx0dGhpcy5kcmFnVHlwZSA9IFsgJ01TUG9pbnRlckRvd24nLCAnTVNQb2ludGVyTW92ZScsICdNU1BvaW50ZXJVcCcsICdNU1BvaW50ZXJDYW5jZWwnIF07XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aGlzLmRyYWdUeXBlID0gWyAnbW91c2Vkb3duJywgJ21vdXNlbW92ZScsICdtb3VzZXVwJyBdO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICgoaXNUb3VjaCB8fCBpc1RvdWNoSUUpICYmIHRoaXMuc2V0dGluZ3MudG91Y2hEcmFnKSB7XHJcblx0XHRcdC8vIHRvdWNoIGNhbmNlbCBldmVudFxyXG5cdFx0XHR0aGlzLm9uKGRvY3VtZW50LCB0aGlzLmRyYWdUeXBlWzNdLCB0aGlzLmUuX29uRHJhZ0VuZCk7XHJcblxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0Ly8gZmlyZWZveCBzdGFydGRyYWcgZml4IC0gYWRkZXZlbnRsaXN0ZW5lciBkb2VzbnQgd29yayBoZXJlIDovXHJcblx0XHRcdHRoaXMuZG9tLiRzdGFnZS5vbignZHJhZ3N0YXJ0JywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdGlmICh0aGlzLnNldHRpbmdzLm1vdXNlRHJhZykge1xyXG5cdFx0XHRcdC8vIGRpc2FibGUgdGV4dCBzZWxlY3RcclxuXHRcdFx0XHR0aGlzLmRvbS5zdGFnZS5vbnNlbGVjdHN0YXJ0ID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0fTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQvLyBlbmFibGUgdGV4dCBzZWxlY3RcclxuXHRcdFx0XHR0aGlzLmRvbS4kZWwuYWRkQ2xhc3MoJ293bC10ZXh0LXNlbGVjdC1vbicpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gQ2F0Y2ggdHJhbnNpdGlvbkVuZCBldmVudFxyXG5cdFx0aWYgKHRoaXMudHJhbnNpdGlvbkVuZFZlbmRvcikge1xyXG5cdFx0XHR0aGlzLm9uKHRoaXMuZG9tLnN0YWdlLCB0aGlzLnRyYW5zaXRpb25FbmRWZW5kb3IsIHRoaXMuZS5fdHJhbnNpdGlvbkVuZCwgZmFsc2UpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFJlc3BvbnNpdmVcclxuXHRcdGlmICh0aGlzLnNldHRpbmdzLnJlc3BvbnNpdmUgIT09IGZhbHNlKSB7XHJcblx0XHRcdHRoaXMub24od2luZG93LCAncmVzaXplJywgdGhpcy5lLl9yZXNpemVyLCBmYWxzZSk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5kcmFnRXZlbnRzKCk7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogVHJpZ2dlcnMgZXZlbnQgaGFuZGxlcnMgZm9yIGRyYWcgZXZlbnRzLlxyXG5cdCAqIEBwcm90ZWN0ZWRcclxuXHQgKi9cclxuXHRPd2wucHJvdG90eXBlLmRyYWdFdmVudHMgPSBmdW5jdGlvbigpIHtcclxuXHJcblx0XHRpZiAodGhpcy5zZXR0aW5ncy50b3VjaERyYWcgJiYgKHRoaXMuZHJhZ1R5cGVbMF0gPT09ICd0b3VjaHN0YXJ0JyB8fCB0aGlzLmRyYWdUeXBlWzBdID09PSAnTVNQb2ludGVyRG93bicpKSB7XHJcblx0XHRcdHRoaXMub24odGhpcy5kb20uc3RhZ2UsIHRoaXMuZHJhZ1R5cGVbMF0sIHRoaXMuZS5fb25EcmFnU3RhcnQsIGZhbHNlKTtcclxuXHRcdH0gZWxzZSBpZiAodGhpcy5zZXR0aW5ncy5tb3VzZURyYWcgJiYgdGhpcy5kcmFnVHlwZVswXSA9PT0gJ21vdXNlZG93bicpIHtcclxuXHRcdFx0dGhpcy5vbih0aGlzLmRvbS5zdGFnZSwgdGhpcy5kcmFnVHlwZVswXSwgdGhpcy5lLl9vbkRyYWdTdGFydCwgZmFsc2UpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGhpcy5vZmYodGhpcy5kb20uc3RhZ2UsIHRoaXMuZHJhZ1R5cGVbMF0sIHRoaXMuZS5fb25EcmFnU3RhcnQpO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIEhhbmRsZXMgdG91Y2hzdGFydC9tb3VzZWRvd24gZXZlbnQuXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqIEBwYXJhbSB7RXZlbnR9IGV2ZW50IC0gVGhlIGV2ZW50IGFyZ3VtZW50cy5cclxuXHQgKi9cclxuXHRPd2wucHJvdG90eXBlLm9uRHJhZ1N0YXJ0ID0gZnVuY3Rpb24oZXZlbnQpIHtcclxuXHRcdHZhciBldiwgaXNUb3VjaEV2ZW50LCBwYWdlWCwgcGFnZVksIGFuaW1hdGVkUG9zO1xyXG5cclxuXHRcdGV2ID0gZXZlbnQub3JpZ2luYWxFdmVudCB8fCBldmVudCB8fCB3aW5kb3cuZXZlbnQ7XHJcblxyXG5cdFx0Ly8gcHJldmVudCByaWdodCBjbGlja1xyXG5cdFx0aWYgKGV2LndoaWNoID09PSAzKSB7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAodGhpcy5kcmFnVHlwZVswXSA9PT0gJ21vdXNlZG93bicpIHtcclxuXHRcdFx0dGhpcy5kb20uJHN0YWdlLmFkZENsYXNzKCdvd2wtZ3JhYicpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMudHJpZ2dlcignZHJhZycpO1xyXG5cdFx0dGhpcy5kcmFnLnN0YXJ0VGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xyXG5cdFx0dGhpcy5zcGVlZCgwKTtcclxuXHRcdHRoaXMuc3RhdGUuaXNUb3VjaCA9IHRydWU7XHJcblx0XHR0aGlzLnN0YXRlLmlzU2Nyb2xsaW5nID0gZmFsc2U7XHJcblx0XHR0aGlzLnN0YXRlLmlzU3dpcGluZyA9IGZhbHNlO1xyXG5cdFx0dGhpcy5kcmFnLmRpc3RhbmNlID0gMDtcclxuXHJcblx0XHQvLyBpZiBpcyAndG91Y2hzdGFydCdcclxuXHRcdGlzVG91Y2hFdmVudCA9IGV2LnR5cGUgPT09ICd0b3VjaHN0YXJ0JztcclxuXHRcdHBhZ2VYID0gaXNUb3VjaEV2ZW50ID8gZXZlbnQudGFyZ2V0VG91Y2hlc1swXS5wYWdlWCA6IChldi5wYWdlWCB8fCBldi5jbGllbnRYKTtcclxuXHRcdHBhZ2VZID0gaXNUb3VjaEV2ZW50ID8gZXZlbnQudGFyZ2V0VG91Y2hlc1swXS5wYWdlWSA6IChldi5wYWdlWSB8fCBldi5jbGllbnRZKTtcclxuXHJcblx0XHQvLyBnZXQgc3RhZ2UgcG9zaXRpb24gbGVmdFxyXG5cdFx0dGhpcy5kcmFnLm9mZnNldFggPSB0aGlzLmRvbS4kc3RhZ2UucG9zaXRpb24oKS5sZWZ0IC0gdGhpcy5zZXR0aW5ncy5zdGFnZVBhZGRpbmc7XHJcblx0XHR0aGlzLmRyYWcub2Zmc2V0WSA9IHRoaXMuZG9tLiRzdGFnZS5wb3NpdGlvbigpLnRvcDtcclxuXHJcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5ydGwpIHtcclxuXHRcdFx0dGhpcy5kcmFnLm9mZnNldFggPSB0aGlzLmRvbS4kc3RhZ2UucG9zaXRpb24oKS5sZWZ0ICsgdGhpcy53aWR0aC5zdGFnZSAtIHRoaXMud2lkdGguZWxcclxuXHRcdFx0XHQrIHRoaXMuc2V0dGluZ3MubWFyZ2luO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIGNhdGNoIHBvc2l0aW9uIC8vIGllIHRvIGZpeFxyXG5cdFx0aWYgKHRoaXMuc3RhdGUuaW5Nb3Rpb24gJiYgdGhpcy5zdXBwb3J0M2QpIHtcclxuXHRcdFx0YW5pbWF0ZWRQb3MgPSB0aGlzLmdldFRyYW5zZm9ybVByb3BlcnR5KCk7XHJcblx0XHRcdHRoaXMuZHJhZy5vZmZzZXRYID0gYW5pbWF0ZWRQb3M7XHJcblx0XHRcdHRoaXMuYW5pbWF0ZShhbmltYXRlZFBvcyk7XHJcblx0XHRcdHRoaXMuc3RhdGUuaW5Nb3Rpb24gPSB0cnVlO1xyXG5cdFx0fSBlbHNlIGlmICh0aGlzLnN0YXRlLmluTW90aW9uICYmICF0aGlzLnN1cHBvcnQzZCkge1xyXG5cdFx0XHR0aGlzLnN0YXRlLmluTW90aW9uID0gZmFsc2U7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmRyYWcuc3RhcnRYID0gcGFnZVggLSB0aGlzLmRyYWcub2Zmc2V0WDtcclxuXHRcdHRoaXMuZHJhZy5zdGFydFkgPSBwYWdlWSAtIHRoaXMuZHJhZy5vZmZzZXRZO1xyXG5cclxuXHRcdHRoaXMuZHJhZy5zdGFydCA9IHBhZ2VYIC0gdGhpcy5kcmFnLnN0YXJ0WDtcclxuXHRcdHRoaXMuZHJhZy50YXJnZXRFbCA9IGV2LnRhcmdldCB8fCBldi5zcmNFbGVtZW50O1xyXG5cdFx0dGhpcy5kcmFnLnVwZGF0ZWRYID0gdGhpcy5kcmFnLnN0YXJ0O1xyXG5cclxuXHRcdC8vIHRvIGRvL2NoZWNrXHJcblx0XHQvLyBwcmV2ZW50IGxpbmtzIGFuZCBpbWFnZXMgZHJhZ2dpbmc7XHJcblx0XHRpZiAodGhpcy5kcmFnLnRhcmdldEVsLnRhZ05hbWUgPT09IFwiSU1HXCIgfHwgdGhpcy5kcmFnLnRhcmdldEVsLnRhZ05hbWUgPT09IFwiQVwiKSB7XHJcblx0XHRcdHRoaXMuZHJhZy50YXJnZXRFbC5kcmFnZ2FibGUgPSBmYWxzZTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLm9uKGRvY3VtZW50LCB0aGlzLmRyYWdUeXBlWzFdLCB0aGlzLmUuX29uRHJhZ01vdmUsIGZhbHNlKTtcclxuXHRcdHRoaXMub24oZG9jdW1lbnQsIHRoaXMuZHJhZ1R5cGVbMl0sIHRoaXMuZS5fb25EcmFnRW5kLCBmYWxzZSk7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogSGFuZGxlcyB0aGUgdG91Y2htb3ZlL21vdXNlbW92ZSBldmVudHMuXHJcblx0ICogQHRvZG8gU2ltcGxpZnlcclxuXHQgKiBAcHJvdGVjdGVkXHJcblx0ICogQHBhcmFtIHtFdmVudH0gZXZlbnQgLSBUaGUgZXZlbnQgYXJndW1lbnRzLlxyXG5cdCAqL1xyXG5cdE93bC5wcm90b3R5cGUub25EcmFnTW92ZSA9IGZ1bmN0aW9uKGV2ZW50KSB7XHJcblx0XHR2YXIgZXYsIGlzVG91Y2hFdmVudCwgcGFnZVgsIHBhZ2VZLCBtaW5WYWx1ZSwgbWF4VmFsdWUsIHB1bGw7XHJcblxyXG5cdFx0aWYgKCF0aGlzLnN0YXRlLmlzVG91Y2gpIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLnN0YXRlLmlzU2Nyb2xsaW5nKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRldiA9IGV2ZW50Lm9yaWdpbmFsRXZlbnQgfHwgZXZlbnQgfHwgd2luZG93LmV2ZW50O1xyXG5cclxuXHRcdC8vIGlmIGlzICd0b3VjaHN0YXJ0J1xyXG5cdFx0aXNUb3VjaEV2ZW50ID0gZXYudHlwZSA9PSAndG91Y2htb3ZlJztcclxuXHRcdHBhZ2VYID0gaXNUb3VjaEV2ZW50ID8gZXYudGFyZ2V0VG91Y2hlc1swXS5wYWdlWCA6IChldi5wYWdlWCB8fCBldi5jbGllbnRYKTtcclxuXHRcdHBhZ2VZID0gaXNUb3VjaEV2ZW50ID8gZXYudGFyZ2V0VG91Y2hlc1swXS5wYWdlWSA6IChldi5wYWdlWSB8fCBldi5jbGllbnRZKTtcclxuXHJcblx0XHQvLyBEcmFnIERpcmVjdGlvblxyXG5cdFx0dGhpcy5kcmFnLmN1cnJlbnRYID0gcGFnZVggLSB0aGlzLmRyYWcuc3RhcnRYO1xyXG5cdFx0dGhpcy5kcmFnLmN1cnJlbnRZID0gcGFnZVkgLSB0aGlzLmRyYWcuc3RhcnRZO1xyXG5cdFx0dGhpcy5kcmFnLmRpc3RhbmNlID0gdGhpcy5kcmFnLmN1cnJlbnRYIC0gdGhpcy5kcmFnLm9mZnNldFg7XHJcblxyXG5cdFx0Ly8gQ2hlY2sgbW92ZSBkaXJlY3Rpb25cclxuXHRcdGlmICh0aGlzLmRyYWcuZGlzdGFuY2UgPCAwKSB7XHJcblx0XHRcdHRoaXMuc3RhdGUuZGlyZWN0aW9uID0gdGhpcy5zZXR0aW5ncy5ydGwgPyAncmlnaHQnIDogJ2xlZnQnO1xyXG5cdFx0fSBlbHNlIGlmICh0aGlzLmRyYWcuZGlzdGFuY2UgPiAwKSB7XHJcblx0XHRcdHRoaXMuc3RhdGUuZGlyZWN0aW9uID0gdGhpcy5zZXR0aW5ncy5ydGwgPyAnbGVmdCcgOiAncmlnaHQnO1xyXG5cdFx0fVxyXG5cdFx0Ly8gTG9vcFxyXG5cdFx0aWYgKHRoaXMuc2V0dGluZ3MubG9vcCkge1xyXG5cdFx0XHRpZiAodGhpcy5vcCh0aGlzLmRyYWcuY3VycmVudFgsICc+JywgdGhpcy5jb29yZGluYXRlcyh0aGlzLm1pbmltdW0oKSkpICYmIHRoaXMuc3RhdGUuZGlyZWN0aW9uID09PSAncmlnaHQnKSB7XHJcblx0XHRcdFx0dGhpcy5kcmFnLmN1cnJlbnRYIC09ICh0aGlzLnNldHRpbmdzLmNlbnRlciAmJiB0aGlzLmNvb3JkaW5hdGVzKDApKSAtIHRoaXMuY29vcmRpbmF0ZXModGhpcy5udW0ub0l0ZW1zKTtcclxuXHRcdFx0fSBlbHNlIGlmICh0aGlzLm9wKHRoaXMuZHJhZy5jdXJyZW50WCwgJzwnLCB0aGlzLmNvb3JkaW5hdGVzKHRoaXMubWF4aW11bSgpKSkgJiYgdGhpcy5zdGF0ZS5kaXJlY3Rpb24gPT09ICdsZWZ0Jykge1xyXG5cdFx0XHRcdHRoaXMuZHJhZy5jdXJyZW50WCArPSAodGhpcy5zZXR0aW5ncy5jZW50ZXIgJiYgdGhpcy5jb29yZGluYXRlcygwKSkgLSB0aGlzLmNvb3JkaW5hdGVzKHRoaXMubnVtLm9JdGVtcyk7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdC8vIHB1bGxcclxuXHRcdFx0bWluVmFsdWUgPSB0aGlzLnNldHRpbmdzLnJ0bCA/IHRoaXMuY29vcmRpbmF0ZXModGhpcy5tYXhpbXVtKCkpIDogdGhpcy5jb29yZGluYXRlcyh0aGlzLm1pbmltdW0oKSk7XHJcblx0XHRcdG1heFZhbHVlID0gdGhpcy5zZXR0aW5ncy5ydGwgPyB0aGlzLmNvb3JkaW5hdGVzKHRoaXMubWluaW11bSgpKSA6IHRoaXMuY29vcmRpbmF0ZXModGhpcy5tYXhpbXVtKCkpO1xyXG5cdFx0XHRwdWxsID0gdGhpcy5zZXR0aW5ncy5wdWxsRHJhZyA/IHRoaXMuZHJhZy5kaXN0YW5jZSAvIDUgOiAwO1xyXG5cdFx0XHR0aGlzLmRyYWcuY3VycmVudFggPSBNYXRoLm1heChNYXRoLm1pbih0aGlzLmRyYWcuY3VycmVudFgsIG1pblZhbHVlICsgcHVsbCksIG1heFZhbHVlICsgcHVsbCk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gTG9jayBicm93c2VyIGlmIHN3aXBpbmcgaG9yaXpvbnRhbFxyXG5cclxuXHRcdGlmICgodGhpcy5kcmFnLmRpc3RhbmNlID4gOCB8fCB0aGlzLmRyYWcuZGlzdGFuY2UgPCAtOCkpIHtcclxuXHRcdFx0aWYgKGV2LnByZXZlbnREZWZhdWx0ICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGV2LnJldHVyblZhbHVlID0gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdFx0dGhpcy5zdGF0ZS5pc1N3aXBpbmcgPSB0cnVlO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuZHJhZy51cGRhdGVkWCA9IHRoaXMuZHJhZy5jdXJyZW50WDtcclxuXHJcblx0XHQvLyBMb2NrIE93bCBpZiBzY3JvbGxpbmdcclxuXHRcdGlmICgodGhpcy5kcmFnLmN1cnJlbnRZID4gMTYgfHwgdGhpcy5kcmFnLmN1cnJlbnRZIDwgLTE2KSAmJiB0aGlzLnN0YXRlLmlzU3dpcGluZyA9PT0gZmFsc2UpIHtcclxuXHRcdFx0dGhpcy5zdGF0ZS5pc1Njcm9sbGluZyA9IHRydWU7XHJcblx0XHRcdHRoaXMuZHJhZy51cGRhdGVkWCA9IHRoaXMuZHJhZy5zdGFydDtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmFuaW1hdGUodGhpcy5kcmFnLnVwZGF0ZWRYKTtcclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBIYW5kbGVzIHRoZSB0b3VjaGVuZC9tb3VzZXVwIGV2ZW50cy5cclxuXHQgKiBAcHJvdGVjdGVkXHJcblx0ICovXHJcblx0T3dsLnByb3RvdHlwZS5vbkRyYWdFbmQgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBjb21wYXJlVGltZXMsIGRpc3RhbmNlQWJzLCBjbG9zZXN0O1xyXG5cclxuXHRcdGlmICghdGhpcy5zdGF0ZS5pc1RvdWNoKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdGlmICh0aGlzLmRyYWdUeXBlWzBdID09PSAnbW91c2Vkb3duJykge1xyXG5cdFx0XHR0aGlzLmRvbS4kc3RhZ2UucmVtb3ZlQ2xhc3MoJ293bC1ncmFiJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy50cmlnZ2VyKCdkcmFnZ2VkJyk7XHJcblxyXG5cdFx0Ly8gcHJldmVudCBsaW5rcyBhbmQgaW1hZ2VzIGRyYWdnaW5nO1xyXG5cdFx0dGhpcy5kcmFnLnRhcmdldEVsLnJlbW92ZUF0dHJpYnV0ZShcImRyYWdnYWJsZVwiKTtcclxuXHJcblx0XHQvLyByZW1vdmUgZHJhZyBldmVudCBsaXN0ZW5lcnNcclxuXHJcblx0XHR0aGlzLnN0YXRlLmlzVG91Y2ggPSBmYWxzZTtcclxuXHRcdHRoaXMuc3RhdGUuaXNTY3JvbGxpbmcgPSBmYWxzZTtcclxuXHRcdHRoaXMuc3RhdGUuaXNTd2lwaW5nID0gZmFsc2U7XHJcblxyXG5cdFx0Ly8gdG8gY2hlY2tcclxuXHRcdGlmICh0aGlzLmRyYWcuZGlzdGFuY2UgPT09IDAgJiYgdGhpcy5zdGF0ZS5pbk1vdGlvbiAhPT0gdHJ1ZSkge1xyXG5cdFx0XHR0aGlzLnN0YXRlLmluTW90aW9uID0gZmFsc2U7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBwcmV2ZW50IGNsaWNrcyB3aGlsZSBzY3JvbGxpbmdcclxuXHJcblx0XHR0aGlzLmRyYWcuZW5kVGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xyXG5cdFx0Y29tcGFyZVRpbWVzID0gdGhpcy5kcmFnLmVuZFRpbWUgLSB0aGlzLmRyYWcuc3RhcnRUaW1lO1xyXG5cdFx0ZGlzdGFuY2VBYnMgPSBNYXRoLmFicyh0aGlzLmRyYWcuZGlzdGFuY2UpO1xyXG5cclxuXHRcdC8vIHRvIHRlc3RcclxuXHRcdGlmIChkaXN0YW5jZUFicyA+IDMgfHwgY29tcGFyZVRpbWVzID4gMzAwKSB7XHJcblx0XHRcdHRoaXMucmVtb3ZlQ2xpY2sodGhpcy5kcmFnLnRhcmdldEVsKTtcclxuXHRcdH1cclxuXHJcblx0XHRjbG9zZXN0ID0gdGhpcy5jbG9zZXN0KHRoaXMuZHJhZy51cGRhdGVkWCk7XHJcblxyXG5cdFx0dGhpcy5zcGVlZCh0aGlzLnNldHRpbmdzLmRyYWdFbmRTcGVlZCB8fCB0aGlzLnNldHRpbmdzLnNtYXJ0U3BlZWQpO1xyXG5cdFx0dGhpcy5jdXJyZW50KGNsb3Nlc3QpO1xyXG5cclxuXHRcdC8vIGlmIHB1bGxEcmFnIGlzIG9mZiB0aGVuIGZpcmUgdHJhbnNpdGlvbkVuZCBldmVudCBtYW51YWxseSB3aGVuIHN0aWNrXHJcblx0XHQvLyB0byBib3JkZXJcclxuXHRcdGlmICghdGhpcy5zZXR0aW5ncy5wdWxsRHJhZyAmJiB0aGlzLmRyYWcudXBkYXRlZFggPT09IHRoaXMuY29vcmRpbmF0ZXMoY2xvc2VzdCkpIHtcclxuXHRcdFx0dGhpcy50cmFuc2l0aW9uRW5kKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5kcmFnLmRpc3RhbmNlID0gMDtcclxuXHJcblx0XHR0aGlzLm9mZihkb2N1bWVudCwgdGhpcy5kcmFnVHlwZVsxXSwgdGhpcy5lLl9vbkRyYWdNb3ZlKTtcclxuXHRcdHRoaXMub2ZmKGRvY3VtZW50LCB0aGlzLmRyYWdUeXBlWzJdLCB0aGlzLmUuX29uRHJhZ0VuZCk7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogQXR0YWNoZXMgYHByZXZlbnRDbGlja2AgdG8gZGlzYWJsZSBsaW5rIHdoaWxlIHN3aXBwaW5nLlxyXG5cdCAqIEBwcm90ZWN0ZWRcclxuXHQgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBbdGFyZ2V0XSAtIFRoZSB0YXJnZXQgb2YgdGhlIGBjbGlja2AgZXZlbnQuXHJcblx0ICovXHJcblx0T3dsLnByb3RvdHlwZS5yZW1vdmVDbGljayA9IGZ1bmN0aW9uKHRhcmdldCkge1xyXG5cdFx0dGhpcy5kcmFnLnRhcmdldEVsID0gdGFyZ2V0O1xyXG5cdFx0JCh0YXJnZXQpLm9uKCdjbGljay5wcmV2ZW50Q2xpY2snLCB0aGlzLmUuX3ByZXZlbnRDbGljayk7XHJcblx0XHQvLyB0byBtYWtlIHN1cmUgY2xpY2sgaXMgcmVtb3ZlZDpcclxuXHRcdHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHQkKHRhcmdldCkub2ZmKCdjbGljay5wcmV2ZW50Q2xpY2snKTtcclxuXHRcdH0sIDMwMCk7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogU3VwcHJlc3NlcyBjbGljayBldmVudC5cclxuXHQgKiBAcHJvdGVjdGVkXHJcblx0ICogQHBhcmFtIHtFdmVudH0gZXYgLSBUaGUgZXZlbnQgYXJndW1lbnRzLlxyXG5cdCAqL1xyXG5cdE93bC5wcm90b3R5cGUucHJldmVudENsaWNrID0gZnVuY3Rpb24oZXYpIHtcclxuXHRcdGlmIChldi5wcmV2ZW50RGVmYXVsdCkge1xyXG5cdFx0XHRldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0ZXYucmV0dXJuVmFsdWUgPSBmYWxzZTtcclxuXHRcdH1cclxuXHRcdGlmIChldi5zdG9wUHJvcGFnYXRpb24pIHtcclxuXHRcdFx0ZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblx0XHR9XHJcblx0XHQkKGV2LnRhcmdldCkub2ZmKCdjbGljay5wcmV2ZW50Q2xpY2snKTtcclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBDYXRjaGVzIHN0YWdlIHBvc2l0aW9uIHdoaWxlIGFuaW1hdGUgKG9ubHkgQ1NTMykuXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqIEByZXR1cm5zXHJcblx0ICovXHJcblx0T3dsLnByb3RvdHlwZS5nZXRUcmFuc2Zvcm1Qcm9wZXJ0eSA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIHRyYW5zZm9ybSwgbWF0cml4M2Q7XHJcblxyXG5cdFx0dHJhbnNmb3JtID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGhpcy5kb20uc3RhZ2UsIG51bGwpLmdldFByb3BlcnR5VmFsdWUodGhpcy52ZW5kb3JOYW1lICsgJ3RyYW5zZm9ybScpO1xyXG5cdFx0Ly8gdmFyIHRyYW5zZm9ybSA9IHRoaXMuZG9tLiRzdGFnZS5jc3ModGhpcy52ZW5kb3JOYW1lICsgJ3RyYW5zZm9ybScpXHJcblx0XHR0cmFuc2Zvcm0gPSB0cmFuc2Zvcm0ucmVwbGFjZSgvbWF0cml4KDNkKT9cXCh8XFwpL2csICcnKS5zcGxpdCgnLCcpO1xyXG5cdFx0bWF0cml4M2QgPSB0cmFuc2Zvcm0ubGVuZ3RoID09PSAxNjtcclxuXHJcblx0XHRyZXR1cm4gbWF0cml4M2QgIT09IHRydWUgPyB0cmFuc2Zvcm1bNF0gOiB0cmFuc2Zvcm1bMTJdO1xyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIEdldHMgYWJzb2x1dGUgcG9zaXRpb24gb2YgdGhlIGNsb3Nlc3QgaXRlbSBmb3IgYSBjb29yZGluYXRlLlxyXG5cdCAqIEBwcm90ZWN0ZWRcclxuXHQgKiBAcGFyYW0ge051bWJlcn0gY29vcmRpbmF0ZSAtIFRoZSBjb29yZGluYXRlIGluIHBpeGVsLlxyXG5cdCAqIEByZXR1cm4ge051bWJlcn0gLSBUaGUgYWJzb2x1dGUgcG9zaXRpb24gb2YgdGhlIGNsb3Nlc3QgaXRlbS5cclxuXHQgKi9cclxuXHRPd2wucHJvdG90eXBlLmNsb3Nlc3QgPSBmdW5jdGlvbihjb29yZGluYXRlKSB7XHJcblx0XHR2YXIgcG9zaXRpb24gPSAwLCBwdWxsID0gMzA7XHJcblxyXG5cdFx0aWYgKCF0aGlzLnNldHRpbmdzLmZyZWVEcmFnKSB7XHJcblx0XHRcdC8vIGNoZWNrIGNsb3Nlc3QgaXRlbVxyXG5cdFx0XHQkLmVhY2godGhpcy5jb29yZGluYXRlcygpLCAkLnByb3h5KGZ1bmN0aW9uKGluZGV4LCB2YWx1ZSkge1xyXG5cdFx0XHRcdGlmIChjb29yZGluYXRlID4gdmFsdWUgLSBwdWxsICYmIGNvb3JkaW5hdGUgPCB2YWx1ZSArIHB1bGwpIHtcclxuXHRcdFx0XHRcdHBvc2l0aW9uID0gaW5kZXg7XHJcblx0XHRcdFx0fSBlbHNlIGlmICh0aGlzLm9wKGNvb3JkaW5hdGUsICc8JywgdmFsdWUpXHJcblx0XHRcdFx0XHQmJiB0aGlzLm9wKGNvb3JkaW5hdGUsICc+JywgdGhpcy5jb29yZGluYXRlcyhpbmRleCArIDEpIHx8IHZhbHVlIC0gdGhpcy53aWR0aC5lbCkpIHtcclxuXHRcdFx0XHRcdHBvc2l0aW9uID0gdGhpcy5zdGF0ZS5kaXJlY3Rpb24gPT09ICdsZWZ0JyA/IGluZGV4ICsgMSA6IGluZGV4O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSwgdGhpcykpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICghdGhpcy5zZXR0aW5ncy5sb29wKSB7XHJcblx0XHRcdC8vIG5vbiBsb29wIGJvdW5kcmllc1xyXG5cdFx0XHRpZiAodGhpcy5vcChjb29yZGluYXRlLCAnPicsIHRoaXMuY29vcmRpbmF0ZXModGhpcy5taW5pbXVtKCkpKSkge1xyXG5cdFx0XHRcdHBvc2l0aW9uID0gY29vcmRpbmF0ZSA9IHRoaXMubWluaW11bSgpO1xyXG5cdFx0XHR9IGVsc2UgaWYgKHRoaXMub3AoY29vcmRpbmF0ZSwgJzwnLCB0aGlzLmNvb3JkaW5hdGVzKHRoaXMubWF4aW11bSgpKSkpIHtcclxuXHRcdFx0XHRwb3NpdGlvbiA9IGNvb3JkaW5hdGUgPSB0aGlzLm1heGltdW0oKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBwb3NpdGlvbjtcclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBBbmltYXRlcyB0aGUgc3RhZ2UuXHJcblx0ICogQHB1YmxpY1xyXG5cdCAqIEBwYXJhbSB7TnVtYmVyfSBjb29yZGluYXRlIC0gVGhlIGNvb3JkaW5hdGUgaW4gcGl4ZWxzLlxyXG5cdCAqL1xyXG5cdE93bC5wcm90b3R5cGUuYW5pbWF0ZSA9IGZ1bmN0aW9uKGNvb3JkaW5hdGUpIHtcclxuXHRcdHRoaXMudHJpZ2dlcigndHJhbnNsYXRlJyk7XHJcblx0XHR0aGlzLnN0YXRlLmluTW90aW9uID0gdGhpcy5zcGVlZCgpID4gMDtcclxuXHJcblx0XHRpZiAodGhpcy5zdXBwb3J0M2QpIHtcclxuXHRcdFx0dGhpcy5kb20uJHN0YWdlLmNzcyh7XHJcblx0XHRcdFx0dHJhbnNmb3JtOiAndHJhbnNsYXRlM2QoJyArIGNvb3JkaW5hdGUgKyAncHgnICsgJywwcHgsIDBweCknLFxyXG5cdFx0XHRcdHRyYW5zaXRpb246ICh0aGlzLnNwZWVkKCkgLyAxMDAwKSArICdzJ1xyXG5cdFx0XHR9KTtcclxuXHRcdH0gZWxzZSBpZiAodGhpcy5zdGF0ZS5pc1RvdWNoKSB7XHJcblx0XHRcdHRoaXMuZG9tLiRzdGFnZS5jc3Moe1xyXG5cdFx0XHRcdGxlZnQ6IGNvb3JkaW5hdGUgKyAncHgnXHJcblx0XHRcdH0pO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGhpcy5kb20uJHN0YWdlLmFuaW1hdGUoe1xyXG5cdFx0XHRcdGxlZnQ6IGNvb3JkaW5hdGVcclxuXHRcdFx0fSwgdGhpcy5zcGVlZCgpIC8gMTAwMCwgdGhpcy5zZXR0aW5ncy5mYWxsYmFja0Vhc2luZywgJC5wcm94eShmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRpZiAodGhpcy5zdGF0ZS5pbk1vdGlvbikge1xyXG5cdFx0XHRcdFx0dGhpcy50cmFuc2l0aW9uRW5kKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LCB0aGlzKSk7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogU2V0cyB0aGUgYWJzb2x1dGUgcG9zaXRpb24gb2YgdGhlIGN1cnJlbnQgaXRlbS5cclxuXHQgKiBAcHVibGljXHJcblx0ICogQHBhcmFtIHtOdW1iZXJ9IFtwb3NpdGlvbl0gLSBUaGUgbmV3IGFic29sdXRlIHBvc2l0aW9uIG9yIG5vdGhpbmcgdG8gbGVhdmUgaXQgdW5jaGFuZ2VkLlxyXG5cdCAqIEByZXR1cm5zIHtOdW1iZXJ9IC0gVGhlIGFic29sdXRlIHBvc2l0aW9uIG9mIHRoZSBjdXJyZW50IGl0ZW0uXHJcblx0ICovXHJcblx0T3dsLnByb3RvdHlwZS5jdXJyZW50ID0gZnVuY3Rpb24ocG9zaXRpb24pIHtcclxuXHRcdGlmIChwb3NpdGlvbiA9PT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLl9jdXJyZW50O1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLm51bS5vSXRlbXMgPT09IDApIHtcclxuXHRcdFx0cmV0dXJuIHVuZGVmaW5lZDtcclxuXHRcdH1cclxuXHJcblx0XHRwb3NpdGlvbiA9IHRoaXMubm9ybWFsaXplKHBvc2l0aW9uKTtcclxuXHJcblx0XHRpZiAodGhpcy5fY3VycmVudCA9PT0gcG9zaXRpb24pIHtcclxuXHRcdFx0dGhpcy5hbmltYXRlKHRoaXMuY29vcmRpbmF0ZXModGhpcy5fY3VycmVudCkpO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dmFyIGV2ZW50ID0gdGhpcy50cmlnZ2VyKCdjaGFuZ2UnLCB7IHByb3BlcnR5OiB7IG5hbWU6ICdwb3NpdGlvbicsIHZhbHVlOiBwb3NpdGlvbiB9IH0pO1xyXG5cclxuXHRcdFx0aWYgKGV2ZW50LmRhdGEgIT09IHVuZGVmaW5lZCkge1xyXG5cdFx0XHRcdHBvc2l0aW9uID0gdGhpcy5ub3JtYWxpemUoZXZlbnQuZGF0YSk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHRoaXMuX2N1cnJlbnQgPSBwb3NpdGlvbjtcclxuXHJcblx0XHRcdHRoaXMuYW5pbWF0ZSh0aGlzLmNvb3JkaW5hdGVzKHRoaXMuX2N1cnJlbnQpKTtcclxuXHJcblx0XHRcdHRoaXMudXBkYXRlQWN0aXZlSXRlbXMoKTtcclxuXHJcblx0XHRcdHRoaXMudHJpZ2dlcignY2hhbmdlZCcsIHsgcHJvcGVydHk6IHsgbmFtZTogJ3Bvc2l0aW9uJywgdmFsdWU6IHRoaXMuX2N1cnJlbnQgfSB9KTtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gdGhpcy5fY3VycmVudDtcclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBSZXNldHMgdGhlIGFic29sdXRlIHBvc2l0aW9uIG9mIHRoZSBjdXJyZW50IGl0ZW0uXHJcblx0ICogQHB1YmxpY1xyXG5cdCAqIEBwYXJhbSB7TnVtYmVyfSBwb3NpdGlvbiAtIFRoZSBhYnNvbHV0ZSBwb3NpdGlvbiBvZiB0aGUgbmV3IGl0ZW0uXHJcblx0ICovXHJcblx0T3dsLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uKHBvc2l0aW9uKSB7XHJcblx0XHR0aGlzLnN1cHByZXNzKFsgJ2NoYW5nZScsICdjaGFuZ2VkJyBdKTtcclxuXHRcdHRoaXMuc3BlZWQoMCk7XHJcblx0XHR0aGlzLmN1cnJlbnQocG9zaXRpb24pO1xyXG5cdFx0dGhpcy5yZWxlYXNlKFsgJ2NoYW5nZScsICdjaGFuZ2VkJyBdKTtcclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBOb3JtYWxpemVzIGFuIGFic29sdXRlIHBvc2l0aW9uIGZvciBhbiBpdGVtLlxyXG5cdCAqIEBwdWJsaWNcclxuXHQgKiBAcGFyYW0ge051bWJlcn0gcG9zaXRpb24gLSBUaGUgYWJzb2x1dGUgcG9zaXRpb24gdG8gbm9ybWFsaXplLlxyXG5cdCAqIEBwYXJhbSB7Qm9vbGVhbn0gW3JlbGF0aXZlPWZhbHNlXSAtIFdoZXRoZXIgdG8gcmV0dXJuIGEgcmVsYXRpdmUgcG9zaXRpb24gb3Igbm90LlxyXG5cdCAqIEByZXR1cm4ge051bWJlcn0gLSBUaGUgbm9ybWFsaXplZCBwb3NpdGlvbi5cclxuXHQgKi9cclxuXHRPd2wucHJvdG90eXBlLm5vcm1hbGl6ZSA9IGZ1bmN0aW9uKHBvc2l0aW9uLCByZWxhdGl2ZSkge1xyXG5cdFx0aWYgKHBvc2l0aW9uID09PSB1bmRlZmluZWQgfHwgIXRoaXMuZG9tLiRpdGVtcykge1xyXG5cdFx0XHRyZXR1cm4gdW5kZWZpbmVkO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLnNldHRpbmdzLmxvb3ApIHtcclxuXHRcdFx0dmFyIG4gPSB0aGlzLmRvbS4kaXRlbXMubGVuZ3RoO1xyXG5cdFx0XHRwb3NpdGlvbiA9ICgocG9zaXRpb24gJSBuKSArIG4pICUgbjtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHBvc2l0aW9uID0gTWF0aC5tYXgodGhpcy5taW5pbXVtKCksIE1hdGgubWluKHRoaXMubWF4aW11bSgpLCBwb3NpdGlvbikpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiByZWxhdGl2ZSA/IHRoaXMuZG9tLiRpdGVtcy5lcShwb3NpdGlvbikuZGF0YSgnb3dsLWl0ZW0nKS5pbmRleCA6IHBvc2l0aW9uO1xyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIEdldHMgdGhlIGFic29sdXRlIG1heGltdW0gcG9zaXRpb24gZm9yIGFuIGl0ZW0uXHJcblx0ICogQHB1YmxpY1xyXG5cdCAqIEByZXR1cm5zIHtOdW1iZXJ9XHJcblx0ICovXHJcblx0T3dsLnByb3RvdHlwZS5tYXhpbXVtID0gZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgbWF4aW11bSwgd2lkdGgsXHJcblx0XHRcdHNldHRpbmdzID0gdGhpcy5zZXR0aW5ncztcclxuXHJcblx0XHRpZiAoIXNldHRpbmdzLmxvb3AgJiYgc2V0dGluZ3MuY2VudGVyKSB7XHJcblx0XHRcdG1heGltdW0gPSB0aGlzLm51bS5vSXRlbXMgLSAxO1xyXG5cdFx0fSBlbHNlIGlmICghc2V0dGluZ3MubG9vcCAmJiAhc2V0dGluZ3MuY2VudGVyKSB7XHJcblx0XHRcdG1heGltdW0gPSB0aGlzLm51bS5vSXRlbXMgLSBzZXR0aW5ncy5pdGVtcztcclxuXHRcdH0gZWxzZSBpZiAoc2V0dGluZ3MubG9vcCB8fCBzZXR0aW5ncy5jZW50ZXIpIHtcclxuXHRcdFx0bWF4aW11bSA9IHRoaXMubnVtLm9JdGVtcyArIHNldHRpbmdzLml0ZW1zO1xyXG5cdFx0fSBlbHNlIGlmIChzZXR0aW5ncy5hdXRvV2lkdGggfHwgc2V0dGluZ3MubWVyZ2UpIHtcclxuXHRcdFx0cmV2ZXJ0ID0gc2V0dGluZ3MucnRsID8gMSA6IC0xO1xyXG5cdFx0XHR3aWR0aCA9IHRoaXMuZG9tLiRzdGFnZS53aWR0aCgpIC0gdGhpcy4kZWwud2lkdGgoKTtcclxuXHRcdFx0JC5lYWNoKHRoaXMuY29vcmRpbmF0ZXMoKSwgZnVuY3Rpb24oaW5kZXgsIGNvb3JkaW5hdGUpIHtcclxuXHRcdFx0XHRpZiAoY29vcmRpbmF0ZSAqIHJldmVydCA+PSB3aWR0aCkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRtYXhpbXVtID0gaW5kZXggKyAxO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRocm93ICdDYW4gbm90IGRldGVjdCBtYXhpbXVtIGFic29sdXRlIHBvc2l0aW9uLidcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gbWF4aW11bTtcclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBHZXRzIHRoZSBhYnNvbHV0ZSBtaW5pbXVtIHBvc2l0aW9uIGZvciBhbiBpdGVtLlxyXG5cdCAqIEBwdWJsaWNcclxuXHQgKiBAcmV0dXJucyB7TnVtYmVyfVxyXG5cdCAqL1xyXG5cdE93bC5wcm90b3R5cGUubWluaW11bSA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuZG9tLiRvSXRlbXMuZXEoMCkuZGF0YSgnb3dsLWl0ZW0nKS5pbmRleEFicztcclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBTZXRzIHRoZSBjdXJyZW50IGFuaW1hdGlvbiBzcGVlZC5cclxuXHQgKiBAcHVibGljXHJcblx0ICogQHBhcmFtIHtOdW1iZXJ9IFtzcGVlZF0gLSBUaGUgYW5pbWF0aW9uIHNwZWVkIGluIG1pbGxpc2Vjb25kc29yIG5vdGhpbmcgdG8gbGVhdmUgaXQgdW5jaGFuZ2VkLlxyXG5cdCAqIEByZXR1cm5zIHtOdW1iZXJ9IC0gVGhlIGN1cnJlbnQgYW5pbWF0aW9uIHNwZWVkIGluIG1pbGxpc2Vjb25kcy5cclxuXHQgKi9cclxuXHRPd2wucHJvdG90eXBlLnNwZWVkID0gZnVuY3Rpb24oc3BlZWQpIHtcclxuXHRcdGlmIChzcGVlZCAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdHRoaXMuX3NwZWVkID0gc3BlZWQ7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXMuX3NwZWVkO1xyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIEdldHMgdGhlIGNvb3JkaW5hdGUgZm9yIGFuIGl0ZW0uXHJcblx0ICogQHB1YmxpY1xyXG5cdCAqIEBwYXJhbSB7TnVtYmVyfSBbcG9zaXRpb25dIC0gVGhlIGFic29sdXRlIHBvc2l0aW9uIG9mIHRoZSBpdGVtLlxyXG5cdCAqIEByZXR1cm5zIHtOdW1iZXJ8QXJyYXkuPE51bWJlcj59IC0gVGhlIGNvb3JkaW5hdGUgb2YgdGhlIGl0ZW0gaW4gcGl4ZWwgb3IgYWxsIGNvb3JkaW5hdGVzLlxyXG5cdCAqL1xyXG5cdE93bC5wcm90b3R5cGUuY29vcmRpbmF0ZXMgPSBmdW5jdGlvbihwb3NpdGlvbikge1xyXG5cdFx0cmV0dXJuIHBvc2l0aW9uICE9PSB1bmRlZmluZWQgPyB0aGlzLl9jb29yZGluYXRlc1twb3NpdGlvbl0gOiB0aGlzLl9jb29yZGluYXRlcztcclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBDYWxjdWxhdGVzIHRoZSBzcGVlZCBmb3IgYSB0cmFuc2xhdGlvbi5cclxuXHQgKiBAcHJvdGVjdGVkXHJcblx0ICogQHBhcmFtIHtOdW1iZXJ9IGZyb20gLSBUaGUgYWJzb2x1dGUgcG9zaXRpb24gb2YgdGhlIHN0YXJ0IGl0ZW0uXHJcblx0ICogQHBhcmFtIHtOdW1iZXJ9IHRvIC0gVGhlIGFic29sdXRlIHBvc2l0aW9uIG9mIHRoZSB0YXJnZXQgaXRlbS5cclxuXHQgKiBAcGFyYW0ge051bWJlcn0gW2ZhY3Rvcj11bmRlZmluZWRdIC0gVGhlIHRpbWUgZmFjdG9yIGluIG1pbGxpc2Vjb25kcy5cclxuXHQgKiBAcmV0dXJucyB7TnVtYmVyfSAtIFRoZSB0aW1lIGluIG1pbGxpc2Vjb25kcyBmb3IgdGhlIHRyYW5zbGF0aW9uLlxyXG5cdCAqL1xyXG5cdE93bC5wcm90b3R5cGUuZHVyYXRpb24gPSBmdW5jdGlvbihmcm9tLCB0bywgZmFjdG9yKSB7XHJcblx0XHRyZXR1cm4gTWF0aC5taW4oTWF0aC5tYXgoTWF0aC5hYnModG8gLSBmcm9tKSwgMSksIDYpICogTWF0aC5hYnMoKGZhY3RvciB8fCB0aGlzLnNldHRpbmdzLnNtYXJ0U3BlZWQpKTtcclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBTbGlkZXMgdG8gdGhlIHNwZWNpZmllZCBpdGVtLlxyXG5cdCAqIEBwdWJsaWNcclxuXHQgKiBAcGFyYW0ge051bWJlcn0gcG9zaXRpb24gLSBUaGUgcG9zaXRpb24gb2YgdGhlIGl0ZW0uXHJcblx0ICogQHBhcmFtIHtOdW1iZXJ9IFtzcGVlZF0gLSBUaGUgdGltZSBpbiBtaWxsaXNlY29uZHMgZm9yIHRoZSB0cmFuc2l0aW9uLlxyXG5cdCAqL1xyXG5cdE93bC5wcm90b3R5cGUudG8gPSBmdW5jdGlvbihwb3NpdGlvbiwgc3BlZWQpIHtcclxuXHRcdGlmICh0aGlzLnNldHRpbmdzLmxvb3ApIHtcclxuXHRcdFx0dmFyIGRpc3RhbmNlID0gcG9zaXRpb24gLSB0aGlzLm5vcm1hbGl6ZSh0aGlzLmN1cnJlbnQoKSwgdHJ1ZSksXHJcblx0XHRcdFx0cmV2ZXJ0ID0gdGhpcy5jdXJyZW50KCksXHJcblx0XHRcdFx0YmVmb3JlID0gdGhpcy5jdXJyZW50KCksXHJcblx0XHRcdFx0YWZ0ZXIgPSB0aGlzLmN1cnJlbnQoKSArIGRpc3RhbmNlLFxyXG5cdFx0XHRcdGRpcmVjdGlvbiA9IGJlZm9yZSAtIGFmdGVyIDwgMCA/IHRydWUgOiBmYWxzZTtcclxuXHJcblx0XHRcdGlmIChhZnRlciA8IHRoaXMuc2V0dGluZ3MuaXRlbXMgJiYgZGlyZWN0aW9uID09PSBmYWxzZSkge1xyXG5cdFx0XHRcdHJldmVydCA9IHRoaXMubnVtLml0ZW1zIC0gKHRoaXMuc2V0dGluZ3MuaXRlbXMgLSBiZWZvcmUpIC0gdGhpcy5zZXR0aW5ncy5pdGVtcztcclxuXHRcdFx0XHR0aGlzLnJlc2V0KHJldmVydCk7XHJcblx0XHRcdH0gZWxzZSBpZiAoYWZ0ZXIgPj0gdGhpcy5udW0uaXRlbXMgLSB0aGlzLnNldHRpbmdzLml0ZW1zICYmIGRpcmVjdGlvbiA9PT0gdHJ1ZSkge1xyXG5cdFx0XHRcdHJldmVydCA9IGJlZm9yZSAtIHRoaXMubnVtLm9JdGVtcztcclxuXHRcdFx0XHR0aGlzLnJlc2V0KHJldmVydCk7XHJcblx0XHRcdH1cclxuXHRcdFx0d2luZG93LmNsZWFyVGltZW91dCh0aGlzLmUuX2dvVG9Mb29wKTtcclxuXHRcdFx0dGhpcy5lLl9nb1RvTG9vcCA9IHdpbmRvdy5zZXRUaW1lb3V0KCQucHJveHkoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0dGhpcy5zcGVlZCh0aGlzLmR1cmF0aW9uKHRoaXMuY3VycmVudCgpLCByZXZlcnQgKyBkaXN0YW5jZSwgc3BlZWQpKTtcclxuXHRcdFx0XHR0aGlzLmN1cnJlbnQocmV2ZXJ0ICsgZGlzdGFuY2UpO1xyXG5cdFx0XHR9LCB0aGlzKSwgMzApO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGhpcy5zcGVlZCh0aGlzLmR1cmF0aW9uKHRoaXMuY3VycmVudCgpLCBwb3NpdGlvbiwgc3BlZWQpKTtcclxuXHRcdFx0dGhpcy5jdXJyZW50KHBvc2l0aW9uKTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBTbGlkZXMgdG8gdGhlIG5leHQgaXRlbS5cclxuXHQgKiBAcHVibGljXHJcblx0ICogQHBhcmFtIHtOdW1iZXJ9IFtzcGVlZF0gLSBUaGUgdGltZSBpbiBtaWxsaXNlY29uZHMgZm9yIHRoZSB0cmFuc2l0aW9uLlxyXG5cdCAqL1xyXG5cdE93bC5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uKHNwZWVkKSB7XHJcblx0XHRzcGVlZCA9IHNwZWVkIHx8IGZhbHNlO1xyXG5cdFx0dGhpcy50byh0aGlzLm5vcm1hbGl6ZSh0aGlzLmN1cnJlbnQoKSwgdHJ1ZSkgKyAxLCBzcGVlZCk7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogU2xpZGVzIHRvIHRoZSBwcmV2aW91cyBpdGVtLlxyXG5cdCAqIEBwdWJsaWNcclxuXHQgKiBAcGFyYW0ge051bWJlcn0gW3NwZWVkXSAtIFRoZSB0aW1lIGluIG1pbGxpc2Vjb25kcyBmb3IgdGhlIHRyYW5zaXRpb24uXHJcblx0ICovXHJcblx0T3dsLnByb3RvdHlwZS5wcmV2ID0gZnVuY3Rpb24oc3BlZWQpIHtcclxuXHRcdHNwZWVkID0gc3BlZWQgfHwgZmFsc2U7XHJcblx0XHR0aGlzLnRvKHRoaXMubm9ybWFsaXplKHRoaXMuY3VycmVudCgpLCB0cnVlKSAtIDEsIHNwZWVkKTtcclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBIYW5kbGVzIHRoZSBlbmQgb2YgYW4gYW5pbWF0aW9uLlxyXG5cdCAqIEBwcm90ZWN0ZWRcclxuXHQgKiBAcGFyYW0ge0V2ZW50fSBldmVudCAtIFRoZSBldmVudCBhcmd1bWVudHMuXHJcblx0ICovXHJcblx0T3dsLnByb3RvdHlwZS50cmFuc2l0aW9uRW5kID0gZnVuY3Rpb24oZXZlbnQpIHtcclxuXHJcblx0XHQvLyBpZiBjc3MyIGFuaW1hdGlvbiB0aGVuIGV2ZW50IG9iamVjdCBpcyB1bmRlZmluZWRcclxuXHRcdGlmIChldmVudCAhPT0gdW5kZWZpbmVkKSB7XHJcblx0XHRcdGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cclxuXHRcdFx0Ly8gQ2F0Y2ggb25seSBvd2wtc3RhZ2UgdHJhbnNpdGlvbkVuZCBldmVudFxyXG5cdFx0XHR2YXIgZXZlbnRUYXJnZXQgPSBldmVudC50YXJnZXQgfHwgZXZlbnQuc3JjRWxlbWVudCB8fCBldmVudC5vcmlnaW5hbFRhcmdldDtcclxuXHRcdFx0aWYgKGV2ZW50VGFyZ2V0ICE9PSB0aGlzLmRvbS5zdGFnZSkge1xyXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuc3RhdGUuaW5Nb3Rpb24gPSBmYWxzZTtcclxuXHRcdHRoaXMudHJpZ2dlcigndHJhbnNsYXRlZCcpO1xyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIENoZWNrcyBpZiBlbGVtZW50IHdpZHRoIGhhcyBjaGFuZ2VkXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqIEByZXR1cm5zIHtCb29lbGFufVxyXG5cdCAqL1xyXG5cdE93bC5wcm90b3R5cGUuaXNFbFdpZHRoQ2hhbmdlZCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIG5ld0VsV2lkdGggPSB0aGlzLmRvbS4kZWwud2lkdGgoKSAtIHRoaXMuc2V0dGluZ3Muc3RhZ2VQYWRkaW5nLCAvLyB0b1xyXG5cdFx0Ly8gY2hlY2tcclxuXHRcdHByZXZFbFdpZHRoID0gdGhpcy53aWR0aC5lbCArIHRoaXMuc2V0dGluZ3MubWFyZ2luO1xyXG5cdFx0cmV0dXJuIG5ld0VsV2lkdGggIT09IHByZXZFbFdpZHRoO1xyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIEdldHMgdmlld3BvcnQgd2lkdGguXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqIEByZXR1cm4ge051bWJlcn0gLSBUaGUgd2lkdGggaW4gcGl4ZWwuXHJcblx0ICovXHJcblx0T3dsLnByb3RvdHlwZS52aWV3cG9ydCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIHdpZHRoO1xyXG5cdFx0aWYgKHRoaXMub3B0aW9ucy5yZXNwb25zaXZlQmFzZUVsZW1lbnQgIT09IHdpbmRvdykge1xyXG5cdFx0XHR3aWR0aCA9ICQodGhpcy5vcHRpb25zLnJlc3BvbnNpdmVCYXNlRWxlbWVudCkud2lkdGgoKTtcclxuXHRcdH0gZWxzZSBpZiAod2luZG93LmlubmVyV2lkdGgpIHtcclxuXHRcdFx0d2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcclxuXHRcdH0gZWxzZSBpZiAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50ICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCkge1xyXG5cdFx0XHR3aWR0aCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aDtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRocm93ICdDYW4gbm90IGRldGVjdCB2aWV3cG9ydCB3aWR0aC4nO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHdpZHRoO1xyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIFJlcGxhY2VzIHRoZSBjdXJyZW50IGNvbnRlbnQuXHJcblx0ICogQHB1YmxpY1xyXG5cdCAqIEBwYXJhbSB7SFRNTEVsZW1lbnR8alF1ZXJ5fFN0cmluZ30gY29udGVudCAtIFRoZSBuZXcgY29udGVudC5cclxuXHQgKi9cclxuXHRPd2wucHJvdG90eXBlLmluc2VydENvbnRlbnQgPSBmdW5jdGlvbihjb250ZW50KSB7XHJcblx0XHR0aGlzLmRvbS4kc3RhZ2UuZW1wdHkoKTtcclxuXHRcdHRoaXMuZmV0Y2hDb250ZW50KGNvbnRlbnQpO1xyXG5cdFx0dGhpcy5yZWZyZXNoKCk7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogQWRkcyBhbiBpdGVtLlxyXG5cdCAqIEBwdWJsaWNcclxuXHQgKiBAcGFyYW0ge0hUTUxFbGVtZW50fGpRdWVyeXxTdHJpbmd9IGNvbnRlbnQgLSBUaGUgaXRlbSBjb250ZW50IHRvIGFkZC5cclxuXHQgKiBAcGFyYW0ge051bWJlcn0gW3Bvc2l0aW9uPTBdIC0gVGhlIHBvc2l0aW9uIGF0IHdoaWNoIHRvIGluc2VydCB0aGUgaXRlbS5cclxuXHQgKi9cclxuXHRPd2wucHJvdG90eXBlLmFkZEl0ZW0gPSBmdW5jdGlvbihjb250ZW50LCBwb3NpdGlvbikge1xyXG5cdFx0dmFyICRpdGVtID0gdGhpcy5jcmVhdGVJdGVtQ29udGFpbmVyKCk7XHJcblxyXG5cdFx0cG9zaXRpb24gPSBwb3NpdGlvbiB8fCAwO1xyXG5cdFx0Ly8gd3JhcCBjb250ZW50XHJcblx0XHR0aGlzLmluaXRpYWxpemVJdGVtQ29udGFpbmVyKCRpdGVtLCBjb250ZW50KTtcclxuXHRcdC8vIGlmIGNhcm91c2VsIGlzIGVtcHR5IHRoZW4gYXBwZW5kIGl0ZW1cclxuXHRcdGlmICh0aGlzLmRvbS4kb0l0ZW1zLmxlbmd0aCA9PT0gMCkge1xyXG5cdFx0XHR0aGlzLmRvbS4kc3RhZ2UuYXBwZW5kKCRpdGVtKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdC8vIGFwcGVuZCBpdGVtXHJcblx0XHRcdGlmIChwb3MgIT09IC0xKSB7XHJcblx0XHRcdFx0dGhpcy5kb20uJG9JdGVtcy5lcShwb3NpdGlvbikuYmVmb3JlKCRpdGVtKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHR0aGlzLmRvbS4kb0l0ZW1zLmVxKHBvc2l0aW9uKS5hZnRlcigkaXRlbSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdC8vIHVwZGF0ZSBhbmQgY2FsY3VsYXRlIGNhcm91c2VsXHJcblx0XHR0aGlzLnJlZnJlc2goKTtcclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBSZW1vdmVzIGFuIGl0ZW0uXHJcblx0ICogQHB1YmxpY1xyXG5cdCAqIEBwYXJhbSB7TnVtYmVyfSBwb3MgLSBUaGUgcG9zaXRpb24gb2YgdGhlIGl0ZW0uXHJcblx0ICovXHJcblx0T3dsLnByb3RvdHlwZS5yZW1vdmVJdGVtID0gZnVuY3Rpb24ocG9zKSB7XHJcblx0XHR0aGlzLmRvbS4kb0l0ZW1zLmVxKHBvcykucmVtb3ZlKCk7XHJcblx0XHR0aGlzLnJlZnJlc2goKTtcclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBBZGRzIHRyaWdnZXJhYmxlIGV2ZW50cy5cclxuXHQgKiBAcHJvdGVjdGVkXHJcblx0ICovXHJcblx0T3dsLnByb3RvdHlwZS5hZGRUcmlnZ2VyYWJsZUV2ZW50cyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIGhhbmRsZXIgPSAkLnByb3h5KGZ1bmN0aW9uKGNhbGxiYWNrLCBldmVudCkge1xyXG5cdFx0XHRyZXR1cm4gJC5wcm94eShmdW5jdGlvbihlKSB7XHJcblx0XHRcdFx0aWYgKGUucmVsYXRlZFRhcmdldCAhPT0gdGhpcykge1xyXG5cdFx0XHRcdFx0dGhpcy5zdXBwcmVzcyhbIGV2ZW50IF0pO1xyXG5cdFx0XHRcdFx0Y2FsbGJhY2suYXBwbHkodGhpcywgW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcclxuXHRcdFx0XHRcdHRoaXMucmVsZWFzZShbIGV2ZW50IF0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSwgdGhpcyk7XHJcblx0XHR9LCB0aGlzKTtcclxuXHJcblx0XHQkLmVhY2goe1xyXG5cdFx0XHQnbmV4dCc6IHRoaXMubmV4dCxcclxuXHRcdFx0J3ByZXYnOiB0aGlzLnByZXYsXHJcblx0XHRcdCd0byc6IHRoaXMudG8sXHJcblx0XHRcdCdkZXN0cm95JzogdGhpcy5kZXN0cm95LFxyXG5cdFx0XHQncmVmcmVzaCc6IHRoaXMucmVmcmVzaCxcclxuXHRcdFx0J3JlcGxhY2UnOiB0aGlzLmluc2VydENvbnRlbnQsXHJcblx0XHRcdCdhZGQnOiB0aGlzLmFkZEl0ZW0sXHJcblx0XHRcdCdyZW1vdmUnOiB0aGlzLnJlbW92ZUl0ZW1cclxuXHRcdH0sICQucHJveHkoZnVuY3Rpb24oZXZlbnQsIGNhbGxiYWNrKSB7XHJcblx0XHRcdHRoaXMuZG9tLiRlbC5vbihldmVudCArICcub3dsLmNhcm91c2VsJywgaGFuZGxlcihjYWxsYmFjaywgZXZlbnQgKyAnLm93bC5jYXJvdXNlbCcpKTtcclxuXHRcdH0sIHRoaXMpKTtcclxuXHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogV2F0Y2hlcyB0aGUgdmlzaWJpbGl0eSBvZiB0aGUgY2Fyb3VzZWwgZWxlbWVudC5cclxuXHQgKiBAcHJvdGVjdGVkXHJcblx0ICovXHJcblx0T3dsLnByb3RvdHlwZS53YXRjaFZpc2liaWxpdHkgPSBmdW5jdGlvbigpIHtcclxuXHJcblx0XHQvLyB0ZXN0IG9uIHplcHRvXHJcblx0XHRpZiAoIWlzRWxWaXNpYmxlKHRoaXMuZG9tLmVsKSkge1xyXG5cdFx0XHR0aGlzLmRvbS4kZWwuYWRkQ2xhc3MoJ293bC1oaWRkZW4nKTtcclxuXHRcdFx0d2luZG93LmNsZWFySW50ZXJ2YWwodGhpcy5lLl9jaGVja1Zpc2liaWxlKTtcclxuXHRcdFx0dGhpcy5lLl9jaGVja1Zpc2liaWxlID0gd2luZG93LnNldEludGVydmFsKCQucHJveHkoY2hlY2tWaXNpYmxlLCB0aGlzKSwgNTAwKTtcclxuXHRcdH1cclxuXHJcblx0XHRmdW5jdGlvbiBpc0VsVmlzaWJsZShlbCkge1xyXG5cdFx0XHRyZXR1cm4gZWwub2Zmc2V0V2lkdGggPiAwICYmIGVsLm9mZnNldEhlaWdodCA+IDA7XHJcblx0XHR9XHJcblxyXG5cdFx0ZnVuY3Rpb24gY2hlY2tWaXNpYmxlKCkge1xyXG5cdFx0XHRpZiAoaXNFbFZpc2libGUodGhpcy5kb20uZWwpKSB7XHJcblx0XHRcdFx0dGhpcy5kb20uJGVsLnJlbW92ZUNsYXNzKCdvd2wtaGlkZGVuJyk7XHJcblx0XHRcdFx0dGhpcy5yZWZyZXNoKCk7XHJcblx0XHRcdFx0d2luZG93LmNsZWFySW50ZXJ2YWwodGhpcy5lLl9jaGVja1Zpc2liaWxlKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIFByZWxvYWRzIGltYWdlcyB3aXRoIGF1dG8gd2lkdGguXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqIEB0b2RvIFN0aWxsIHRvIHRlc3RcclxuXHQgKi9cclxuXHRPd2wucHJvdG90eXBlLnByZWxvYWRBdXRvV2lkdGhJbWFnZXMgPSBmdW5jdGlvbihpbWdzKSB7XHJcblx0XHR2YXIgbG9hZGVkLCB0aGF0LCAkZWwsIGltZztcclxuXHJcblx0XHRsb2FkZWQgPSAwO1xyXG5cdFx0dGhhdCA9IHRoaXM7XHJcblx0XHRpbWdzLmVhY2goZnVuY3Rpb24oaSwgZWwpIHtcclxuXHRcdFx0JGVsID0gJChlbCk7XHJcblx0XHRcdGltZyA9IG5ldyBJbWFnZSgpO1xyXG5cclxuXHRcdFx0aW1nLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdGxvYWRlZCsrO1xyXG5cdFx0XHRcdCRlbC5hdHRyKCdzcmMnLCBpbWcuc3JjKTtcclxuXHRcdFx0XHQkZWwuY3NzKCdvcGFjaXR5JywgMSk7XHJcblx0XHRcdFx0aWYgKGxvYWRlZCA+PSBpbWdzLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0dGhhdC5zdGF0ZS5pbWFnZXNMb2FkZWQgPSB0cnVlO1xyXG5cdFx0XHRcdFx0dGhhdC5pbml0KCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9O1xyXG5cclxuXHRcdFx0aW1nLnNyYyA9ICRlbC5hdHRyKCdzcmMnKSB8fCAkZWwuYXR0cignZGF0YS1zcmMnKSB8fCAkZWwuYXR0cignZGF0YS1zcmMtcmV0aW5hJyk7XHJcblx0XHR9KTtcclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBEZXN0cm95cyB0aGUgY2Fyb3VzZWwuXHJcblx0ICogQHB1YmxpY1xyXG5cdCAqL1xyXG5cdE93bC5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKCkge1xyXG5cclxuXHRcdGlmICh0aGlzLmRvbS4kZWwuaGFzQ2xhc3ModGhpcy5zZXR0aW5ncy50aGVtZUNsYXNzKSkge1xyXG5cdFx0XHR0aGlzLmRvbS4kZWwucmVtb3ZlQ2xhc3ModGhpcy5zZXR0aW5ncy50aGVtZUNsYXNzKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5yZXNwb25zaXZlICE9PSBmYWxzZSkge1xyXG5cdFx0XHR0aGlzLm9mZih3aW5kb3csICdyZXNpemUnLCB0aGlzLmUuX3Jlc2l6ZXIpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLnRyYW5zaXRpb25FbmRWZW5kb3IpIHtcclxuXHRcdFx0dGhpcy5vZmYodGhpcy5kb20uc3RhZ2UsIHRoaXMudHJhbnNpdGlvbkVuZFZlbmRvciwgdGhpcy5lLl90cmFuc2l0aW9uRW5kKTtcclxuXHRcdH1cclxuXHJcblx0XHRmb3IgKCB2YXIgaSBpbiB0aGlzLnBsdWdpbnMpIHtcclxuXHRcdFx0dGhpcy5wbHVnaW5zW2ldLmRlc3Ryb3koKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5tb3VzZURyYWcgfHwgdGhpcy5zZXR0aW5ncy50b3VjaERyYWcpIHtcclxuXHRcdFx0dGhpcy5vZmYodGhpcy5kb20uc3RhZ2UsIHRoaXMuZHJhZ1R5cGVbMF0sIHRoaXMuZS5fb25EcmFnU3RhcnQpO1xyXG5cdFx0XHRpZiAodGhpcy5zZXR0aW5ncy5tb3VzZURyYWcpIHtcclxuXHRcdFx0XHR0aGlzLm9mZihkb2N1bWVudCwgdGhpcy5kcmFnVHlwZVszXSwgdGhpcy5lLl9vbkRyYWdTdGFydCk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MubW91c2VEcmFnKSB7XHJcblx0XHRcdFx0dGhpcy5kb20uJHN0YWdlLm9mZignZHJhZ3N0YXJ0JywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0dGhpcy5kb20uc3RhZ2Uub25zZWxlY3RzdGFydCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdH07XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvLyBSZW1vdmUgZXZlbnQgaGFuZGxlcnMgaW4gdGhlIFwiLm93bC5jYXJvdXNlbFwiIG5hbWVzcGFjZVxyXG5cdFx0dGhpcy5kb20uJGVsLm9mZignLm93bCcpO1xyXG5cclxuXHRcdGlmICh0aGlzLmRvbS4kY0l0ZW1zICE9PSBudWxsKSB7XHJcblx0XHRcdHRoaXMuZG9tLiRjSXRlbXMucmVtb3ZlKCk7XHJcblx0XHR9XHJcblx0XHR0aGlzLmUgPSBudWxsO1xyXG5cdFx0dGhpcy5kb20uJGVsLmRhdGEoJ293bENhcm91c2VsJywgbnVsbCk7XHJcblx0XHRkZWxldGUgdGhpcy5kb20uZWwub3dsQ2Fyb3VzZWw7XHJcblxyXG5cdFx0dGhpcy5kb20uJHN0YWdlLnVud3JhcCgpO1xyXG5cdFx0dGhpcy5kb20uJGl0ZW1zLnVud3JhcCgpO1xyXG5cdFx0dGhpcy5kb20uJGl0ZW1zLmNvbnRlbnRzKCkudW53cmFwKCk7XHJcblx0XHR0aGlzLmRvbSA9IG51bGw7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogT3BlcmF0b3JzIHRvIGNhbGN1bGF0ZSByaWdodC10by1sZWZ0IGFuZCBsZWZ0LXRvLXJpZ2h0LlxyXG5cdCAqIEBwcm90ZWN0ZWRcclxuXHQgKiBAcGFyYW0ge051bWJlcn0gW2FdIC0gVGhlIGxlZnQgc2lkZSBvcGVyYW5kLlxyXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBbb10gLSBUaGUgb3BlcmF0b3IuXHJcblx0ICogQHBhcmFtIHtOdW1iZXJ9IFtiXSAtIFRoZSByaWdodCBzaWRlIG9wZXJhbmQuXHJcblx0ICovXHJcblx0T3dsLnByb3RvdHlwZS5vcCA9IGZ1bmN0aW9uKGEsIG8sIGIpIHtcclxuXHRcdHZhciBydGwgPSB0aGlzLnNldHRpbmdzLnJ0bDtcclxuXHRcdHN3aXRjaCAobykge1xyXG5cdFx0Y2FzZSAnPCc6XHJcblx0XHRcdHJldHVybiBydGwgPyBhID4gYiA6IGEgPCBiO1xyXG5cdFx0Y2FzZSAnPic6XHJcblx0XHRcdHJldHVybiBydGwgPyBhIDwgYiA6IGEgPiBiO1xyXG5cdFx0Y2FzZSAnPj0nOlxyXG5cdFx0XHRyZXR1cm4gcnRsID8gYSA8PSBiIDogYSA+PSBiO1xyXG5cdFx0Y2FzZSAnPD0nOlxyXG5cdFx0XHRyZXR1cm4gcnRsID8gYSA+PSBiIDogYSA8PSBiO1xyXG5cdFx0ZGVmYXVsdDpcclxuXHRcdFx0YnJlYWs7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogQXR0YWNoZXMgdG8gYW4gaW50ZXJuYWwgZXZlbnQuXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsZW1lbnQgLSBUaGUgZXZlbnQgc291cmNlLlxyXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBldmVudCAtIFRoZSBldmVudCBuYW1lLlxyXG5cdCAqIEBwYXJhbSB7RnVuY3Rpb259IGxpc3RlbmVyIC0gVGhlIGV2ZW50IGhhbmRsZXIgdG8gYXR0YWNoLlxyXG5cdCAqIEBwYXJhbSB7Qm9vbGVhbn0gY2FwdHVyZSAtIFdldGhlciB0aGUgZXZlbnQgc2hvdWxkIGJlIGhhbmRsZWQgYXQgdGhlIGNhcHR1cmluZyBwaGFzZSBvciBub3QuXHJcblx0ICovXHJcblx0T3dsLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uKGVsZW1lbnQsIGV2ZW50LCBsaXN0ZW5lciwgY2FwdHVyZSkge1xyXG5cdFx0aWYgKGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcikge1xyXG5cdFx0XHRlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGxpc3RlbmVyLCBjYXB0dXJlKTtcclxuXHRcdH0gZWxzZSBpZiAoZWxlbWVudC5hdHRhY2hFdmVudCkge1xyXG5cdFx0XHRlbGVtZW50LmF0dGFjaEV2ZW50KCdvbicgKyBldmVudCwgbGlzdGVuZXIpO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIERldGFjaGVzIGZyb20gYW4gaW50ZXJuYWwgZXZlbnQuXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsZW1lbnQgLSBUaGUgZXZlbnQgc291cmNlLlxyXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBldmVudCAtIFRoZSBldmVudCBuYW1lLlxyXG5cdCAqIEBwYXJhbSB7RnVuY3Rpb259IGxpc3RlbmVyIC0gVGhlIGF0dGFjaGVkIGV2ZW50IGhhbmRsZXIgdG8gZGV0YWNoLlxyXG5cdCAqIEBwYXJhbSB7Qm9vbGVhbn0gY2FwdHVyZSAtIFdldGhlciB0aGUgYXR0YWNoZWQgZXZlbnQgaGFuZGxlciB3YXMgcmVnaXN0ZXJlZCBhcyBhIGNhcHR1cmluZyBsaXN0ZW5lciBvciBub3QuXHJcblx0ICovXHJcblx0T3dsLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbihlbGVtZW50LCBldmVudCwgbGlzdGVuZXIsIGNhcHR1cmUpIHtcclxuXHRcdGlmIChlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIpIHtcclxuXHRcdFx0ZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBsaXN0ZW5lciwgY2FwdHVyZSk7XHJcblx0XHR9IGVsc2UgaWYgKGVsZW1lbnQuZGV0YWNoRXZlbnQpIHtcclxuXHRcdFx0ZWxlbWVudC5kZXRhY2hFdmVudCgnb24nICsgZXZlbnQsIGxpc3RlbmVyKTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBUcmlnZ2VycyBhbiBwdWJsaWMgZXZlbnQuXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIC0gVGhlIGV2ZW50IG5hbWUuXHJcblx0ICogQHBhcmFtIHsqfSBbZGF0YT1udWxsXSAtIFRoZSBldmVudCBkYXRhLlxyXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBbbmFtZXNwYWNlPS5vd2wuY2Fyb3VzZWxdIC0gVGhlIGV2ZW50IG5hbWVzcGFjZS5cclxuXHQgKiBAcmV0dXJucyB7RXZlbnR9IC0gVGhlIGV2ZW50IGFyZ3VtZW50cy5cclxuXHQgKi9cclxuXHRPd2wucHJvdG90eXBlLnRyaWdnZXIgPSBmdW5jdGlvbihuYW1lLCBkYXRhLCBuYW1lc3BhY2UpIHtcclxuXHRcdHZhciBzdGF0dXMgPSB7XHJcblx0XHRcdGl0ZW06IHsgY291bnQ6IHRoaXMubnVtLm9JdGVtcywgaW5kZXg6IHRoaXMuY3VycmVudCgpIH1cclxuXHRcdH0sIGhhbmRsZXIgPSAkLmNhbWVsQ2FzZShcclxuXHRcdFx0JC5ncmVwKFsgJ29uJywgbmFtZSwgbmFtZXNwYWNlIF0sIGZ1bmN0aW9uKHYpIHsgcmV0dXJuIHYgfSlcclxuXHRcdFx0XHQuam9pbignLScpLnRvTG93ZXJDYXNlKClcclxuXHRcdCksIGV2ZW50ID0gJC5FdmVudChcclxuXHRcdFx0WyBuYW1lLCAnb3dsJywgbmFtZXNwYWNlIHx8ICdjYXJvdXNlbCcgXS5qb2luKCcuJykudG9Mb3dlckNhc2UoKSxcclxuXHRcdFx0JC5leHRlbmQoeyByZWxhdGVkVGFyZ2V0OiB0aGlzIH0sIHN0YXR1cywgZGF0YSlcclxuXHRcdCk7XHJcblxyXG5cdFx0aWYgKCF0aGlzLl9zdXByZXNzW2V2ZW50LnR5cGVdKSB7XHJcblx0XHRcdCQuZWFjaCh0aGlzLnBsdWdpbnMsIGZ1bmN0aW9uKG5hbWUsIHBsdWdpbikge1xyXG5cdFx0XHRcdGlmIChwbHVnaW4ub25UcmlnZ2VyKSB7XHJcblx0XHRcdFx0XHRwbHVnaW4ub25UcmlnZ2VyKGV2ZW50KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0dGhpcy5kb20uJGVsLnRyaWdnZXIoZXZlbnQpO1xyXG5cclxuXHRcdFx0aWYgKHR5cGVvZiB0aGlzLnNldHRpbmdzW2hhbmRsZXJdID09PSAnZnVuY3Rpb24nKSB7XHJcblx0XHRcdFx0dGhpcy5zZXR0aW5nc1toYW5kbGVyXS5hcHBseSh0aGlzLCBldmVudCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gZXZlbnQ7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogU3VwcHJlc3NlcyBldmVudHMuXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqIEBwYXJhbSB7QXJyYXkuPFN0cmluZz59IGV2ZW50cyAtIFRoZSBldmVudHMgdG8gc3VwcHJlc3MuXHJcblx0ICovXHJcblx0T3dsLnByb3RvdHlwZS5zdXBwcmVzcyA9IGZ1bmN0aW9uKGV2ZW50cykge1xyXG5cdFx0JC5lYWNoKGV2ZW50cywgJC5wcm94eShmdW5jdGlvbihpbmRleCwgZXZlbnQpIHtcclxuXHRcdFx0dGhpcy5fc3VwcmVzc1tldmVudF0gPSB0cnVlO1xyXG5cdFx0fSwgdGhpcykpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogUmVsZWFzZXMgc3VwcHJlc3NlZCBldmVudHMuXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqIEBwYXJhbSB7QXJyYXkuPFN0cmluZz59IGV2ZW50cyAtIFRoZSBldmVudHMgdG8gcmVsZWFzZS5cclxuXHQgKi9cclxuXHRPd2wucHJvdG90eXBlLnJlbGVhc2UgPSBmdW5jdGlvbihldmVudHMpIHtcclxuXHRcdCQuZWFjaChldmVudHMsICQucHJveHkoZnVuY3Rpb24oaW5kZXgsIGV2ZW50KSB7XHJcblx0XHRcdGRlbGV0ZSB0aGlzLl9zdXByZXNzW2V2ZW50XTtcclxuXHRcdH0sIHRoaXMpKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIENoZWNrcyB0aGUgYXZhaWxhYmlsaXR5IG9mIHNvbWUgYnJvd3NlciBmZWF0dXJlcy5cclxuXHQgKiBAcHJvdGVjdGVkXHJcblx0ICovXHJcblx0T3dsLnByb3RvdHlwZS5icm93c2VyU3VwcG9ydCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dGhpcy5zdXBwb3J0M2QgPSBpc1BlcnNwZWN0aXZlKCk7XHJcblxyXG5cdFx0aWYgKHRoaXMuc3VwcG9ydDNkKSB7XHJcblx0XHRcdHRoaXMudHJhbnNmb3JtVmVuZG9yID0gaXNUcmFuc2Zvcm0oKTtcclxuXHJcblx0XHRcdC8vIHRha2UgdHJhbnNpdGlvbmVuZCBldmVudCBuYW1lIGJ5IGRldGVjdGluZyB0cmFuc2l0aW9uXHJcblx0XHRcdHZhciBlbmRWZW5kb3JzID0gWyAndHJhbnNpdGlvbmVuZCcsICd3ZWJraXRUcmFuc2l0aW9uRW5kJywgJ3RyYW5zaXRpb25lbmQnLCAnb1RyYW5zaXRpb25FbmQnIF07XHJcblx0XHRcdHRoaXMudHJhbnNpdGlvbkVuZFZlbmRvciA9IGVuZFZlbmRvcnNbaXNUcmFuc2l0aW9uKCldO1xyXG5cclxuXHRcdFx0Ly8gdGFrZSB2ZW5kb3IgbmFtZSBmcm9tIHRyYW5zZm9ybSBuYW1lXHJcblx0XHRcdHRoaXMudmVuZG9yTmFtZSA9IHRoaXMudHJhbnNmb3JtVmVuZG9yLnJlcGxhY2UoL1RyYW5zZm9ybS9pLCAnJyk7XHJcblx0XHRcdHRoaXMudmVuZG9yTmFtZSA9IHRoaXMudmVuZG9yTmFtZSAhPT0gJycgPyAnLScgKyB0aGlzLnZlbmRvck5hbWUudG9Mb3dlckNhc2UoKSArICctJyA6ICcnO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuc3RhdGUub3JpZW50YXRpb24gPSB3aW5kb3cub3JpZW50YXRpb247XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogQ2hlY2tzIGZvciBDU1Mgc3VwcG9ydC5cclxuXHQgKiBAcHJpdmF0ZVxyXG5cdCAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IC0gVGhlIENTUyBwcm9wZXJ0aWVzIHRvIGNoZWNrIGZvci5cclxuXHQgKiBAcmV0dXJucyB7QXJyYXl9IC0gQ29udGFpbnMgdGhlIHN1cHBvcnRlZCBDU1MgcHJvcGVydHkgbmFtZSBhbmQgaXRzIGluZGV4IG9yIGBmYWxzZWAuXHJcblx0ICovXHJcblx0ZnVuY3Rpb24gaXNTdHlsZVN1cHBvcnRlZChhcnJheSkge1xyXG5cdFx0dmFyIHAsIHMsIGZha2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSwgbGlzdCA9IGFycmF5O1xyXG5cdFx0Zm9yIChwIGluIGxpc3QpIHtcclxuXHRcdFx0cyA9IGxpc3RbcF07XHJcblx0XHRcdGlmICh0eXBlb2YgZmFrZS5zdHlsZVtzXSAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuXHRcdFx0XHRmYWtlID0gbnVsbDtcclxuXHRcdFx0XHRyZXR1cm4gWyBzLCBwIF07XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiBbIGZhbHNlIF07XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBDaGVja3MgZm9yIENTUyB0cmFuc2l0aW9uIHN1cHBvcnQuXHJcblx0ICogQHByaXZhdGVcclxuXHQgKiBAdG9kbyBSZWFseSBiYWQgZGVzaWduXHJcblx0ICogQHJldHVybnMge051bWJlcn1cclxuXHQgKi9cclxuXHRmdW5jdGlvbiBpc1RyYW5zaXRpb24oKSB7XHJcblx0XHRyZXR1cm4gaXNTdHlsZVN1cHBvcnRlZChbICd0cmFuc2l0aW9uJywgJ1dlYmtpdFRyYW5zaXRpb24nLCAnTW96VHJhbnNpdGlvbicsICdPVHJhbnNpdGlvbicgXSlbMV07XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBDaGVja3MgZm9yIENTUyB0cmFuc2Zvcm0gc3VwcG9ydC5cclxuXHQgKiBAcHJpdmF0ZVxyXG5cdCAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSBzdXBwb3J0ZWQgcHJvcGVydHkgbmFtZSBvciBmYWxzZS5cclxuXHQgKi9cclxuXHRmdW5jdGlvbiBpc1RyYW5zZm9ybSgpIHtcclxuXHRcdHJldHVybiBpc1N0eWxlU3VwcG9ydGVkKFsgJ3RyYW5zZm9ybScsICdXZWJraXRUcmFuc2Zvcm0nLCAnTW96VHJhbnNmb3JtJywgJ09UcmFuc2Zvcm0nLCAnbXNUcmFuc2Zvcm0nIF0pWzBdO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQ2hlY2tzIGZvciBDU1MgcGVyc3BlY3RpdmUgc3VwcG9ydC5cclxuXHQgKiBAcHJpdmF0ZVxyXG5cdCAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSBzdXBwb3J0ZWQgcHJvcGVydHkgbmFtZSBvciBmYWxzZS5cclxuXHQgKi9cclxuXHRmdW5jdGlvbiBpc1BlcnNwZWN0aXZlKCkge1xyXG5cdFx0cmV0dXJuIGlzU3R5bGVTdXBwb3J0ZWQoWyAncGVyc3BlY3RpdmUnLCAnd2Via2l0UGVyc3BlY3RpdmUnLCAnTW96UGVyc3BlY3RpdmUnLCAnT1BlcnNwZWN0aXZlJywgJ01zUGVyc3BlY3RpdmUnIF0pWzBdO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQ2hlY2tzIHdldGhlciB0b3VjaCBpcyBzdXBwb3J0ZWQgb3Igbm90LlxyXG5cdCAqIEBwcml2YXRlXHJcblx0ICogQHJldHVybnMge0Jvb2xlYW59XHJcblx0ICovXHJcblx0ZnVuY3Rpb24gaXNUb3VjaFN1cHBvcnQoKSB7XHJcblx0XHRyZXR1cm4gJ29udG91Y2hzdGFydCcgaW4gd2luZG93IHx8ICEhKG5hdmlnYXRvci5tc01heFRvdWNoUG9pbnRzKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIENoZWNrcyB3ZXRoZXIgdG91Y2ggaXMgc3VwcG9ydGVkIG9yIG5vdCBmb3IgSUUuXHJcblx0ICogQHByaXZhdGVcclxuXHQgKiBAcmV0dXJucyB7Qm9vbGVhbn1cclxuXHQgKi9cclxuXHRmdW5jdGlvbiBpc1RvdWNoU3VwcG9ydElFKCkge1xyXG5cdFx0cmV0dXJuIHdpbmRvdy5uYXZpZ2F0b3IubXNQb2ludGVyRW5hYmxlZDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFRoZSBqUXVlcnkgUGx1Z2luIGZvciB0aGUgT3dsIENhcm91c2VsXHJcblx0ICogQHB1YmxpY1xyXG5cdCAqL1xyXG5cdCQuZm4ub3dsQ2Fyb3VzZWwgPSBmdW5jdGlvbihvcHRpb25zKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpZiAoISQodGhpcykuZGF0YSgnb3dsQ2Fyb3VzZWwnKSkge1xyXG5cdFx0XHRcdCQodGhpcykuZGF0YSgnb3dsQ2Fyb3VzZWwnLCBuZXcgT3dsKHRoaXMsIG9wdGlvbnMpKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogVGhlIGNvbnN0cnVjdG9yIGZvciB0aGUgalF1ZXJ5IFBsdWdpblxyXG5cdCAqIEBwdWJsaWNcclxuXHQgKi9cclxuXHQkLmZuLm93bENhcm91c2VsLkNvbnN0cnVjdG9yID0gT3dsO1xyXG5cclxufSkod2luZG93LlplcHRvIHx8IHdpbmRvdy5qUXVlcnksIHdpbmRvdywgZG9jdW1lbnQpO1xyXG5cclxuLyoqXHJcbiAqIExhenlMb2FkIFBsdWdpblxyXG4gKiBAdmVyc2lvbiAyLjAuMFxyXG4gKiBAYXV0aG9yIEJhcnRvc3ogV29qY2llY2hvd3NraVxyXG4gKiBAbGljZW5zZSBUaGUgTUlUIExpY2Vuc2UgKE1JVClcclxuICovXHJcbjsoZnVuY3Rpb24oJCwgd2luZG93LCBkb2N1bWVudCwgdW5kZWZpbmVkKSB7XHJcblxyXG5cdC8qKlxyXG5cdCAqIENyZWF0ZXMgdGhlIGxhenkgbG9hZCBwbHVnaW4uXHJcblx0ICogQGNsYXNzIFRoZSBMYXp5IExvYWQgUGx1Z2luXHJcblx0ICogQHBhcmFtIHtPd2x9IHNjb3BlIC0gVGhlIE93bCBDYXJvdXNlbFxyXG5cdCAqL1xyXG5cdExhenlMb2FkID0gZnVuY3Rpb24oc2NvcGUpIHtcclxuXHRcdHRoaXMub3dsID0gc2NvcGU7XHJcblx0XHR0aGlzLm93bC5vcHRpb25zID0gJC5leHRlbmQoe30sIExhenlMb2FkLkRlZmF1bHRzLCB0aGlzLm93bC5vcHRpb25zKTtcclxuXHJcblx0XHR0aGlzLmhhbmRsZXJzID0ge1xyXG5cdFx0XHQnY2hhbmdlZC5vd2wuY2Fyb3VzZWwnOiAkLnByb3h5KGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0XHRpZiAoZS5wcm9wZXJ0eS5uYW1lID09ICdpdGVtcycgJiYgZS5wcm9wZXJ0eS52YWx1ZSAmJiAhZS5wcm9wZXJ0eS52YWx1ZS5pcygnOmVtcHR5JykpIHtcclxuXHRcdFx0XHRcdHRoaXMuY2hlY2soKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sIHRoaXMpXHJcblx0XHR9O1xyXG5cclxuXHRcdHRoaXMub3dsLmRvbS4kZWwub24odGhpcy5oYW5kbGVycyk7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogRGVmYXVsdCBvcHRpb25zLlxyXG5cdCAqIEBwdWJsaWNcclxuXHQgKi9cclxuXHRMYXp5TG9hZC5EZWZhdWx0cyA9IHtcclxuXHRcdGxhenlMb2FkOiBmYWxzZVxyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIENoZWNrcyBhbGwgaXRlbXMgYW5kIGlmIG5lY2Vzc2FyeSwgY2FsbHMgYHByZWxvYWRgLlxyXG5cdCAqIEBwcm90ZWN0ZWRcclxuXHQgKi9cclxuXHRMYXp5TG9hZC5wcm90b3R5cGUuY2hlY2sgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBhdHRyID0gd2luZG93LmRldmljZVBpeGVsUmF0aW8gPiAxID8gJ2RhdGEtc3JjLXJldGluYScgOiAnZGF0YS1zcmMnLFxyXG5cdFx0XHRzcmMsIGltZywgaSwgJGl0ZW07XHJcblxyXG5cdFx0Zm9yIChpID0gMDsgaSA8IHRoaXMub3dsLm51bS5pdGVtczsgaSsrKSB7XHJcblx0XHRcdCRpdGVtID0gdGhpcy5vd2wuZG9tLiRpdGVtcy5lcShpKTtcclxuXHJcblx0XHRcdGlmICgkaXRlbS5kYXRhKCdvd2wtaXRlbScpLmN1cnJlbnQgPT09IHRydWUgJiYgJGl0ZW0uZGF0YSgnb3dsLWl0ZW0nKS5sb2FkZWQgPT09IGZhbHNlKSB7XHJcblx0XHRcdFx0aW1nID0gJGl0ZW0uZmluZCgnLm93bC1sYXp5Jyk7XHJcblx0XHRcdFx0c3JjID0gaW1nLmF0dHIoYXR0cik7XHJcblx0XHRcdFx0c3JjID0gc3JjIHx8IGltZy5hdHRyKCdkYXRhLXNyYycpO1xyXG5cdFx0XHRcdGlmIChzcmMpIHtcclxuXHRcdFx0XHRcdGltZy5jc3MoJ29wYWNpdHknLCAnMCcpO1xyXG5cdFx0XHRcdFx0dGhpcy5wcmVsb2FkKGltZywgJGl0ZW0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIFByZWxvYWRzIHRoZSBpbWFnZXMgb2YgYW4gaXRlbS5cclxuXHQgKiBAcHJvdGVjdGVkXHJcblx0ICogQHBhcmFtIHtqUXVlcnl9IGltYWdlcyAtIFRoZSBpbWFnZXMgdG8gbG9hZC5cclxuXHQgKiBAcGFyYW0ge2pRdWVyeX0gJGl0ZW0gLSBUaGUgaXRlbSBmb3Igd2hpY2ggdGhlIGltYWdlcyBhcmUgbG9hZGVkLlxyXG5cdCAqL1xyXG5cdExhenlMb2FkLnByb3RvdHlwZS5wcmVsb2FkID0gZnVuY3Rpb24oaW1hZ2VzLCAkaXRlbSkge1xyXG5cdFx0dmFyICRlbCwgaW1nLCBzcmNUeXBlO1xyXG5cclxuXHRcdGltYWdlcy5lYWNoKCQucHJveHkoZnVuY3Rpb24oaSwgZWwpIHtcclxuXHJcblx0XHRcdHRoaXMub3dsLnRyaWdnZXIoJ2xvYWQnLCBudWxsLCAnbGF6eScpO1xyXG5cclxuXHRcdFx0JGVsID0gJChlbCk7XHJcblx0XHRcdGltZyA9IG5ldyBJbWFnZSgpO1xyXG5cdFx0XHRzcmNUeXBlID0gd2luZG93LmRldmljZVBpeGVsUmF0aW8gPiAxID8gJGVsLmF0dHIoJ2RhdGEtc3JjLXJldGluYScpIDogJGVsLmF0dHIoJ2RhdGEtc3JjJyk7XHJcblx0XHRcdHNyY1R5cGUgPSBzcmNUeXBlIHx8ICRlbC5hdHRyKCdkYXRhLXNyYycpO1xyXG5cclxuXHRcdFx0aW1nLm9ubG9hZCA9ICQucHJveHkoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0JGl0ZW0uZGF0YSgnb3dsLWl0ZW0nKS5sb2FkZWQgPSB0cnVlO1xyXG5cdFx0XHRcdGlmICgkZWwuaXMoJ2ltZycpKSB7XHJcblx0XHRcdFx0XHQkZWwuYXR0cignc3JjJywgaW1nLnNyYyk7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdCRlbC5jc3MoJ2JhY2tncm91bmQtaW1hZ2UnLCAndXJsKCcgKyBpbWcuc3JjICsgJyknKTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdCRlbC5jc3MoJ29wYWNpdHknLCAxKTtcclxuXHRcdFx0XHR0aGlzLm93bC50cmlnZ2VyKCdsb2FkZWQnLCBudWxsLCAnbGF6eScpO1xyXG5cdFx0XHR9LCB0aGlzKTtcclxuXHRcdFx0aW1nLnNyYyA9IHNyY1R5cGU7XHJcblx0XHR9LCB0aGlzKSk7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogRGVzdHJveXMgdGhlIHBsdWdpbi5cclxuXHQgKiBAcHVibGljXHJcblx0ICovXHJcblx0TGF6eUxvYWQucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBoYW5kbGVyLCBwcm9wZXJ0eTtcclxuXHJcblx0XHRmb3IgKGhhbmRsZXIgaW4gdGhpcy5oYW5kbGVycykge1xyXG5cdFx0XHR0aGlzLm93bC5kb20uJGVsLm9mZihoYW5kbGVyLCB0aGlzLmhhbmRsZXJzW2hhbmRsZXJdKTtcclxuXHRcdH1cclxuXHRcdGZvciAocHJvcGVydHkgaW4gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGhpcykpIHtcclxuXHRcdFx0dHlwZW9mIHRoaXNbcHJvcGVydHldICE9ICdmdW5jdGlvbicgJiYgKHRoaXNbcHJvcGVydHldID0gbnVsbCk7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0JC5mbi5vd2xDYXJvdXNlbC5Db25zdHJ1Y3Rvci5QbHVnaW5zLmxhenlMb2FkID0gTGF6eUxvYWQ7XHJcblxyXG59KSh3aW5kb3cuWmVwdG8gfHwgd2luZG93LmpRdWVyeSwgd2luZG93LCBkb2N1bWVudCk7XHJcblxyXG4vKipcclxuICogQXV0b0hlaWdodCBQbHVnaW5cclxuICogQHZlcnNpb24gMi4wLjBcclxuICogQGF1dGhvciBCYXJ0b3N6IFdvamNpZWNob3dza2lcclxuICogQGxpY2Vuc2UgVGhlIE1JVCBMaWNlbnNlIChNSVQpXHJcbiAqL1xyXG47KGZ1bmN0aW9uKCQsIHdpbmRvdywgZG9jdW1lbnQsIHVuZGVmaW5lZCkge1xyXG5cclxuXHQvKipcclxuXHQgKiBDcmVhdGVzIHRoZSBhdXRvIGhlaWdodCBwbHVnaW4uXHJcblx0ICogQGNsYXNzIFRoZSBBdXRvIEhlaWdodCBQbHVnaW5cclxuXHQgKiBAcGFyYW0ge093bH0gc2NvcGUgLSBUaGUgT3dsIENhcm91c2VsXHJcblx0ICovXHJcblx0QXV0b0hlaWdodCA9IGZ1bmN0aW9uKHNjb3BlKSB7XHJcblx0XHR0aGlzLm93bCA9IHNjb3BlO1xyXG5cdFx0dGhpcy5vd2wub3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCBBdXRvSGVpZ2h0LkRlZmF1bHRzLCB0aGlzLm93bC5vcHRpb25zKTtcclxuXHJcblx0XHR0aGlzLmhhbmRsZXJzID0ge1xyXG5cdFx0XHQnY2hhbmdlZC5vd2wuY2Fyb3VzZWwnOiAkLnByb3h5KGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0XHRpZiAoZS5wcm9wZXJ0eS5uYW1lID09ICdwb3NpdGlvbicgJiYgdGhpcy5vd2wuc2V0dGluZ3MuYXV0b0hlaWdodCl7XHJcblx0XHRcdFx0XHR0aGlzLnNldEhlaWdodCgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSwgdGhpcylcclxuXHRcdH07XHJcblxyXG5cdFx0dGhpcy5vd2wuZG9tLiRlbC5vbih0aGlzLmhhbmRsZXJzKTtcclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBEZWZhdWx0IG9wdGlvbnMuXHJcblx0ICogQHB1YmxpY1xyXG5cdCAqL1xyXG5cdEF1dG9IZWlnaHQuRGVmYXVsdHMgPSB7XHJcblx0XHRhdXRvSGVpZ2h0OiBmYWxzZSxcclxuXHRcdGF1dG9IZWlnaHRDbGFzczogJ293bC1oZWlnaHQnXHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICpcclxuXHQgKiBAcGFyYW0ge0Jvb2xlYW59IGNhbGxiYWNrIC0gV2hldGhlclxyXG5cdCAqIEByZXR1cm5zIHtCb29sZWFufVxyXG5cdCAqL1xyXG5cdEF1dG9IZWlnaHQucHJvdG90eXBlLnNldEhlaWdodCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIGxvYWRlZCA9IHRoaXMub3dsLmRvbS4kaXRlbXMuZXEodGhpcy5vd2wuY3VycmVudCgpKSxcclxuXHRcdFx0c3RhZ2UgPSB0aGlzLm93bC5kb20uJG9TdGFnZSxcclxuXHRcdFx0aXRlcmF0aW9ucyA9IDAsXHJcblx0XHRcdGlzTG9hZGVkO1xyXG5cclxuXHRcdGlmICghdGhpcy5vd2wuZG9tLiRvU3RhZ2UuaGFzQ2xhc3ModGhpcy5vd2wuc2V0dGluZ3MuYXV0b0hlaWdodENsYXNzKSkge1xyXG5cdFx0XHR0aGlzLm93bC5kb20uJG9TdGFnZS5hZGRDbGFzcyh0aGlzLm93bC5zZXR0aW5ncy5hdXRvSGVpZ2h0Q2xhc3MpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlzTG9hZGVkID0gd2luZG93LnNldEludGVydmFsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRpdGVyYXRpb25zICs9IDE7XHJcblx0XHRcdGlmIChsb2FkZWQuZGF0YSgnb3dsLWl0ZW0nKS5sb2FkZWQpIHtcclxuXHRcdFx0XHRzdGFnZS5oZWlnaHQobG9hZGVkLmhlaWdodCgpICsgJ3B4Jyk7XHJcblx0XHRcdFx0Y2xlYXJJbnRlcnZhbChpc0xvYWRlZCk7XHJcblx0XHRcdH0gZWxzZSBpZiAoaXRlcmF0aW9ucyA9PT0gNTAwKSB7XHJcblx0XHRcdFx0Y2xlYXJJbnRlcnZhbChpc0xvYWRlZCk7XHJcblx0XHRcdH1cclxuXHRcdH0sIDEwMCk7XHJcblxyXG5cdH07XHJcblxyXG5cdEF1dG9IZWlnaHQucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBoYW5kbGVyLCBwcm9wZXJ0eTtcclxuXHJcblx0XHRmb3IgKGhhbmRsZXIgaW4gdGhpcy5oYW5kbGVycykge1xyXG5cdFx0XHR0aGlzLm93bC5kb20uJGVsLm9mZihoYW5kbGVyLCB0aGlzLmhhbmRsZXJzW2hhbmRsZXJdKTtcclxuXHRcdH1cclxuXHRcdGZvciAocHJvcGVydHkgaW4gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGhpcykpIHtcclxuXHRcdFx0dHlwZW9mIHRoaXNbcHJvcGVydHldICE9ICdmdW5jdGlvbicgJiYgKHRoaXNbcHJvcGVydHldID0gbnVsbCk7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0JC5mbi5vd2xDYXJvdXNlbC5Db25zdHJ1Y3Rvci5QbHVnaW5zLmF1dG9IZWlnaHQgPSBBdXRvSGVpZ2h0O1xyXG5cclxufSkod2luZG93LlplcHRvIHx8IHdpbmRvdy5qUXVlcnksIHdpbmRvdywgZG9jdW1lbnQpO1xyXG5cclxuLyoqXHJcbiAqIFZpZGVvIFBsdWdpblxyXG4gKiBAdmVyc2lvbiAyLjAuMFxyXG4gKiBAYXV0aG9yIEJhcnRvc3ogV29qY2llY2hvd3NraVxyXG4gKiBAbGljZW5zZSBUaGUgTUlUIExpY2Vuc2UgKE1JVClcclxuICovXHJcbjsoZnVuY3Rpb24oJCwgd2luZG93LCBkb2N1bWVudCwgdW5kZWZpbmVkKSB7XHJcblxyXG5cdC8qKlxyXG5cdCAqIENyZWF0ZXMgdGhlIHZpZGVvIHBsdWdpbi5cclxuXHQgKiBAY2xhc3MgVGhlIFZpZGVvIFBsdWdpblxyXG5cdCAqIEBwYXJhbSB7T3dsfSBzY29wZSAtIFRoZSBPd2wgQ2Fyb3VzZWxcclxuXHQgKi9cclxuXHRWaWRlbyA9IGZ1bmN0aW9uKHNjb3BlKSB7XHJcblx0XHR0aGlzLm93bCA9IHNjb3BlO1xyXG5cdFx0dGhpcy5vd2wub3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCBWaWRlby5EZWZhdWx0cywgdGhpcy5vd2wub3B0aW9ucyk7XHJcblxyXG5cdFx0dGhpcy5oYW5kbGVycyA9IHtcclxuXHRcdFx0J3Jlc2l6ZS5vd2wuY2Fyb3VzZWwnOiAkLnByb3h5KGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0XHRpZiAodGhpcy5vd2wuc2V0dGluZ3MudmlkZW8gJiYgIXRoaXMuaXNJbkZ1bGxTY3JlZW4oKSkge1xyXG5cdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSwgdGhpcyksXHJcblx0XHRcdCdyZWZyZXNoLm93bC5jYXJvdXNlbCBjaGFuZ2VkLm93bC5jYXJvdXNlbCc6ICQucHJveHkoZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRcdGlmICh0aGlzLm93bC5zdGF0ZS52aWRlb1BsYXkpIHtcclxuXHRcdFx0XHRcdHRoaXMuc3RvcFZpZGVvKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LCB0aGlzKSxcclxuXHRcdFx0J3JlZnJlc2gub3dsLmNhcm91c2VsIHJlZnJlc2hlZC5vd2wuY2Fyb3VzZWwnOiAkLnByb3h5KGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0XHRpZiAoIXRoaXMub3dsLnNldHRpbmdzLnZpZGVvKSB7XHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHRoaXMucmVmcmVzaGluZyA9IGUudHlwZSA9PSAncmVmcmVzaCc7XHJcblx0XHRcdH0sIHRoaXMpLFxyXG5cdFx0XHQnY2hhbmdlZC5vd2wuY2Fyb3VzZWwnOiAkLnByb3h5KGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0XHRpZiAodGhpcy5yZWZyZXNoaW5nICYmIGUucHJvcGVydHkubmFtZSA9PSAnaXRlbXMnICYmIGUucHJvcGVydHkudmFsdWUgJiYgIWUucHJvcGVydHkudmFsdWUuaXMoJzplbXB0eScpKSB7XHJcblx0XHRcdFx0XHR0aGlzLmNoZWNrVmlkZW9MaW5rcygpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSwgdGhpcylcclxuXHRcdH07XHJcblxyXG5cdFx0dGhpcy5vd2wuZG9tLiRlbC5vbih0aGlzLmhhbmRsZXJzKTtcclxuXHJcblx0XHR0aGlzLm93bC5kb20uJGVsLm9uKCdjbGljay5vd2wudmlkZW8nLCAnLm93bC12aWRlby1wbGF5LWljb24nLCAkLnByb3h5KGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0dGhpcy5wbGF5VmlkZW8oZSk7XHJcblx0XHR9LCB0aGlzKSk7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogRGVmYXVsdCBvcHRpb25zLlxyXG5cdCAqIEBwdWJsaWNcclxuXHQgKi9cclxuXHRWaWRlby5EZWZhdWx0cyA9IHtcclxuXHRcdHZpZGVvOiBmYWxzZSxcclxuXHRcdHZpZGVvSGVpZ2h0OiBmYWxzZSxcclxuXHRcdHZpZGVvV2lkdGg6IGZhbHNlXHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogQ2hlY2tzIGlmIGZvciBhbnkgdmlkZW9zIGxpbmtzIGV4aXN0cy5cclxuXHQgKiBAcHJvdGVjdGVkXHJcblx0ICovXHJcblx0VmlkZW8ucHJvdG90eXBlLmNoZWNrVmlkZW9MaW5rcyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIHZpZGVvRWwsIGl0ZW0sIGk7XHJcblxyXG5cdFx0Zm9yIChpID0gMDsgaSA8IHRoaXMub3dsLm51bS5pdGVtczsgaSsrKSB7XHJcblxyXG5cdFx0XHRpdGVtID0gdGhpcy5vd2wuZG9tLiRpdGVtcy5lcShpKTtcclxuXHRcdFx0aWYgKGl0ZW0uZGF0YSgnb3dsLWl0ZW0nKS5oYXNWaWRlbykge1xyXG5cdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR2aWRlb0VsID0gaXRlbS5maW5kKCcub3dsLXZpZGVvJyk7XHJcblx0XHRcdGlmICh2aWRlb0VsLmxlbmd0aCkge1xyXG5cdFx0XHRcdHRoaXMub3dsLnN0YXRlLmhhc1ZpZGVvcyA9IHRydWU7XHJcblx0XHRcdFx0dGhpcy5vd2wuZG9tLiRpdGVtcy5lcShpKS5kYXRhKCdvd2wtaXRlbScpLmhhc1ZpZGVvID0gdHJ1ZTtcclxuXHRcdFx0XHR2aWRlb0VsLmNzcygnZGlzcGxheScsICdub25lJyk7XHJcblx0XHRcdFx0dGhpcy5nZXRWaWRlb0luZm8odmlkZW9FbCwgaXRlbSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBHZXRzIHRoZSB2aWRlbyBJRCBhbmQgdGhlIHR5cGUgKFlvdVR1YmUvVmltZW8gb25seSkuXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqIEBwYXJhbSB7alF1ZXJ5fSB2aWRlb0VsIC0gVGhlIGVsZW1lbnQgY29udGFpbmluZyB0aGUgdmlkZW8gZGF0YS5cclxuXHQgKiBAcGFyYW0ge2pRdWVyeX0gaXRlbSAtIFRoZSBpdGVtIGNvbnRhaW5pbmcgdGhlIHZpZGVvLlxyXG5cdCAqL1xyXG5cdFZpZGVvLnByb3RvdHlwZS5nZXRWaWRlb0luZm8gPSBmdW5jdGlvbih2aWRlb0VsLCBpdGVtKSB7XHJcblxyXG5cdFx0dmFyIGluZm8sIHR5cGUsIGlkLCBkaW1lbnNpb25zLFxyXG5cdFx0XHR2aW1lb0lkID0gdmlkZW9FbC5kYXRhKCd2aW1lby1pZCcpLFxyXG5cdFx0XHR5b3VUdWJlSWQgPSB2aWRlb0VsLmRhdGEoJ3lvdXR1YmUtaWQnKSxcclxuXHRcdFx0d2lkdGggPSB2aWRlb0VsLmRhdGEoJ3dpZHRoJykgfHwgdGhpcy5vd2wuc2V0dGluZ3MudmlkZW9XaWR0aCxcclxuXHRcdFx0aGVpZ2h0ID0gdmlkZW9FbC5kYXRhKCdoZWlnaHQnKSB8fCB0aGlzLm93bC5zZXR0aW5ncy52aWRlb0hlaWdodCxcclxuXHRcdFx0dXJsID0gdmlkZW9FbC5hdHRyKCdocmVmJyk7XHJcblxyXG5cdFx0aWYgKHZpbWVvSWQpIHtcclxuXHRcdFx0dHlwZSA9ICd2aW1lbyc7XHJcblx0XHRcdGlkID0gdmltZW9JZDtcclxuXHRcdH0gZWxzZSBpZiAoeW91VHViZUlkKSB7XHJcblx0XHRcdHR5cGUgPSAneW91dHViZSc7XHJcblx0XHRcdGlkID0geW91VHViZUlkO1xyXG5cdFx0fSBlbHNlIGlmICh1cmwpIHtcclxuXHRcdFx0aWQgPSB1cmwubWF0Y2goLyhodHRwOnxodHRwczp8KVxcL1xcLyhwbGF5ZXIufHd3dy4pPyh2aW1lb1xcLmNvbXx5b3V0dShiZVxcLmNvbXxcXC5iZXxiZVxcLmdvb2dsZWFwaXNcXC5jb20pKVxcLyh2aWRlb1xcL3xlbWJlZFxcL3x3YXRjaFxcP3Y9fHZcXC8pPyhbQS1aYS16MC05Ll8lLV0qKShcXCZcXFMrKT8vKTtcclxuXHJcblx0XHRcdGlmIChpZFszXS5pbmRleE9mKCd5b3V0dScpID4gLTEpIHtcclxuXHRcdFx0XHR0eXBlID0gJ3lvdXR1YmUnO1xyXG5cdFx0XHR9IGVsc2UgaWYgKGlkWzNdLmluZGV4T2YoJ3ZpbWVvJykgPiAtMSkge1xyXG5cdFx0XHRcdHR5cGUgPSAndmltZW8nO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlkID0gaWRbNl07XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgdmlkZW8gbGluay4nKTtcclxuXHRcdH1cclxuXHJcblx0XHRpdGVtLmRhdGEoJ293bC1pdGVtJykudmlkZW9UeXBlID0gdHlwZTtcclxuXHRcdGl0ZW0uZGF0YSgnb3dsLWl0ZW0nKS52aWRlb0lkID0gaWQ7XHJcblx0XHRpdGVtLmRhdGEoJ293bC1pdGVtJykudmlkZW9XaWR0aCA9IHdpZHRoO1xyXG5cdFx0aXRlbS5kYXRhKCdvd2wtaXRlbScpLnZpZGVvSGVpZ2h0ID0gaGVpZ2h0O1xyXG5cclxuXHRcdGluZm8gPSB7XHJcblx0XHRcdHR5cGU6IHR5cGUsXHJcblx0XHRcdGlkOiBpZFxyXG5cdFx0fTtcclxuXHJcblx0XHQvLyBDaGVjayBkaW1lbnNpb25zXHJcblx0XHRkaW1lbnNpb25zID0gd2lkdGggJiYgaGVpZ2h0ID8gJ3N0eWxlPVwid2lkdGg6JyArIHdpZHRoICsgJ3B4O2hlaWdodDonICsgaGVpZ2h0ICsgJ3B4O1wiJyA6ICcnO1xyXG5cclxuXHRcdC8vIHdyYXAgdmlkZW8gY29udGVudCBpbnRvIG93bC12aWRlby13cmFwcGVyIGRpdlxyXG5cdFx0dmlkZW9FbC53cmFwKCc8ZGl2IGNsYXNzPVwib3dsLXZpZGVvLXdyYXBwZXJcIicgKyBkaW1lbnNpb25zICsgJz48L2Rpdj4nKTtcclxuXHJcblx0XHR0aGlzLmNyZWF0ZVZpZGVvVG4odmlkZW9FbCwgaW5mbyk7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogQ3JlYXRlcyB2aWRlbyB0aHVtYm5haWwuXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqIEBwYXJhbSB7alF1ZXJ5fSB2aWRlb0VsIC0gVGhlIGVsZW1lbnQgY29udGFpbmluZyB0aGUgdmlkZW8gZGF0YS5cclxuXHQgKiBAcGFyYW0ge09iamVjdH0gaW5mbyAtIFRoZSB2aWRlbyBpbmZvIG9iamVjdC5cclxuXHQgKiBAc2VlIGBnZXRWaWRlb0luZm9gXHJcblx0ICovXHJcblx0VmlkZW8ucHJvdG90eXBlLmNyZWF0ZVZpZGVvVG4gPSBmdW5jdGlvbih2aWRlb0VsLCBpbmZvKSB7XHJcblxyXG5cdFx0dmFyIHRuTGluaywgaWNvbiwgcGF0aCxcclxuXHRcdFx0Y3VzdG9tVG4gPSB2aWRlb0VsLmZpbmQoJ2ltZycpLFxyXG5cdFx0XHRzcmNUeXBlID0gJ3NyYycsXHJcblx0XHRcdGxhenlDbGFzcyA9ICcnLFxyXG5cdFx0XHR0aGF0ID0gdGhpcy5vd2w7XHJcblxyXG5cdFx0aWYgKHRoaXMub3dsLnNldHRpbmdzLmxhenlMb2FkKSB7XHJcblx0XHRcdHNyY1R5cGUgPSAnZGF0YS1zcmMnO1xyXG5cdFx0XHRsYXp5Q2xhc3MgPSAnb3dsLWxhenknO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIEN1c3RvbSB0aHVtYm5haWxcclxuXHJcblx0XHRpZiAoY3VzdG9tVG4ubGVuZ3RoKSB7XHJcblx0XHRcdGFkZFRodW1ibmFpbChjdXN0b21Ubi5hdHRyKHNyY1R5cGUpKTtcclxuXHRcdFx0Y3VzdG9tVG4ucmVtb3ZlKCk7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHJcblx0XHRmdW5jdGlvbiBhZGRUaHVtYm5haWwodG5QYXRoKSB7XHJcblx0XHRcdGljb24gPSAnPGRpdiBjbGFzcz1cIm93bC12aWRlby1wbGF5LWljb25cIj48L2Rpdj4nO1xyXG5cclxuXHRcdFx0aWYgKHRoYXQuc2V0dGluZ3MubGF6eUxvYWQpIHtcclxuXHRcdFx0XHR0bkxpbmsgPSAnPGRpdiBjbGFzcz1cIm93bC12aWRlby10biAnICsgbGF6eUNsYXNzICsgJ1wiICcgKyBzcmNUeXBlICsgJz1cIicgKyB0blBhdGggKyAnXCI+PC9kaXY+JztcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHR0bkxpbmsgPSAnPGRpdiBjbGFzcz1cIm93bC12aWRlby10blwiIHN0eWxlPVwib3BhY2l0eToxO2JhY2tncm91bmQtaW1hZ2U6dXJsKCcgKyB0blBhdGggKyAnKVwiPjwvZGl2Pic7XHJcblx0XHRcdH1cclxuXHRcdFx0dmlkZW9FbC5hZnRlcih0bkxpbmspO1xyXG5cdFx0XHR2aWRlb0VsLmFmdGVyKGljb24pO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChpbmZvLnR5cGUgPT09ICd5b3V0dWJlJykge1xyXG5cdFx0XHRwYXRoID0gXCJodHRwOi8vaW1nLnlvdXR1YmUuY29tL3ZpL1wiICsgaW5mby5pZCArIFwiL2hxZGVmYXVsdC5qcGdcIjtcclxuXHRcdFx0YWRkVGh1bWJuYWlsKHBhdGgpO1xyXG5cdFx0fSBlbHNlIGlmIChpbmZvLnR5cGUgPT09ICd2aW1lbycpIHtcclxuXHRcdFx0JC5hamF4KHtcclxuXHRcdFx0XHR0eXBlOiAnR0VUJyxcclxuXHRcdFx0XHR1cmw6ICdodHRwOi8vdmltZW8uY29tL2FwaS92Mi92aWRlby8nICsgaW5mby5pZCArICcuanNvbicsXHJcblx0XHRcdFx0anNvbnA6ICdjYWxsYmFjaycsXHJcblx0XHRcdFx0ZGF0YVR5cGU6ICdqc29ucCcsXHJcblx0XHRcdFx0c3VjY2VzczogZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdFx0cGF0aCA9IGRhdGFbMF0udGh1bWJuYWlsX2xhcmdlO1xyXG5cdFx0XHRcdFx0YWRkVGh1bWJuYWlsKHBhdGgpO1xyXG5cdFx0XHRcdFx0aWYgKHRoYXQuc2V0dGluZ3MubG9vcCkge1xyXG5cdFx0XHRcdFx0XHR0aGF0LnVwZGF0ZUFjdGl2ZUl0ZW1zKCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBTdG9wcyB0aGUgY3VycmVudCB2aWRlby5cclxuXHQgKiBAcHVibGljXHJcblx0ICovXHJcblx0VmlkZW8ucHJvdG90eXBlLnN0b3BWaWRlbyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dGhpcy5vd2wudHJpZ2dlcignc3RvcCcsIG51bGwsICd2aWRlbycpO1xyXG5cdFx0dmFyIGl0ZW0gPSB0aGlzLm93bC5kb20uJGl0ZW1zLmVxKHRoaXMub3dsLnN0YXRlLnZpZGVvUGxheUluZGV4KTtcclxuXHRcdGl0ZW0uZmluZCgnLm93bC12aWRlby1mcmFtZScpLnJlbW92ZSgpO1xyXG5cdFx0aXRlbS5yZW1vdmVDbGFzcygnb3dsLXZpZGVvLXBsYXlpbmcnKTtcclxuXHRcdHRoaXMub3dsLnN0YXRlLnZpZGVvUGxheSA9IGZhbHNlO1xyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIFN0YXJ0cyB0aGUgY3VycmVudCB2aWRlby5cclxuXHQgKiBAcHVibGljXHJcblx0ICogQHBhcmFtIHtFdmVudH0gZXYgLSBUaGUgZXZlbnQgYXJndW1lbnRzLlxyXG5cdCAqL1xyXG5cdFZpZGVvLnByb3RvdHlwZS5wbGF5VmlkZW8gPSBmdW5jdGlvbihldikge1xyXG5cdFx0dGhpcy5vd2wudHJpZ2dlcigncGxheScsIG51bGwsICd2aWRlbycpO1xyXG5cclxuXHRcdGlmICh0aGlzLm93bC5zdGF0ZS52aWRlb1BsYXkpIHtcclxuXHRcdFx0dGhpcy5zdG9wVmlkZW8oKTtcclxuXHRcdH1cclxuXHRcdHZhciB2aWRlb0xpbmssIHZpZGVvV3JhcCwgdmlkZW9UeXBlLFxyXG5cdFx0XHR0YXJnZXQgPSAkKGV2LnRhcmdldCB8fCBldi5zcmNFbGVtZW50KSxcclxuXHRcdFx0aXRlbSA9IHRhcmdldC5jbG9zZXN0KCcuJyArIHRoaXMub3dsLnNldHRpbmdzLml0ZW1DbGFzcyk7XHJcblxyXG5cdFx0dmlkZW9UeXBlID0gaXRlbS5kYXRhKCdvd2wtaXRlbScpLnZpZGVvVHlwZSwgaWQgPSBpdGVtLmRhdGEoJ293bC1pdGVtJykudmlkZW9JZCwgd2lkdGggPSBpdGVtXHJcblx0XHRcdC5kYXRhKCdvd2wtaXRlbScpLnZpZGVvV2lkdGhcclxuXHRcdFx0fHwgTWF0aC5mbG9vcihpdGVtLmRhdGEoJ293bC1pdGVtJykud2lkdGggLSB0aGlzLm93bC5zZXR0aW5ncy5tYXJnaW4pLCBoZWlnaHQgPSBpdGVtLmRhdGEoJ293bC1pdGVtJykudmlkZW9IZWlnaHRcclxuXHRcdFx0fHwgdGhpcy5vd2wuZG9tLiRzdGFnZS5oZWlnaHQoKTtcclxuXHJcblx0XHRpZiAodmlkZW9UeXBlID09PSAneW91dHViZScpIHtcclxuXHRcdFx0dmlkZW9MaW5rID0gXCI8aWZyYW1lIHdpZHRoPVxcXCJcIiArIHdpZHRoICsgXCJcXFwiIGhlaWdodD1cXFwiXCIgKyBoZWlnaHQgKyBcIlxcXCIgc3JjPVxcXCJodHRwOi8vd3d3LnlvdXR1YmUuY29tL2VtYmVkL1wiXHJcblx0XHRcdFx0KyBpZCArIFwiP2F1dG9wbGF5PTEmdj1cIiArIGlkICsgXCJcXFwiIGZyYW1lYm9yZGVyPVxcXCIwXFxcIiBhbGxvd2Z1bGxzY3JlZW4+PC9pZnJhbWU+XCI7XHJcblx0XHR9IGVsc2UgaWYgKHZpZGVvVHlwZSA9PT0gJ3ZpbWVvJykge1xyXG5cdFx0XHR2aWRlb0xpbmsgPSAnPGlmcmFtZSBzcmM9XCJodHRwOi8vcGxheWVyLnZpbWVvLmNvbS92aWRlby8nICsgaWQgKyAnP2F1dG9wbGF5PTFcIiB3aWR0aD1cIicgKyB3aWR0aFxyXG5cdFx0XHRcdCsgJ1wiIGhlaWdodD1cIicgKyBoZWlnaHRcclxuXHRcdFx0XHQrICdcIiBmcmFtZWJvcmRlcj1cIjBcIiB3ZWJraXRhbGxvd2Z1bGxzY3JlZW4gbW96YWxsb3dmdWxsc2NyZWVuIGFsbG93ZnVsbHNjcmVlbj48L2lmcmFtZT4nO1xyXG5cdFx0fVxyXG5cclxuXHRcdGl0ZW0uYWRkQ2xhc3MoJ293bC12aWRlby1wbGF5aW5nJyk7XHJcblx0XHR0aGlzLm93bC5zdGF0ZS52aWRlb1BsYXkgPSB0cnVlO1xyXG5cdFx0dGhpcy5vd2wuc3RhdGUudmlkZW9QbGF5SW5kZXggPSBpdGVtLmRhdGEoJ293bC1pdGVtJykuaW5kZXhBYnM7XHJcblxyXG5cdFx0dmlkZW9XcmFwID0gJCgnPGRpdiBzdHlsZT1cImhlaWdodDonICsgaGVpZ2h0ICsgJ3B4OyB3aWR0aDonICsgd2lkdGggKyAncHhcIiBjbGFzcz1cIm93bC12aWRlby1mcmFtZVwiPidcclxuXHRcdFx0KyB2aWRlb0xpbmsgKyAnPC9kaXY+Jyk7XHJcblx0XHR0YXJnZXQuYWZ0ZXIodmlkZW9XcmFwKTtcclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBDaGVja3Mgd2hldGhlciBhbiB2aWRlbyBpcyBjdXJyZW50bHkgaW4gZnVsbCBzY3JlZW4gbW9kZSBvciBub3QuXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqIEByZXR1cm5zIHtCb29sZWFufVxyXG5cdCAqL1xyXG5cdFZpZGVvLnByb3RvdHlwZS5pc0luRnVsbFNjcmVlbiA9IGZ1bmN0aW9uKCkge1xyXG5cclxuXHRcdC8vIGlmIFZpbWVvIEZ1bGxzY3JlZW4gbW9kZVxyXG5cdFx0dmFyIGZ1bGxzY3JlZW5FbGVtZW50ID0gZG9jdW1lbnQuZnVsbHNjcmVlbkVsZW1lbnQgfHwgZG9jdW1lbnQubW96RnVsbFNjcmVlbkVsZW1lbnRcclxuXHRcdFx0fHwgZG9jdW1lbnQud2Via2l0RnVsbHNjcmVlbkVsZW1lbnQ7XHJcblx0XHRpZiAoZnVsbHNjcmVlbkVsZW1lbnQpIHtcclxuXHRcdFx0aWYgKCQoZnVsbHNjcmVlbkVsZW1lbnQucGFyZW50Tm9kZSkuaGFzQ2xhc3MoJ293bC12aWRlby1mcmFtZScpKSB7XHJcblx0XHRcdFx0dGhpcy5vd2wuc3BlZWQoMCk7XHJcblx0XHRcdFx0dGhpcy5vd2wuc3RhdGUuaXNGdWxsU2NyZWVuID0gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChmdWxsc2NyZWVuRWxlbWVudCAmJiB0aGlzLm93bC5zdGF0ZS5pc0Z1bGxTY3JlZW4gJiYgdGhpcy5vd2wuc3RhdGUudmlkZW9QbGF5KSB7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBDb21taW5nIGJhY2sgZnJvbSBmdWxsc2NyZWVuXHJcblx0XHRpZiAodGhpcy5vd2wuc3RhdGUuaXNGdWxsU2NyZWVuKSB7XHJcblx0XHRcdHRoaXMub3dsLnN0YXRlLmlzRnVsbFNjcmVlbiA9IGZhbHNlO1xyXG5cdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gY2hlY2sgZnVsbCBzY3JlZW4gbW9kZSBhbmQgd2luZG93IG9yaWVudGF0aW9uXHJcblx0XHRpZiAodGhpcy5vd2wuc3RhdGUudmlkZW9QbGF5KSB7XHJcblx0XHRcdGlmICh0aGlzLm93bC5zdGF0ZS5vcmllbnRhdGlvbiAhPT0gd2luZG93Lm9yaWVudGF0aW9uKSB7XHJcblx0XHRcdFx0dGhpcy5vd2wuc3RhdGUub3JpZW50YXRpb24gPSB3aW5kb3cub3JpZW50YXRpb247XHJcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gdHJ1ZTtcclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBEZXN0cm95cyB0aGUgcGx1Z2luLlxyXG5cdCAqL1xyXG5cdFZpZGVvLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgaGFuZGxlciwgcHJvcGVydHk7XHJcblxyXG5cdFx0dGhpcy5vd2wuZG9tLiRlbC5vZmYoJ2NsaWNrLm93bC52aWRlbycpO1xyXG5cclxuXHRcdGZvciAoaGFuZGxlciBpbiB0aGlzLmhhbmRsZXJzKSB7XHJcblx0XHRcdHRoaXMub3dsLmRvbS4kZWwub2ZmKGhhbmRsZXIsIHRoaXMuaGFuZGxlcnNbaGFuZGxlcl0pO1xyXG5cdFx0fVxyXG5cdFx0Zm9yIChwcm9wZXJ0eSBpbiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0aGlzKSkge1xyXG5cdFx0XHR0eXBlb2YgdGhpc1twcm9wZXJ0eV0gIT0gJ2Z1bmN0aW9uJyAmJiAodGhpc1twcm9wZXJ0eV0gPSBudWxsKTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHQkLmZuLm93bENhcm91c2VsLkNvbnN0cnVjdG9yLlBsdWdpbnMudmlkZW8gPSBWaWRlbztcclxuXHJcbn0pKHdpbmRvdy5aZXB0byB8fCB3aW5kb3cualF1ZXJ5LCB3aW5kb3csIGRvY3VtZW50KTtcclxuXHJcbi8qKlxyXG4gKiBBbmltYXRlIFBsdWdpblxyXG4gKiBAdmVyc2lvbiAyLjAuMFxyXG4gKiBAYXV0aG9yIEJhcnRvc3ogV29qY2llY2hvd3NraVxyXG4gKiBAbGljZW5zZSBUaGUgTUlUIExpY2Vuc2UgKE1JVClcclxuICovXHJcbjsoZnVuY3Rpb24oJCwgd2luZG93LCBkb2N1bWVudCwgdW5kZWZpbmVkKSB7XHJcblxyXG5cdC8qKlxyXG5cdCAqIENyZWF0ZXMgdGhlIGFuaW1hdGUgcGx1Z2luLlxyXG5cdCAqIEBjbGFzcyBUaGUgTmF2aWdhdGlvbiBQbHVnaW5cclxuXHQgKiBAcGFyYW0ge093bH0gc2NvcGUgLSBUaGUgT3dsIENhcm91c2VsXHJcblx0ICovXHJcblx0QW5pbWF0ZSA9IGZ1bmN0aW9uKHNjb3BlKSB7XHJcblx0XHR0aGlzLmNvcmUgPSBzY29wZTtcclxuXHRcdHRoaXMuY29yZS5vcHRpb25zID0gJC5leHRlbmQoe30sIEFuaW1hdGUuRGVmYXVsdHMsIHRoaXMuY29yZS5vcHRpb25zKTtcclxuXHRcdHRoaXMuc3dhcHBpbmcgPSB0cnVlO1xyXG5cdFx0dGhpcy5wcmV2aW91cyA9IHVuZGVmaW5lZDtcclxuXHRcdHRoaXMubmV4dCA9IHVuZGVmaW5lZDtcclxuXHJcblx0XHR0aGlzLmhhbmRsZXJzID0ge1xyXG5cdFx0XHQnY2hhbmdlLm93bC5jYXJvdXNlbCc6ICQucHJveHkoZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRcdGlmIChlLnByb3BlcnR5Lm5hbWUgPT0gJ3Bvc2l0aW9uJykge1xyXG5cdFx0XHRcdFx0dGhpcy5wcmV2aW91cyA9IHRoaXMuY29yZS5jdXJyZW50KCk7XHJcblx0XHRcdFx0XHR0aGlzLm5leHQgPSBlLnByb3BlcnR5LnZhbHVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSwgdGhpcyksXHJcblx0XHRcdCdkcmFnLm93bC5jYXJvdXNlbCBkcmFnZ2VkLm93bC5jYXJvdXNlbCB0cmFuc2xhdGVkLm93bC5jYXJvdXNlbCc6ICQucHJveHkoZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRcdHRoaXMuc3dhcHBpbmcgPSBlLnR5cGUgPT0gJ3RyYW5zbGF0ZWQnO1xyXG5cdFx0XHR9LCB0aGlzKSxcclxuXHRcdFx0J3RyYW5zbGF0ZS5vd2wuY2Fyb3VzZWwnOiAkLnByb3h5KGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0XHRpZiAodGhpcy5zd2FwcGluZyAmJiAodGhpcy5jb3JlLm9wdGlvbnMuYW5pbWF0ZU91dCB8fCB0aGlzLmNvcmUub3B0aW9ucy5hbmltYXRlSW4pKSB7XHJcblx0XHRcdFx0XHR0aGlzLnN3YXAoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sIHRoaXMpXHJcblx0XHR9O1xyXG5cclxuXHRcdHRoaXMuY29yZS5kb20uJGVsLm9uKHRoaXMuaGFuZGxlcnMpO1xyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIERlZmF1bHQgb3B0aW9ucy5cclxuXHQgKiBAcHVibGljXHJcblx0ICovXHJcblx0QW5pbWF0ZS5EZWZhdWx0cyA9IHtcclxuXHRcdGFuaW1hdGVPdXQ6IGZhbHNlLFxyXG5cdFx0YW5pbWF0ZUluOiBmYWxzZVxyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIFRvZ2dsZXMgdGhlIGFuaW1hdGlvbiBjbGFzc2VzIHdoZW5ldmVyIGFuIHRyYW5zbGF0aW9ucyBzdGFydHMuXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqIEByZXR1cm5zIHtCb29sZWFufHVuZGVmaW5lZH1cclxuXHQgKi9cclxuXHRBbmltYXRlLnByb3RvdHlwZS5zd2FwID0gZnVuY3Rpb24oKSB7XHJcblxyXG5cdFx0aWYgKHRoaXMuY29yZS5zZXR0aW5ncy5pdGVtcyAhPT0gMSB8fCAhdGhpcy5jb3JlLnN1cHBvcnQzZCkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5jb3JlLnNwZWVkKDApO1xyXG5cclxuXHRcdHZhciBsZWZ0LFxyXG5cdFx0XHRjbGVhciA9ICQucHJveHkodGhpcy5jbGVhciwgdGhpcyksXHJcblx0XHRcdHByZXZpb3VzID0gdGhpcy5jb3JlLmRvbS4kaXRlbXMuZXEodGhpcy5wcmV2aW91cyksXHJcblx0XHRcdG5leHQgPSB0aGlzLmNvcmUuZG9tLiRpdGVtcy5lcSh0aGlzLm5leHQpLFxyXG5cdFx0XHRpbmNvbWluZyA9IHRoaXMuY29yZS5zZXR0aW5ncy5hbmltYXRlSW4sXHJcblx0XHRcdG91dGdvaW5nID0gdGhpcy5jb3JlLnNldHRpbmdzLmFuaW1hdGVPdXQ7XHJcblxyXG5cdFx0aWYgKHRoaXMuY29yZS5jdXJyZW50KCkgPT09IHRoaXMucHJldmlvdXMpIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChvdXRnb2luZykge1xyXG5cdFx0XHRsZWZ0ID0gdGhpcy5jb3JlLmNvb3JkaW5hdGVzKHRoaXMucHJldmlvdXMpIC0gdGhpcy5jb3JlLmNvb3JkaW5hdGVzKHRoaXMubmV4dCk7XHJcblx0XHRcdHByZXZpb3VzLmNzcyggeyAnbGVmdCc6IGxlZnQgKyAncHgnIH0gKVxyXG5cdFx0XHRcdC5hZGRDbGFzcygnYW5pbWF0ZWQgb3dsLWFuaW1hdGVkLW91dCcpXHJcblx0XHRcdFx0LmFkZENsYXNzKG91dGdvaW5nKVxyXG5cdFx0XHRcdC5vbmUoJ3dlYmtpdEFuaW1hdGlvbkVuZCBtb3pBbmltYXRpb25FbmQgTVNBbmltYXRpb25FbmQgb2FuaW1hdGlvbmVuZCBhbmltYXRpb25lbmQnLCBjbGVhcik7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKGluY29taW5nKSB7XHJcblx0XHRcdG5leHQuYWRkQ2xhc3MoJ2FuaW1hdGVkIG93bC1hbmltYXRlZC1pbicpXHJcblx0XHRcdFx0LmFkZENsYXNzKGluY29taW5nKVxyXG5cdFx0XHRcdC5vbmUoJ3dlYmtpdEFuaW1hdGlvbkVuZCBtb3pBbmltYXRpb25FbmQgTVNBbmltYXRpb25FbmQgb2FuaW1hdGlvbmVuZCBhbmltYXRpb25lbmQnLCBjbGVhcik7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0QW5pbWF0ZS5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbihlKSB7XHJcblx0XHQkKGUudGFyZ2V0KS5jc3MoIHsgJ2xlZnQnOiAnJyB9IClcclxuXHRcdFx0LnJlbW92ZUNsYXNzKCdhbmltYXRlZCBvd2wtYW5pbWF0ZWQtb3V0IG93bC1hbmltYXRlZC1pbicpXHJcblx0XHRcdC5yZW1vdmVDbGFzcyh0aGlzLmNvcmUuc2V0dGluZ3MuYW5pbWF0ZUluKVxyXG5cdFx0XHQucmVtb3ZlQ2xhc3ModGhpcy5jb3JlLnNldHRpbmdzLmFuaW1hdGVPdXQpO1xyXG5cdFx0dGhpcy5jb3JlLnRyYW5zaXRpb25FbmQoKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIERlc3Ryb3lzIHRoZSBwbHVnaW4uXHJcblx0ICogQHB1YmxpY1xyXG5cdCAqL1xyXG5cdEFuaW1hdGUucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBoYW5kbGVyLCBwcm9wZXJ0eTtcclxuXHJcblx0XHRmb3IgKGhhbmRsZXIgaW4gdGhpcy5oYW5kbGVycykge1xyXG5cdFx0XHR0aGlzLmNvcmUuZG9tLiRlbC5vZmYoaGFuZGxlciwgdGhpcy5oYW5kbGVyc1toYW5kbGVyXSk7XHJcblx0XHR9XHJcblx0XHRmb3IgKHByb3BlcnR5IGluIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHRoaXMpKSB7XHJcblx0XHRcdHR5cGVvZiB0aGlzW3Byb3BlcnR5XSAhPSAnZnVuY3Rpb24nICYmICh0aGlzW3Byb3BlcnR5XSA9IG51bGwpO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdCQuZm4ub3dsQ2Fyb3VzZWwuQ29uc3RydWN0b3IuUGx1Z2lucy5BbmltYXRlID0gQW5pbWF0ZTtcclxuXHJcbn0pKHdpbmRvdy5aZXB0byB8fCB3aW5kb3cualF1ZXJ5LCB3aW5kb3csIGRvY3VtZW50KTtcclxuXHJcbi8qKlxyXG4gKiBBdXRvcGxheSBQbHVnaW5cclxuICogQHZlcnNpb24gMi4wLjBcclxuICogQGF1dGhvciBCYXJ0b3N6IFdvamNpZWNob3dza2lcclxuICogQGxpY2Vuc2UgVGhlIE1JVCBMaWNlbnNlIChNSVQpXHJcbiAqL1xyXG47KGZ1bmN0aW9uKCQsIHdpbmRvdywgZG9jdW1lbnQsIHVuZGVmaW5lZCkge1xyXG5cclxuXHQvKipcclxuXHQgKiBDcmVhdGVzIHRoZSBhdXRvcGxheSBwbHVnaW4uXHJcblx0ICogQGNsYXNzIFRoZSBBdXRvcGxheSBQbHVnaW5cclxuXHQgKiBAcGFyYW0ge093bH0gc2NvcGUgLSBUaGUgT3dsIENhcm91c2VsXHJcblx0ICovXHJcblx0QXV0b3BsYXkgPSBmdW5jdGlvbihzY29wZSkge1xyXG5cdFx0dGhpcy5jb3JlID0gc2NvcGU7XHJcblx0XHR0aGlzLmNvcmUub3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCBBdXRvcGxheS5EZWZhdWx0cywgdGhpcy5jb3JlLm9wdGlvbnMpO1xyXG5cclxuXHRcdHRoaXMuaGFuZGxlcnMgPSB7XHJcblx0XHRcdCd0cmFuc2xhdGVkLm93bC5jYXJvdXNlbCByZWZyZXNoZWQub3dsLmNhcm91c2VsJzogJC5wcm94eShmdW5jdGlvbigpIHtcclxuXHRcdFx0XHR0aGlzLmF1dG9wbGF5KCk7XHJcblx0XHRcdH0sIHRoaXMpLFxyXG5cdFx0XHQncGxheS5vd2wuYXV0b3BsYXknOiAkLnByb3h5KGZ1bmN0aW9uKGUsIHQsIHMpIHtcclxuXHRcdFx0XHR0aGlzLnBsYXkodCwgcyk7XHJcblx0XHRcdH0sIHRoaXMpLFxyXG5cdFx0XHQnc3RvcC5vd2wuYXV0b3BsYXknOiAkLnByb3h5KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHRoaXMuc3RvcCgpO1xyXG5cdFx0XHR9LCB0aGlzKSxcclxuXHRcdFx0J21vdXNlb3Zlci5vd2wuYXV0b3BsYXknOiAkLnByb3h5KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdGlmICh0aGlzLmNvcmUuc2V0dGluZ3MuYXV0b3BsYXlIb3ZlclBhdXNlKSB7XHJcblx0XHRcdFx0XHR0aGlzLnBhdXNlKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LCB0aGlzKSxcclxuXHRcdFx0J21vdXNlbGVhdmUub3dsLmF1dG9wbGF5JzogJC5wcm94eShmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRpZiAodGhpcy5jb3JlLnNldHRpbmdzLmF1dG9wbGF5SG92ZXJQYXVzZSkge1xyXG5cdFx0XHRcdFx0dGhpcy5hdXRvcGxheSgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSwgdGhpcylcclxuXHRcdH07XHJcblxyXG5cdFx0dGhpcy5jb3JlLmRvbS4kZWwub24odGhpcy5oYW5kbGVycyk7XHJcblx0fTtcclxuXHJcblx0LyoqXHJcblx0ICogRGVmYXVsdCBvcHRpb25zLlxyXG5cdCAqIEBwdWJsaWNcclxuXHQgKi9cclxuXHRBdXRvcGxheS5EZWZhdWx0cyA9IHtcclxuXHRcdGF1dG9wbGF5OiBmYWxzZSxcclxuXHRcdGF1dG9wbGF5VGltZW91dDogNTAwMCxcclxuXHRcdGF1dG9wbGF5SG92ZXJQYXVzZTogZmFsc2UsXHJcblx0XHRhdXRvcGxheVNwZWVkOiBmYWxzZVxyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwcm90ZWN0ZWRcclxuXHQgKiBAdG9kbyBNdXN0IGJlIGRvY3VtZW50ZWQuXHJcblx0ICovXHJcblx0QXV0b3BsYXkucHJvdG90eXBlLmF1dG9wbGF5ID0gZnVuY3Rpb24oKSB7XHJcblx0XHRpZiAodGhpcy5jb3JlLnNldHRpbmdzLmF1dG9wbGF5ICYmICF0aGlzLmNvcmUuc3RhdGUudmlkZW9QbGF5KSB7XHJcblx0XHRcdHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWwpO1xyXG5cclxuXHRcdFx0dGhpcy5pbnRlcnZhbCA9IHdpbmRvdy5zZXRJbnRlcnZhbCgkLnByb3h5KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHRoaXMucGxheSgpO1xyXG5cdFx0XHR9LCB0aGlzKSwgdGhpcy5jb3JlLnNldHRpbmdzLmF1dG9wbGF5VGltZW91dCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsKTtcclxuXHRcdH1cclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBTdGFydHMgdGhlIGF1dG9wbGF5LlxyXG5cdCAqIEBwdWJsaWNcclxuXHQgKiBAcGFyYW0ge051bWJlcn0gW3RpbWVvdXRdIC0gLi4uXHJcblx0ICogQHBhcmFtIHtOdW1iZXJ9IFtzcGVlZF0gLSAuLi5cclxuXHQgKiBAcmV0dXJucyB7Qm9vbGVhbnx1bmRlZmluZWR9IC0gLi4uXHJcblx0ICogQHRvZG8gTXVzdCBiZSBkb2N1bWVudGVkLlxyXG5cdCAqL1xyXG5cdEF1dG9wbGF5LnByb3RvdHlwZS5wbGF5ID0gZnVuY3Rpb24odGltZW91dCwgc3BlZWQpIHtcclxuXHRcdC8vIGlmIHRhYiBpcyBpbmFjdGl2ZSAtIGRvZXNudCB3b3JrIGluIDxJRTEwXHJcblx0XHRpZiAoZG9jdW1lbnQuaGlkZGVuID09PSB0cnVlKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAodGhpcy5jb3JlLnN0YXRlLmlzVG91Y2ggfHwgdGhpcy5jb3JlLnN0YXRlLmlzU2Nyb2xsaW5nXHJcblx0XHRcdHx8IHRoaXMuY29yZS5zdGF0ZS5pc1N3aXBpbmcgfHwgdGhpcy5jb3JlLnN0YXRlLmluTW90aW9uKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAodGhpcy5jb3JlLnNldHRpbmdzLmF1dG9wbGF5ID09PSBmYWxzZSkge1xyXG5cdFx0XHR3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuY29yZS5uZXh0KHRoaXMuY29yZS5zZXR0aW5ncy5hdXRvcGxheVNwZWVkKTtcclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBTdG9wcyB0aGUgYXV0b3BsYXkuXHJcblx0ICogQHB1YmxpY1xyXG5cdCAqL1xyXG5cdEF1dG9wbGF5LnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24oKSB7XHJcblx0XHR3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsKTtcclxuXHR9O1xyXG5cclxuXHQvKipcclxuXHQgKiBQYXVzZXMgdGhlIGF1dG9wbGF5LlxyXG5cdCAqIEBwdWJsaWNcclxuXHQgKi9cclxuXHRBdXRvcGxheS5wcm90b3R5cGUucGF1c2UgPSBmdW5jdGlvbigpIHtcclxuXHRcdHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMuaW50ZXJ2YWwpO1xyXG5cdH07XHJcblxyXG5cdC8qKlxyXG5cdCAqIERlc3Ryb3lzIHRoZSBwbHVnaW4uXHJcblx0ICovXHJcblx0QXV0b3BsYXkucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBoYW5kbGVyLCBwcm9wZXJ0eTtcclxuXHJcblx0XHR3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLmludGVydmFsKTtcclxuXHJcblx0XHRmb3IgKGhhbmRsZXIgaW4gdGhpcy5oYW5kbGVycykge1xyXG5cdFx0XHR0aGlzLmNvcmUuZG9tLiRlbC5vZmYoaGFuZGxlciwgdGhpcy5oYW5kbGVyc1toYW5kbGVyXSk7XHJcblx0XHR9XHJcblx0XHRmb3IgKHByb3BlcnR5IGluIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHRoaXMpKSB7XHJcblx0XHRcdHR5cGVvZiB0aGlzW3Byb3BlcnR5XSAhPSAnZnVuY3Rpb24nICYmICh0aGlzW3Byb3BlcnR5XSA9IG51bGwpO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdCQuZm4ub3dsQ2Fyb3VzZWwuQ29uc3RydWN0b3IuUGx1Z2lucy5hdXRvcGxheSA9IEF1dG9wbGF5O1xyXG5cclxufSkod2luZG93LlplcHRvIHx8IHdpbmRvdy5qUXVlcnksIHdpbmRvdywgZG9jdW1lbnQpO1xyXG5cclxuLyoqXHJcbiAqIE5hdmlnYXRpb24gUGx1Z2luXHJcbiAqIEB2ZXJzaW9uIDIuMC4wXHJcbiAqIEBhdXRob3IgQXJ0dXMgS29sYW5vd3NraVxyXG4gKiBAbGljZW5zZSBUaGUgTUlUIExpY2Vuc2UgKE1JVClcclxuICovXHJcbjsoZnVuY3Rpb24oJCwgd2luZG93LCBkb2N1bWVudCwgdW5kZWZpbmVkKSB7XHJcblx0J3VzZSBzdHJpY3QnO1xyXG5cclxuXHQvKipcclxuXHQgKiBDcmVhdGVzIHRoZSBuYXZpZ2F0aW9uIHBsdWdpbi5cclxuXHQgKiBAY2xhc3MgVGhlIE5hdmlnYXRpb24gUGx1Z2luXHJcblx0ICogQHBhcmFtIHtPd2x9IGNhcm91c2VsIC0gVGhlIE93bCBDYXJvdXNlbC5cclxuXHQgKi9cclxuXHR2YXIgTmF2aWdhdGlvbiA9IGZ1bmN0aW9uKGNhcm91c2VsKSB7XHJcblx0XHQvKipcclxuXHRcdCAqIFJlZmVyZW5jZSB0byB0aGUgY29yZS5cclxuXHRcdCAqIEB0eXBlIHtPd2x9XHJcblx0XHQgKi9cclxuXHRcdHRoaXMuY29yZSA9IGNhcm91c2VsO1xyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogSW5kaWNhdGVzIHdoZXRoZXIgdGhlIHBsdWdpbiBpcyBpbml0aWFsaXplZCBvciBub3QuXHJcblx0XHQgKiBAdHlwZSB7Qm9vbGVhbn1cclxuXHRcdCAqL1xyXG5cdFx0dGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogVGhlIGN1cnJlbnQgcGFnaW5nIGluZGV4ZXMuXHJcblx0XHQgKiBAdHlwZSB7QXJyYXl9XHJcblx0XHQgKi9cclxuXHRcdHRoaXMucGFnZXMgPSBbXTtcclxuXHJcblx0XHQvKipcclxuXHRcdCAqIEFsbCBET00gZWxlbWVudHMgb2YgdGhlIHVzZXIgaW50ZXJmYWNlLlxyXG5cdFx0ICogQHR5cGUge09iamVjdH1cclxuXHRcdCAqL1xyXG5cdFx0dGhpcy5jb250cm9scyA9IHt9O1xyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogTWFya3VwIGZvciBhbiBpbmRpY2F0b3IuXHJcblx0XHQgKiBAdHlwZSB7U3RyaW5nfVxyXG5cdFx0ICovXHJcblx0XHR0aGlzLnRlbXBsYXRlID0gbnVsbDtcclxuXHJcblx0XHQvKipcclxuXHRcdCAqIFRoZSBjYXJvdXNlbCBlbGVtZW50LlxyXG5cdFx0ICogQHR5cGUge2pRdWVyeX1cclxuXHRcdCAqL1xyXG5cdFx0dGhpcy4kZWxlbWVudCA9IHRoaXMuY29yZS5kb20uJGVsO1xyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogT3ZlcnJpZGRlbiBtZXRob2RzIG9mIHRoZSBjYXJvdXNlbC5cclxuXHRcdCAqIEB0eXBlIHtPYmplY3R9XHJcblx0XHQgKi9cclxuXHRcdHRoaXMub3ZlcnJpZGVzID0ge1xyXG5cdFx0XHRuZXh0OiB0aGlzLmNvcmUubmV4dCxcclxuXHRcdFx0cHJldjogdGhpcy5jb3JlLnByZXYsXHJcblx0XHRcdHRvOiB0aGlzLmNvcmUudG9cclxuXHRcdH07XHJcblxyXG5cdFx0LyoqXHJcblx0XHQgKiBBbGwgZXZlbnQgaGFuZGxlcnMuXHJcblx0XHQgKiBAdHlwZSB7T2JqZWN0fVxyXG5cdFx0ICovXHJcblx0XHR0aGlzLmhhbmRsZXJzID0ge1xyXG5cdFx0XHQnY2hhbmdlZC5vd2wuY2Fyb3VzZWwnOiAkLnByb3h5KGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0XHRpZiAoZS5wcm9wZXJ0eS5uYW1lID09ICdpdGVtcycpIHtcclxuXHRcdFx0XHRcdGlmICghdGhpcy5pbml0aWFsaXplZCkge1xyXG5cdFx0XHRcdFx0XHR0aGlzLmluaXRpYWxpemUoKTtcclxuXHRcdFx0XHRcdFx0dGhpcy5pbml0aWFsaXplZCA9IHRydWU7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR0aGlzLnVwZGF0ZSgpO1xyXG5cdFx0XHRcdFx0dGhpcy5kcmF3KCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmICh0aGlzLmZpbGxpbmcpIHtcclxuXHRcdFx0XHRcdGUucHJvcGVydHkudmFsdWUuZGF0YSgnb3dsLWl0ZW0nKS5kb3QgPSAkKCc6Zmlyc3QtY2hpbGQnLCBlLnByb3BlcnR5LnZhbHVlKVxyXG5cdFx0XHRcdFx0XHQuZmluZCgnW2RhdGEtZG90XScpLmFuZFNlbGYoKS5kYXRhKCdkb3QnKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sIHRoaXMpLFxyXG5cdFx0XHQnY2hhbmdlLm93bC5jYXJvdXNlbCc6ICQucHJveHkoZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRcdGlmIChlLnByb3BlcnR5Lm5hbWUgPT0gJ3Bvc2l0aW9uJyAmJiAhdGhpcy5jb3JlLnN0YXRlLnJldmVydFxyXG5cdFx0XHRcdFx0JiYgIXRoaXMuY29yZS5zZXR0aW5ncy5sb29wICYmIHRoaXMuY29yZS5zZXR0aW5ncy5uYXZSZXdpbmQpIHtcclxuXHRcdFx0XHRcdHZhciBjdXJyZW50ID0gdGhpcy5jb3JlLmN1cnJlbnQoKSxcclxuXHRcdFx0XHRcdFx0bWF4aW11bSA9IHRoaXMuY29yZS5tYXhpbXVtKCksXHJcblx0XHRcdFx0XHRcdG1pbmltdW0gPSB0aGlzLmNvcmUubWluaW11bSgpO1xyXG5cdFx0XHRcdFx0ZS5kYXRhID0gZS5wcm9wZXJ0eS52YWx1ZSA+IG1heGltdW1cclxuXHRcdFx0XHRcdFx0PyBjdXJyZW50ID49IG1heGltdW0gPyBtaW5pbXVtIDogbWF4aW11bVxyXG5cdFx0XHRcdFx0XHQ6IGUucHJvcGVydHkudmFsdWUgPCBtaW5pbXVtID8gbWF4aW11bSA6IGUucHJvcGVydHkudmFsdWU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHRoaXMuZmlsbGluZyA9IHRoaXMuY29yZS5zZXR0aW5ncy5kb3RzRGF0YSAmJiBlLnByb3BlcnR5Lm5hbWUgPT0gJ2l0ZW0nXHJcblx0XHRcdFx0XHQmJiBlLnByb3BlcnR5LnZhbHVlICYmIGUucHJvcGVydHkudmFsdWUuaXMoJzplbXB0eScpO1xyXG5cdFx0XHR9LCB0aGlzKSxcclxuXHRcdFx0J3JlZnJlc2hlZC5vd2wuY2Fyb3VzZWwnOiAkLnByb3h5KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdGlmICh0aGlzLmluaXRpYWxpemVkKSB7XHJcblx0XHRcdFx0XHR0aGlzLnVwZGF0ZSgpO1xyXG5cdFx0XHRcdFx0dGhpcy5kcmF3KCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LCB0aGlzKVxyXG5cdFx0fTtcclxuXHJcblx0XHQvLyBzZXQgZGVmYXVsdCBvcHRpb25zXHJcblx0XHR0aGlzLmNvcmUub3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCBOYXZpZ2F0aW9uLkRlZmF1bHRzLCB0aGlzLmNvcmUub3B0aW9ucyk7XHJcblxyXG5cdFx0Ly8gcmVnaXN0ZXIgZXZlbnQgaGFuZGxlcnNcclxuXHRcdHRoaXMuJGVsZW1lbnQub24odGhpcy5oYW5kbGVycyk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBEZWZhdWx0IG9wdGlvbnMuXHJcblx0ICogQHB1YmxpY1xyXG5cdCAqIEB0b2RvIFJlbmFtZSBgc2xpZGVCeWAgdG8gYG5hdkJ5YFxyXG5cdCAqL1xyXG5cdE5hdmlnYXRpb24uRGVmYXVsdHMgPSB7XHJcblx0XHRuYXY6IGZhbHNlLFxyXG5cdFx0bmF2UmV3aW5kOiB0cnVlLFxyXG5cdFx0bmF2VGV4dDogWyAncHJldicsICduZXh0JyBdLFxyXG5cdFx0bmF2U3BlZWQ6IGZhbHNlLFxyXG5cdFx0bmF2RWxlbWVudDogJ2RpdicsXHJcblx0XHRuYXZDb250YWluZXI6IGZhbHNlLFxyXG5cdFx0bmF2Q29udGFpbmVyQ2xhc3M6ICdvd2wtbmF2JyxcclxuXHRcdG5hdkNsYXNzOiBbICdvd2wtcHJldicsICdvd2wtbmV4dCcgXSxcclxuXHRcdHNsaWRlQnk6IDEsXHJcblx0XHRkb3RDbGFzczogJ293bC1kb3QnLFxyXG5cdFx0ZG90c0NsYXNzOiAnb3dsLWRvdHMnLFxyXG5cdFx0ZG90czogdHJ1ZSxcclxuXHRcdGRvdHNFYWNoOiBmYWxzZSxcclxuXHRcdGRvdERhdGE6IGZhbHNlLFxyXG5cdFx0ZG90c1NwZWVkOiBmYWxzZSxcclxuXHRcdGRvdHNDb250YWluZXI6IGZhbHNlLFxyXG5cdFx0Y29udHJvbHNDbGFzczogJ293bC1jb250cm9scydcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEluaXRpYWxpemVzIHRoZSBsYXlvdXQgb2YgdGhlIHBsdWdpbiBhbmQgZXh0ZW5kcyB0aGUgY2Fyb3VzZWwuXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqL1xyXG5cdE5hdmlnYXRpb24ucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciAkY29udGFpbmVyLCBvdmVycmlkZSxcclxuXHRcdFx0b3B0aW9ucyA9IHRoaXMuY29yZS5zZXR0aW5ncztcclxuXHJcblx0XHQvLyBjcmVhdGUgdGhlIGluZGljYXRvciB0ZW1wbGF0ZVxyXG5cdFx0aWYgKCFvcHRpb25zLmRvdHNEYXRhKSB7XHJcblx0XHRcdHRoaXMudGVtcGxhdGUgPSAkKCc8ZGl2PicpXHJcblx0XHRcdFx0LmFkZENsYXNzKG9wdGlvbnMuZG90Q2xhc3MpXHJcblx0XHRcdFx0LmFwcGVuZCgkKCc8c3Bhbj4nKSlcclxuXHRcdFx0XHQucHJvcCgnb3V0ZXJIVE1MJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gY3JlYXRlIGNvbnRyb2xzIGNvbnRhaW5lciBpZiBuZWVkZWRcclxuXHRcdGlmICghb3B0aW9ucy5uYXZDb250YWluZXIgfHwgIW9wdGlvbnMuZG90c0NvbnRhaW5lcikge1xyXG5cdFx0XHR0aGlzLmNvbnRyb2xzLiRjb250YWluZXIgPSAkKCc8ZGl2PicpXHJcblx0XHRcdFx0LmFkZENsYXNzKG9wdGlvbnMuY29udHJvbHNDbGFzcylcclxuXHRcdFx0XHQuYXBwZW5kVG8odGhpcy4kZWxlbWVudCk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gY3JlYXRlIERPTSBzdHJ1Y3R1cmUgZm9yIGFic29sdXRlIG5hdmlnYXRpb25cclxuXHRcdHRoaXMuY29udHJvbHMuJGluZGljYXRvcnMgPSBvcHRpb25zLmRvdHNDb250YWluZXIgPyAkKG9wdGlvbnMuZG90c0NvbnRhaW5lcilcclxuXHRcdFx0OiAkKCc8ZGl2PicpLmhpZGUoKS5hZGRDbGFzcyhvcHRpb25zLmRvdHNDbGFzcykuYXBwZW5kVG8odGhpcy5jb250cm9scy4kY29udGFpbmVyKTtcclxuXHJcblx0XHR0aGlzLmNvbnRyb2xzLiRpbmRpY2F0b3JzLm9uKHRoaXMuY29yZS5kcmFnVHlwZVsyXSwgJ2RpdicsICQucHJveHkoZnVuY3Rpb24oZSkge1xyXG5cdFx0XHR2YXIgaW5kZXggPSAkKGUudGFyZ2V0KS5wYXJlbnQoKS5pcyh0aGlzLmNvbnRyb2xzLiRpbmRpY2F0b3JzKVxyXG5cdFx0XHRcdD8gJChlLnRhcmdldCkuaW5kZXgoKSA6ICQoZS50YXJnZXQpLnBhcmVudCgpLmluZGV4KCk7XHJcblxyXG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG5cdFx0XHR0aGlzLnRvKGluZGV4LCBvcHRpb25zLmRvdHNTcGVlZCk7XHJcblx0XHR9LCB0aGlzKSk7XHJcblxyXG5cdFx0Ly8gY3JlYXRlIERPTSBzdHJ1Y3R1cmUgZm9yIHJlbGF0aXZlIG5hdmlnYXRpb25cclxuXHRcdCRjb250YWluZXIgPSBvcHRpb25zLm5hdkNvbnRhaW5lciA/ICQob3B0aW9ucy5uYXZDb250YWluZXIpXHJcblx0XHRcdDogJCgnPGRpdj4nKS5hZGRDbGFzcyhvcHRpb25zLm5hdkNvbnRhaW5lckNsYXNzKS5wcmVwZW5kVG8odGhpcy5jb250cm9scy4kY29udGFpbmVyKTtcclxuXHJcblx0XHR0aGlzLmNvbnRyb2xzLiRuZXh0ID0gJCgnPCcgKyBvcHRpb25zLm5hdkVsZW1lbnQgKyAnPicpO1xyXG5cdFx0dGhpcy5jb250cm9scy4kcHJldmlvdXMgPSB0aGlzLmNvbnRyb2xzLiRuZXh0LmNsb25lKCk7XHJcblxyXG5cdFx0dGhpcy5jb250cm9scy4kcHJldmlvdXNcclxuXHRcdFx0LmFkZENsYXNzKG9wdGlvbnMubmF2Q2xhc3NbMF0pXHJcblx0XHRcdC5odG1sKG9wdGlvbnMubmF2VGV4dFswXSlcclxuXHRcdFx0LmhpZGUoKVxyXG5cdFx0XHQucHJlcGVuZFRvKCRjb250YWluZXIpXHJcblx0XHRcdC5vbih0aGlzLmNvcmUuZHJhZ1R5cGVbMl0sICQucHJveHkoZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRcdHRoaXMucHJldigpO1xyXG5cdFx0XHR9LCB0aGlzKSk7XHJcblx0XHR0aGlzLmNvbnRyb2xzLiRuZXh0XHJcblx0XHRcdC5hZGRDbGFzcyhvcHRpb25zLm5hdkNsYXNzWzFdKVxyXG5cdFx0XHQuaHRtbChvcHRpb25zLm5hdlRleHRbMV0pXHJcblx0XHRcdC5oaWRlKClcclxuXHRcdFx0LmFwcGVuZFRvKCRjb250YWluZXIpXHJcblx0XHRcdC5vbih0aGlzLmNvcmUuZHJhZ1R5cGVbMl0sICQucHJveHkoZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRcdHRoaXMubmV4dCgpO1xyXG5cdFx0XHR9LCB0aGlzKSk7XHJcblxyXG5cdFx0Ly8gb3ZlcnJpZGUgcHVibGljIG1ldGhvZHMgb2YgdGhlIGNhcm91c2VsXHJcblx0XHRmb3IgKG92ZXJyaWRlIGluIHRoaXMub3ZlcnJpZGVzKSB7XHJcblx0XHRcdHRoaXMuY29yZVtvdmVycmlkZV0gPSAkLnByb3h5KHRoaXNbb3ZlcnJpZGVdLCB0aGlzKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIERlc3Ryb3lzIHRoZSBwbHVnaW4uXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqL1xyXG5cdE5hdmlnYXRpb24ucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciBoYW5kbGVyLCBjb250cm9sLCBwcm9wZXJ0eSwgb3ZlcnJpZGU7XHJcblxyXG5cdFx0Zm9yIChoYW5kbGVyIGluIHRoaXMuaGFuZGxlcnMpIHtcclxuXHRcdFx0dGhpcy4kZWxlbWVudC5vZmYoaGFuZGxlciwgdGhpcy5oYW5kbGVyc1toYW5kbGVyXSk7XHJcblx0XHR9XHJcblx0XHRmb3IgKGNvbnRyb2wgaW4gdGhpcy5jb250cm9scykge1xyXG5cdFx0XHR0aGlzLmNvbnRyb2xzW2NvbnRyb2xdLnJlbW92ZSgpO1xyXG5cdFx0fVxyXG5cdFx0Zm9yIChvdmVycmlkZSBpbiB0aGlzLm92ZXJpZGVzKSB7XHJcblx0XHRcdHRoaXMuY29yZVtvdmVycmlkZV0gPSB0aGlzLm92ZXJyaWRlc1tvdmVycmlkZV07XHJcblx0XHR9XHJcblx0XHRmb3IgKHByb3BlcnR5IGluIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHRoaXMpKSB7XHJcblx0XHRcdHR5cGVvZiB0aGlzW3Byb3BlcnR5XSAhPSAnZnVuY3Rpb24nICYmICh0aGlzW3Byb3BlcnR5XSA9IG51bGwpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogVXBkYXRlcyB0aGUgaW50ZXJuYWwgc3RhdGUuXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqL1xyXG5cdE5hdmlnYXRpb24ucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIGksIGosIGssXHJcblx0XHRcdG9wdGlvbnMgPSB0aGlzLmNvcmUuc2V0dGluZ3MsXHJcblx0XHRcdGxvd2VyID0gdGhpcy5jb3JlLm51bS5jSXRlbXMgLyAyLFxyXG5cdFx0XHR1cHBlciA9IHRoaXMuY29yZS5udW0uaXRlbXMgLSBsb3dlcixcclxuXHRcdFx0c2l6ZSA9IG9wdGlvbnMuY2VudGVyIHx8IG9wdGlvbnMuYXV0b1dpZHRoIHx8IG9wdGlvbnMuZG90RGF0YVxyXG5cdFx0XHRcdD8gMSA6IG9wdGlvbnMuZG90c0VhY2ggfHwgb3B0aW9ucy5pdGVtcztcclxuXHJcblx0XHRpZiAob3B0aW9ucy5zbGlkZUJ5ICE9PSAncGFnZScpIHtcclxuXHRcdFx0b3B0aW9ucy5zbGlkZUJ5ID0gTWF0aC5taW4ob3B0aW9ucy5zbGlkZUJ5LCBvcHRpb25zLml0ZW1zKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAob3B0aW9ucy5kb3RzKSB7XHJcblx0XHRcdHRoaXMucGFnZXMgPSBbXTtcclxuXHJcblx0XHRcdGZvciAoaSA9IGxvd2VyLCBqID0gMCwgayA9IDA7IGkgPCB1cHBlcjsgaSsrKSB7XHJcblx0XHRcdFx0aWYgKGogPj0gc2l6ZSB8fCBqID09PSAwKSB7XHJcblx0XHRcdFx0XHR0aGlzLnBhZ2VzLnB1c2goe1xyXG5cdFx0XHRcdFx0XHRzdGFydDogaSAtIGxvd2VyLFxyXG5cdFx0XHRcdFx0XHRlbmQ6IGkgLSBsb3dlciArIHNpemUgLSAxXHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdGogPSAwLCArK2s7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGogKz0gdGhpcy5jb3JlLm51bS5tZXJnZWRbaV07XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIERyYXdzIHRoZSB1c2VyIGludGVyZmFjZS5cclxuXHQgKiBAcHJvdGVjdGVkXHJcblx0ICovXHJcblx0TmF2aWdhdGlvbi5wcm90b3R5cGUuZHJhdyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIGRpZmZlcmVuY2UsIGksIGh0bWwgPSAnJyxcclxuXHRcdFx0b3B0aW9ucyA9IHRoaXMuY29yZS5zZXR0aW5ncyxcclxuXHRcdFx0JGl0ZW1zID0gdGhpcy5jb3JlLmRvbS4kb0l0ZW1zLFxyXG5cdFx0XHRpbmRleCA9IHRoaXMuY29yZS5ub3JtYWxpemUodGhpcy5jb3JlLmN1cnJlbnQoKSwgdHJ1ZSk7XHJcblxyXG5cdFx0aWYgKG9wdGlvbnMubmF2ICYmICFvcHRpb25zLmxvb3AgJiYgIW9wdGlvbnMubmF2UmV3aW5kKSB7XHJcblx0XHRcdHRoaXMuY29udHJvbHMuJHByZXZpb3VzLnRvZ2dsZUNsYXNzKCdkaXNhYmxlZCcsIGluZGV4IDw9IDApO1xyXG5cdFx0XHR0aGlzLmNvbnRyb2xzLiRuZXh0LnRvZ2dsZUNsYXNzKCdkaXNhYmxlZCcsIGluZGV4ID49IHRoaXMuY29yZS5tYXhpbXVtKCkpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuY29udHJvbHMuJHByZXZpb3VzLnRvZ2dsZShvcHRpb25zLm5hdik7XHJcblx0XHR0aGlzLmNvbnRyb2xzLiRuZXh0LnRvZ2dsZShvcHRpb25zLm5hdik7XHJcblxyXG5cdFx0aWYgKG9wdGlvbnMuZG90cykge1xyXG5cdFx0XHRkaWZmZXJlbmNlID0gdGhpcy5wYWdlcy5sZW5ndGggLSB0aGlzLmNvbnRyb2xzLiRpbmRpY2F0b3JzLmNoaWxkcmVuKCkubGVuZ3RoO1xyXG5cclxuXHRcdFx0aWYgKGRpZmZlcmVuY2UgPiAwKSB7XHJcblx0XHRcdFx0Zm9yIChpID0gMDsgaSA8IE1hdGguYWJzKGRpZmZlcmVuY2UpOyBpKyspIHtcclxuXHRcdFx0XHRcdGh0bWwgKz0gb3B0aW9ucy5kb3REYXRhID8gJGl0ZW1zLmVxKGkpLmRhdGEoJ293bC1pdGVtJykuZG90IDogdGhpcy50ZW1wbGF0ZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dGhpcy5jb250cm9scy4kaW5kaWNhdG9ycy5hcHBlbmQoaHRtbCk7XHJcblx0XHRcdH0gZWxzZSBpZiAoZGlmZmVyZW5jZSA8IDApIHtcclxuXHRcdFx0XHR0aGlzLmNvbnRyb2xzLiRpbmRpY2F0b3JzLmNoaWxkcmVuKCkuc2xpY2UoZGlmZmVyZW5jZSkucmVtb3ZlKCk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHRoaXMuY29udHJvbHMuJGluZGljYXRvcnMuZmluZCgnLmFjdGl2ZScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuXHRcdFx0dGhpcy5jb250cm9scy4kaW5kaWNhdG9ycy5jaGlsZHJlbigpLmVxKCQuaW5BcnJheSh0aGlzLmN1cnJlbnQoKSwgdGhpcy5wYWdlcykpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmNvbnRyb2xzLiRpbmRpY2F0b3JzLnRvZ2dsZShvcHRpb25zLmRvdHMpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogRXh0ZW5kcyBldmVudCBkYXRhLlxyXG5cdCAqIEBwcm90ZWN0ZWRcclxuXHQgKiBAcGFyYW0ge0V2ZW50fSBldmVudCAtIFRoZSBldmVudCBvYmplY3Qgd2hpY2ggZ2V0cyB0aHJvd24uXHJcblx0ICovXHJcblx0TmF2aWdhdGlvbi5wcm90b3R5cGUub25UcmlnZ2VyID0gZnVuY3Rpb24oZXZlbnQpIHtcclxuXHRcdHZhciBvcHRpb25zID0gdGhpcy5jb3JlLnNldHRpbmdzO1xyXG5cclxuXHRcdGV2ZW50LnBhZ2UgPSB7XHJcblx0XHRcdGluZGV4OiAkLmluQXJyYXkodGhpcy5jdXJyZW50KCksIHRoaXMucGFnZXMpLFxyXG5cdFx0XHRjb3VudDogdGhpcy5wYWdlcy5sZW5ndGgsXHJcblx0XHRcdHNpemU6IG9wdGlvbnMuY2VudGVyIHx8IG9wdGlvbnMuYXV0b1dpZHRoIHx8IG9wdGlvbnMuZG90RGF0YVxyXG5cdFx0XHRcdD8gMSA6IG9wdGlvbnMuZG90c0VhY2ggfHwgb3B0aW9ucy5pdGVtc1xyXG5cdFx0fTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEdldHMgdGhlIGN1cnJlbnQgcGFnZSBwb3NpdGlvbiBvZiB0aGUgY2Fyb3VzZWwuXHJcblx0ICogQHByb3RlY3RlZFxyXG5cdCAqIEByZXR1cm5zIHtOdW1iZXJ9XHJcblx0ICovXHJcblx0TmF2aWdhdGlvbi5wcm90b3R5cGUuY3VycmVudCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0dmFyIGluZGV4ID0gdGhpcy5jb3JlLm5vcm1hbGl6ZSh0aGlzLmNvcmUuY3VycmVudCgpLCB0cnVlKTtcclxuXHRcdHJldHVybiAkLmdyZXAodGhpcy5wYWdlcywgZnVuY3Rpb24obykge1xyXG5cdFx0XHRyZXR1cm4gby5zdGFydCA8PSBpbmRleCAmJiBvLmVuZCA+PSBpbmRleDtcclxuXHRcdH0pLnBvcCgpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogR2V0cyB0aGUgY3VycmVudCBzdWNjZXNvci9wcmVkZWNlc3NvciBwb3NpdGlvbi5cclxuXHQgKiBAcHJvdGVjdGVkXHJcblx0ICogQHJldHVybnMge051bWJlcn1cclxuXHQgKi9cclxuXHROYXZpZ2F0aW9uLnByb3RvdHlwZS5nZXRQb3NpdGlvbiA9IGZ1bmN0aW9uKHN1Y2Nlc3Nvcikge1xyXG5cdFx0dmFyIHBvc2l0aW9uLCBsZW5ndGgsXHJcblx0XHRcdG9wdGlvbnMgPSB0aGlzLmNvcmUuc2V0dGluZ3M7XHJcblxyXG5cdFx0aWYgKG9wdGlvbnMuc2xpZGVCeSA9PSAncGFnZScpIHtcclxuXHRcdFx0cG9zaXRpb24gPSAkLmluQXJyYXkodGhpcy5jdXJyZW50KCksIHRoaXMucGFnZXMpO1xyXG5cdFx0XHRsZW5ndGggPSB0aGlzLnBhZ2VzLmxlbmd0aDtcclxuXHRcdFx0c3VjY2Vzc29yID8gKytwb3NpdGlvbiA6IC0tcG9zaXRpb247XHJcblx0XHRcdHBvc2l0aW9uID0gdGhpcy5wYWdlc1soKHBvc2l0aW9uICUgbGVuZ3RoKSArIGxlbmd0aCkgJSBsZW5ndGhdLnN0YXJ0O1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0cG9zaXRpb24gPSB0aGlzLmNvcmUubm9ybWFsaXplKHRoaXMuY29yZS5jdXJyZW50KCksIHRydWUpO1xyXG5cdFx0XHRsZW5ndGggPSB0aGlzLmNvcmUubnVtLm9JdGVtcztcclxuXHRcdFx0c3VjY2Vzc29yID8gcG9zaXRpb24gKz0gb3B0aW9ucy5zbGlkZUJ5IDogcG9zaXRpb24gLT0gb3B0aW9ucy5zbGlkZUJ5O1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHBvc2l0aW9uO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogU2xpZGVzIHRvIHRoZSBuZXh0IGl0ZW0gb3IgcGFnZS5cclxuXHQgKiBAcHVibGljXHJcblx0ICogQHBhcmFtIHtOdW1iZXJ9IFtzcGVlZD1mYWxzZV0gLSBUaGUgdGltZSBpbiBtaWxsaXNlY29uZHMgZm9yIHRoZSB0cmFuc2l0aW9uLlxyXG5cdCAqL1xyXG5cdE5hdmlnYXRpb24ucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbihzcGVlZCkge1xyXG5cdFx0JC5wcm94eSh0aGlzLm92ZXJyaWRlcy50bywgdGhpcy5jb3JlKSh0aGlzLmdldFBvc2l0aW9uKHRydWUpLCBzcGVlZCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBTbGlkZXMgdG8gdGhlIHByZXZpb3VzIGl0ZW0gb3IgcGFnZS5cclxuXHQgKiBAcHVibGljXHJcblx0ICogQHBhcmFtIHtOdW1iZXJ9IFtzcGVlZD1mYWxzZV0gLSBUaGUgdGltZSBpbiBtaWxsaXNlY29uZHMgZm9yIHRoZSB0cmFuc2l0aW9uLlxyXG5cdCAqL1xyXG5cdE5hdmlnYXRpb24ucHJvdG90eXBlLnByZXYgPSBmdW5jdGlvbihzcGVlZCkge1xyXG5cdFx0JC5wcm94eSh0aGlzLm92ZXJyaWRlcy50bywgdGhpcy5jb3JlKSh0aGlzLmdldFBvc2l0aW9uKGZhbHNlKSwgc3BlZWQpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogU2xpZGVzIHRvIHRoZSBzcGVjaWZpZWQgaXRlbSBvciBwYWdlLlxyXG5cdCAqIEBwdWJsaWNcclxuXHQgKiBAcGFyYW0ge051bWJlcn0gcG9zaXRpb24gLSBUaGUgcG9zaXRpb24gb2YgdGhlIGl0ZW0gb3IgcGFnZS5cclxuXHQgKiBAcGFyYW0ge051bWJlcn0gW3NwZWVkXSAtIFRoZSB0aW1lIGluIG1pbGxpc2Vjb25kcyBmb3IgdGhlIHRyYW5zaXRpb24uXHJcblx0ICogQHBhcmFtIHtCb29sZWFufSBbc3RhbmRhcmQ9ZmFsc2VdIC0gV2hldGhlciB0byB1c2UgdGhlIHN0YW5kYXJkIGJlaGF2aW91ciBvciBub3QuXHJcblx0ICovXHJcblx0TmF2aWdhdGlvbi5wcm90b3R5cGUudG8gPSBmdW5jdGlvbihwb3NpdGlvbiwgc3BlZWQsIHN0YW5kYXJkKSB7XHJcblx0XHR2YXIgbGVuZ3RoO1xyXG5cclxuXHRcdGlmICghc3RhbmRhcmQpIHtcclxuXHRcdFx0bGVuZ3RoID0gdGhpcy5wYWdlcy5sZW5ndGg7XHJcblx0XHRcdCQucHJveHkodGhpcy5vdmVycmlkZXMudG8sIHRoaXMuY29yZSkodGhpcy5wYWdlc1soKHBvc2l0aW9uICUgbGVuZ3RoKSArIGxlbmd0aCkgJSBsZW5ndGhdLnN0YXJ0LCBzcGVlZCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQkLnByb3h5KHRoaXMub3ZlcnJpZGVzLnRvLCB0aGlzLmNvcmUpKHBvc2l0aW9uLCBzcGVlZCk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQkLmZuLm93bENhcm91c2VsLkNvbnN0cnVjdG9yLlBsdWdpbnMuTmF2aWdhdGlvbiA9IE5hdmlnYXRpb247XHJcblxyXG59KSh3aW5kb3cuWmVwdG8gfHwgd2luZG93LmpRdWVyeSwgd2luZG93LCBkb2N1bWVudCk7XHJcblxyXG4vKipcclxuICogSGFzaCBQbHVnaW5cclxuICogQHZlcnNpb24gMi4wLjBcclxuICogQGF1dGhvciBBcnR1cyBLb2xhbm93c2tpXHJcbiAqIEBsaWNlbnNlIFRoZSBNSVQgTGljZW5zZSAoTUlUKVxyXG4gKi9cclxuOyhmdW5jdGlvbigkLCB3aW5kb3csIGRvY3VtZW50LCB1bmRlZmluZWQpIHtcclxuXHQndXNlIHN0cmljdCc7XHJcblxyXG5cdC8qKlxyXG5cdCAqIENyZWF0ZXMgdGhlIGhhc2ggcGx1Z2luLlxyXG5cdCAqIEBjbGFzcyBUaGUgSGFzaCBQbHVnaW5cclxuXHQgKiBAcGFyYW0ge093bH0gY2Fyb3VzZWwgLSBUaGUgT3dsIENhcm91c2VsXHJcblx0ICovXHJcblx0dmFyIEhhc2ggPSBmdW5jdGlvbihjYXJvdXNlbCkge1xyXG5cdFx0LyoqXHJcblx0XHQgKiBSZWZlcmVuY2UgdG8gdGhlIGNvcmUuXHJcblx0XHQgKiBAdHlwZSB7T3dsfVxyXG5cdFx0ICovXHJcblx0XHR0aGlzLmNvcmUgPSBjYXJvdXNlbDtcclxuXHJcblx0XHQvKipcclxuXHRcdCAqIEhhc2ggdGFibGUgZm9yIHRoZSBoYXNoZXMuXHJcblx0XHQgKiBAdHlwZSB7T2JqZWN0fVxyXG5cdFx0ICovXHJcblx0XHR0aGlzLmhhc2hlcyA9IHt9O1xyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogVGhlIGNhcm91c2VsIGVsZW1lbnQuXHJcblx0XHQgKiBAdHlwZSB7alF1ZXJ5fVxyXG5cdFx0ICovXHJcblx0XHR0aGlzLiRlbGVtZW50ID0gdGhpcy5jb3JlLmRvbS4kZWw7XHJcblxyXG5cdFx0LyoqXHJcblx0XHQgKiBBbGwgZXZlbnQgaGFuZGxlcnMuXHJcblx0XHQgKiBAdHlwZSB7T2JqZWN0fVxyXG5cdFx0ICovXHJcblx0XHR0aGlzLmhhbmRsZXJzID0ge1xyXG5cdFx0XHQnaW5pdGlhbGl6ZWQub3dsLmNhcm91c2VsJzogJC5wcm94eShmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRpZiAod2luZG93LmxvY2F0aW9uLmhhc2guc3Vic3RyaW5nKDEpKSB7XHJcblx0XHRcdFx0XHQkKHdpbmRvdykudHJpZ2dlcignaGFzaGNoYW5nZS5vd2wubmF2aWdhdGlvbicpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSwgdGhpcyksXHJcblx0XHRcdCdjaGFuZ2VkLm93bC5jYXJvdXNlbCc6ICQucHJveHkoZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRcdGlmICh0aGlzLmZpbGxpbmcpIHtcclxuXHRcdFx0XHRcdGUucHJvcGVydHkudmFsdWUuZGF0YSgnb3dsLWl0ZW0nKS5oYXNoXHJcblx0XHRcdFx0XHRcdD0gJCgnOmZpcnN0LWNoaWxkJywgZS5wcm9wZXJ0eS52YWx1ZSkuZmluZCgnW2RhdGEtaGFzaF0nKS5hbmRTZWxmKCkuZGF0YSgnaGFzaCcpO1xyXG5cdFx0XHRcdFx0dGhpcy5oYXNoZXNbZS5wcm9wZXJ0eS52YWx1ZS5kYXRhKCdvd2wtaXRlbScpLmhhc2hdID0gZS5wcm9wZXJ0eS52YWx1ZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sIHRoaXMpLFxyXG5cdFx0XHQnY2hhbmdlLm93bC5jYXJvdXNlbCc6ICQucHJveHkoZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRcdGlmIChlLnByb3BlcnR5Lm5hbWUgPT0gJ3Bvc2l0aW9uJyAmJiB0aGlzLmNvcmUuY3VycmVudCgpID09PSB1bmRlZmluZWRcclxuXHRcdFx0XHRcdCYmIHRoaXMuY29yZS5zZXR0aW5ncy5zdGFydFBvc2l0aW9uID09ICdVUkxIYXNoJykge1xyXG5cdFx0XHRcdFx0ZS5kYXRhID0gdGhpcy5oYXNoZXNbd2luZG93LmxvY2F0aW9uLmhhc2guc3Vic3RyaW5nKDEpXTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dGhpcy5maWxsaW5nID0gZS5wcm9wZXJ0eS5uYW1lID09ICdpdGVtJyAmJiBlLnByb3BlcnR5LnZhbHVlICYmIGUucHJvcGVydHkudmFsdWUuaXMoJzplbXB0eScpO1xyXG5cdFx0XHR9LCB0aGlzKSxcclxuXHRcdH07XHJcblxyXG5cdFx0Ly8gc2V0IGRlZmF1bHQgb3B0aW9uc1xyXG5cdFx0dGhpcy5jb3JlLm9wdGlvbnMgPSAkLmV4dGVuZCh7fSwgSGFzaC5EZWZhdWx0cywgdGhpcy5jb3JlLm9wdGlvbnMpO1xyXG5cclxuXHRcdC8vIHJlZ2lzdGVyIHRoZSBldmVudCBoYW5kbGVyc1xyXG5cdFx0dGhpcy4kZWxlbWVudC5vbih0aGlzLmhhbmRsZXJzKTtcclxuXHJcblx0XHQvLyByZWdpc3RlciBldmVudCBsaXN0ZW5lciBmb3IgaGFzaCBuYXZpZ2F0aW9uXHJcblx0XHQkKHdpbmRvdykub24oJ2hhc2hjaGFuZ2Uub3dsLm5hdmlnYXRpb24nLCAkLnByb3h5KGZ1bmN0aW9uKCkge1xyXG5cdFx0XHR2YXIgaGFzaCA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoLnN1YnN0cmluZygxKSxcclxuXHRcdFx0XHRpdGVtcyA9IHRoaXMuY29yZS5kb20uJG9JdGVtcyxcclxuXHRcdFx0XHRwb3NpdGlvbiA9IHRoaXMuaGFzaGVzW2hhc2hdICYmIGl0ZW1zLmluZGV4KHRoaXMuaGFzaGVzW2hhc2hdKSB8fCAwO1xyXG5cclxuXHRcdFx0aWYgKCFoYXNoKSB7XHJcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR0aGlzLmNvcmUuZG9tLm9TdGFnZS5zY3JvbGxMZWZ0ID0gMDtcclxuXHRcdFx0dGhpcy5jb3JlLnRvKHBvc2l0aW9uLCBmYWxzZSwgdHJ1ZSk7XHJcblx0XHR9LCB0aGlzKSk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBEZWZhdWx0IG9wdGlvbnMuXHJcblx0ICogQHB1YmxpY1xyXG5cdCAqL1xyXG5cdEhhc2guRGVmYXVsdHMgPSB7XHJcblx0XHRVUkxoYXNoTGlzdGVuZXI6IGZhbHNlXHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBEZXN0cm95cyB0aGUgcGx1Z2luLlxyXG5cdCAqIEBwdWJsaWNcclxuXHQgKi9cclxuXHRIYXNoLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKSB7XHJcblx0XHR2YXIgaGFuZGxlciwgcHJvcGVydHk7XHJcblxyXG5cdFx0JCh3aW5kb3cpLm9mZignaGFzaGNoYW5nZS5vd2wubmF2aWdhdGlvbicpO1xyXG5cclxuXHRcdGZvciAoaGFuZGxlciBpbiB0aGlzLmhhbmRsZXJzKSB7XHJcblx0XHRcdHRoaXMub3dsLmRvbS4kZWwub2ZmKGhhbmRsZXIsIHRoaXMuaGFuZGxlcnNbaGFuZGxlcl0pO1xyXG5cdFx0fVxyXG5cdFx0Zm9yIChwcm9wZXJ0eSBpbiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0aGlzKSkge1xyXG5cdFx0XHR0eXBlb2YgdGhpc1twcm9wZXJ0eV0gIT0gJ2Z1bmN0aW9uJyAmJiAodGhpc1twcm9wZXJ0eV0gPSBudWxsKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdCQuZm4ub3dsQ2Fyb3VzZWwuQ29uc3RydWN0b3IuUGx1Z2lucy5IYXNoID0gSGFzaDtcclxuXHJcbn0pKHdpbmRvdy5aZXB0byB8fCB3aW5kb3cualF1ZXJ5LCB3aW5kb3csIGRvY3VtZW50KTtcclxuXG59KS5jYWxsKGdsb2JhbCwgbW9kdWxlLCB1bmRlZmluZWQsIHVuZGVmaW5lZCk7XG4iLCJyZXF1aXJlKCdvd2xjYXJvdXNlbCcpO1xyXG4vL3JlcXVpcmUoJy4uLy4uLy4uL2Jvd2VyX2NvbXBvbmVudHMvc2xpY2suanMvc2xpY2svc2xpY2subWluLmpzJyk7XHJcbi8vd3JpdGUgdGhlIGNhcm91c2VsIGNvbmZpZyBoZXJlXHJcblxyXG4kKCcuY2Fyb3VzZWxiYXItLWR1b19fY2Fyb3VzZWwnKS5vd2xDYXJvdXNlbCh7XHJcbiAgYXV0b1BsYXkgOiAzMDAwLCAvL1NldCBBdXRvUGxheSB0byAzIHNlY29uZHNcclxuICBtYXJnaW4gOiAyMCxcclxuICBsb29wIDogdHJ1ZSxcclxuICBuYXYgOiB0cnVlLFxyXG4gIGl0ZW1zIDogMixcclxuICBuYXZDb250YWluZXIgOiAnLmNhcm91c2VsYmFyLS1kdW9fX25hdicsXHJcbiAgZG90c0NvbnRhaW5lciA6ICcuY2Fyb3VzZWxiYXItLWR1b19fZG90cycsXHJcbiAgbmF2VGV4dCA6IFsnPHNwYW4+PC9zcGFuPicsJzxzcGFuPjwvc3Bhbj4nXSxcclxuICByZXNwb25zaXZlIDoge1xyXG4gICAgMCA6IHtcclxuICAgICAgaXRlbXMgOiAxLFxyXG4gICAgICBuYXYgOiB0cnVlLFxyXG4gICAgICBkb3RzIDogZmFsc2VcclxuICAgIH0sXHJcbiAgICA3NjggOiB7XHJcbiAgICAgIGl0ZW1zIDogMixcclxuICAgICAgbmF2IDogdHJ1ZSxcclxuICAgICAgZG90cyA6IHRydWVcclxuICAgIH1cclxuICB9XHJcbn0pO1xyXG4iLCIkKCdkb2N1bWVudCcpLnJlYWR5KGZ1bmN0aW9uKCl7XHJcbiAgLy8kKCcuY29sdW1uYm94LS1xdWF0cmUnKS5lcXVhbEhlaWdodHMoKTtcclxufSk7XHJcblxyXG4kKHdpbmRvdykubG9hZChmdW5jdGlvbigpIHtcclxuICBlcXVhbGhlaWdodCgnLmNvbHVtbmJveC0tcXVhdHJlID4gKiwgLm5ld3NsZXR0ZXIgPiAqJyk7XHJcbn0pO1xyXG5cclxuXHJcbiQod2luZG93KS5yZXNpemUoZnVuY3Rpb24oKXtcclxuICBlcXVhbGhlaWdodCgnLmNvbHVtbmJveC0tcXVhdHJlID4gKiwgLm5ld3NsZXR0ZXIgPiAqJyk7XHJcbn0pO1xyXG4iXX0=
